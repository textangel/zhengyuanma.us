
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS224n - Lecture 1,2 Word Vectors</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><h1>Word Vectors</h1>
<p>Represent words by distributional semantics - "by the company they keep". 100-dim vectors do really well in capturing word semantics. How to word vectors capture semantic meaning? Whatever 'units' of meaning (captured by ferquency of context words) exist, the process to generate the word vectors must linearly map them.</p>
<p><strong>Count Based Word Vectors</strong><br>
The simplest way to get word vectors is to keep a co-occurence matrix of words in your corpus with co-occurence defined as words which overlap in some window of fixed size. Then, take this very big co-occurence matrix and perform SVD on it to get dimensionality-reduced word vectors.</p>
<p>There are three disadvantages to this appraoch:</p>
<ul>
<li>It is hard to do when corpus size is big, large counts are given disproportinate weighting, and not so much semantic information about the words is inherent in the word vectors (if two word vectors are close to each other, it does not necessarily mean they are similar).</li>
</ul>
<p>Word2Vec solves these problems, and the benefits of a count-based approach and Word2Vec are unified in GloVE.</p>
<h2>Word2Vec</h2>
<p>The Word2vec approach is an approximation of the above, seeking to minimize the KL divergence between the predicted context words and the actual context words using word vector dot-product as the simiarlity. This forces words which appear in the same context to have small dot products relative to each other. This allows the capture of higher degrees of information about semantic meaning.</p>
<p>We show the skipgrams implementation fo word2vec. The CBOW implementation is the same, switching center word for context word. We use the similarity of word vectors for <em>context</em> or <em>outside</em> (o) and <em>center</em> (c) to calculate c given o or vice cersa.</p>
</div><div class="cell text-cell"><div><br></div><img src="resources/72221B849970379AB62C6C47685E00CC.png" alt="Screenshot 2019-12-21 at 10.04.47 PM.png" width="637" height="493"><div>Below: U, V are word vectorsof dim d (300) for every word w.</div><div><img src="resources/B23BCDAA5A805FA2A132B9BD0C828F6E.png" alt="Screenshot 2019-12-21 at 10.05.44 PM.png" width="562" height="293"><br></div><div><img src="resources/8D5FA23F2C264D686B8EF03FA7894876.png" alt="Screenshot 2020-05-24 at 5.08.45 PM.png" width="1124" height="281"><br></div></div><div class="cell markdown-cell"><p>Note: Here we use the <strong>Skipgrams</strong> implementation:</p>
<ul>
<li>Softmax over similarities is the prob given context word.</li>
<li>The objective function is the sum over all positions, of the sum over the context of the log probabilities.</li>
<li>Has a shitton of parameters - <span class="MathJax" id="MathJax-Element-79-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4186" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.721em, -0.478em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4187"><span class="mn" id="MathJax-Span-4188" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-4189" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-4190" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">2dV</script>, because we have <span class="MathJax" id="MathJax-Element-80-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4191" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.478em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4192"><span class="mn" id="MathJax-Span-4193" style="font-family: STIXGeneral-Regular;">2</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.875em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">2</script> vectors for each word, <span class="MathJax" id="MathJax-Element-81-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4194" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4195"><span class="mi" id="MathJax-Span-4196" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.898em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">d</script> dims for each word, <span class="MathJax" id="MathJax-Element-82-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4197" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4198"><span class="mi" id="MathJax-Span-4199" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">V</script> words in vocab. This means that gradients are very sparse for each update (they only touch a few words a time).<br>
Alternate Word2Vec formulation is <strong>CBOW</strong> - Predicted center word from bag of context words. Very similar.</li>
</ul>
<h3>Training Word2Vec: Negative Sampling</h3>
<p><strong>Naive softmax</strong> is the word2vec version without negative sampling.</p>
<ul>
<li>The inside part of the naive softmax gradient update for Word2Vec is:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-83-Frame" style=""><nobr><span class="math" id="MathJax-Span-4200" style="width: 16.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.471em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.449em, 1000em, 4.341em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-4201"><span class="mtable" id="MathJax-Span-4202" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 14.133em; height: 0px;"><span style="position: absolute; clip: rect(2.502em, 1000em, 6.58em, -0.507em); top: -4.73em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.743em; height: 0px;"><span style="position: absolute; clip: rect(1.02em, 1000em, 3.546em, -0.507em); top: -3.248em; right: 0em;"><span class="mtd" id="MathJax-Span-4203"><span class="mrow" id="MathJax-Span-4204"><span class="mfrac" id="MathJax-Span-4205"><span style="display: inline-block; position: relative; width: 1.471em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.714em, -0.467em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mi" id="MathJax-Span-4206" style="font-family: STIXGeneral-Regular;">∂</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.697em, 1000em, 2.86em, -0.467em); top: -1.848em; left: 50%; margin-left: -0.676em;"><span class="mrow" id="MathJax-Span-4207"><span class="mi" id="MathJax-Span-4208" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-4209"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4210" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-4211" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.471em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mi" id="MathJax-Span-4212" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-4213"></span><span class="mi" id="MathJax-Span-4214" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-4215" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4216" style="font-family: STIXGeneral-Italic;">o</span><span class="texatom" id="MathJax-Span-4217"><span class="mrow" id="MathJax-Span-4218"><span class="mo" id="MathJax-Span-4219" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-4220" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-4221" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.317em; right: 0em;"><span class="mtd" id="MathJax-Span-4250"><span class="mrow" id="MathJax-Span-4251"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.73em;"></span></span><span style="position: absolute; clip: rect(2.817em, 1000em, 7.607em, -0.209em); top: -5.462em; left: 5.743em;"><span style="display: inline-block; position: relative; width: 8.39em; height: 0px;"><span style="position: absolute; clip: rect(0.603em, 1000em, 3.96em, -0.209em); top: -3.248em; left: 0em;"><span class="mtd" id="MathJax-Span-4222"><span class="mrow" id="MathJax-Span-4223"><span class="mo" id="MathJax-Span-4224" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-4225"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4226" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-4227" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4228" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="munderover" id="MathJax-Span-4229" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-4230" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.526em); top: -1.159em; left: 0.056em;"><span class="texatom" id="MathJax-Span-4231"><span class="mrow" id="MathJax-Span-4232"><span class="mi" id="MathJax-Span-4233" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4234" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-4235" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.49em, -0.453em); top: -3.509em; left: 0.422em;"><span class="texatom" id="MathJax-Span-4236"><span class="mrow" id="MathJax-Span-4237"><span class="mi" id="MathJax-Span-4238" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-4239" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-4240" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4241" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-4242"><span class="mrow" id="MathJax-Span-4243"><span class="mo" id="MathJax-Span-4244" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-4245" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-4246" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-4247"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4248" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-4249" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.998em, -0.209em); top: -0.853em; left: 0em;"><span class="mtd" id="MathJax-Span-4252"><span class="mrow" id="MathJax-Span-4253"><span class="mo" id="MathJax-Span-4254" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-4255"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4256" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-4257" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4258" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-4259" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 3.261em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.508em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4260" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.653em;"><span class="texatom" id="MathJax-Span-4261"><span class="mrow" id="MathJax-Span-4262"><span class="mi" id="MathJax-Span-4263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-4264" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-4265" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-4266" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4267" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-4268"><span class="mrow" id="MathJax-Span-4269"><span class="mo" id="MathJax-Span-4270" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-4271" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-4272" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4273" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4274"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4275" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-4276" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4277" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.462em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.067em; vertical-align: -2.256em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-83">\begin{align} \frac{\partial}{\partial v_c} \log p(o | c) & = u_o - \sum_{x=1}^{V} p(x|c) u_x \\ & = u_o - E_{x \sim p(x|c)}(u_x) \end{align}</script><br>
The gradient update equals the observed representation of the context word minus what the model thinks the context should look like (as the weighted average of the representation of each word multiplied by its probability in the current model). This difference gives us the gradient update.<br>
Naive softmax is really slow since you have a million words so you are taking a softmax over a million words. In real implementation use negative sampling.</li>
</ul>
<p><strong>Negative Sampling</strong> is a variant of <strong>max-margin loss</strong> (where we try to maximize the margin between positive examples and negative examples).<br>
Main Idea: Train binary logistic regressions for a true pair (center word and word in its context window) vs several noise pairs (the center word paired with a random word). So we avoid having a million terms in the deonminator. The Negative Sampling Objective Function is:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-84-Frame" style=""><nobr><span class="math" id="MathJax-Span-4278" style="width: 21.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.426em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.582em, 1000em, 3.96em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4279"><span class="msubsup" id="MathJax-Span-4280"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4281" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="mi" id="MathJax-Span-4282" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4283" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4284" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-4285" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4286" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-4287" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">log</span><span class="mo" id="MathJax-Span-4288"></span><span class="mi" id="MathJax-Span-4289" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-4290" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4291"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4292" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.507em;"><span class="mi" id="MathJax-Span-4293" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.488em); top: -2.161em; left: 0.507em;"><span class="mi" id="MathJax-Span-4294" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4295"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4296" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-4297" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4298" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4299" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-4300" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-4301" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-4302"><span class="mrow" id="MathJax-Span-4303"><span class="mi" id="MathJax-Span-4304" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-4305" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-4306" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.557em, 1000em, 2.485em, -0.497em); top: -3.509em; left: 0.507em;"><span class="mi" id="MathJax-Span-4307" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4308" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.867em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.508em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4309" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.653em;"><span class="texatom" id="MathJax-Span-4310"><span class="mrow" id="MathJax-Span-4311"><span class="mi" id="MathJax-Span-4312" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-4313" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-4314" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-4315" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4316" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-4317" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4318" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-4319" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-4320"></span><span class="mi" id="MathJax-Span-4321" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-4322" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-4323" style="font-family: STIXGeneral-Regular;">−</span><span class="msubsup" id="MathJax-Span-4324"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4325" style="font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.507em;"><span class="mi" id="MathJax-Span-4326" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.679em, 1000em, 2.624em, -0.594em); top: -2.012em; left: 0.507em;"><span class="mi" id="MathJax-Span-4327" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4328"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4329" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-4330" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4331" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4332" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.5em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-84">J_t(\theta) = \log \sigma (u_o^T v_c) + \sum_{i=1}^k E_{j \sim P(w)} [\log \sigma (-u_j^T v_c)]</script><br>
essentially, we want to maximize the similarity of the context word and push the similarities of the negatively sampled words to be as low as possible.<p></p>
<ul>
<li>They sampled words according to the distribution <span class="MathJax" id="MathJax-Element-85-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4333" style="width: 8.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.432em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.201em, 1000em, 3.091em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4334"><span class="mi" id="MathJax-Span-4335" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-4336" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4337" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-4338" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4339" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-4340" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.893em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.517em, 1000em, 2.603em, -0.435em); top: -2.849em; left: 50%; margin-left: -1.154em;"><span class="mrow" id="MathJax-Span-4341"><span class="mi" id="MathJax-Span-4342" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.03em;"></span></span><span class="mo" id="MathJax-Span-4343" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4344" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span class="msubsup" id="MathJax-Span-4345"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px;"><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.486em); top: -2.309em; left: 0em;"><span class="mo" id="MathJax-Span-4346" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.481em; left: 0.282em;"><span class="texatom" id="MathJax-Span-4347"><span class="mrow" id="MathJax-Span-4348"><span class="mn" id="MathJax-Span-4349" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span class="texatom" id="MathJax-Span-4350"><span class="mrow" id="MathJax-Span-4351"><span class="mo" id="MathJax-Span-4352" style="font-size: 50%; font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-4353" style="font-size: 50%; font-family: STIXGeneral-Regular;">4</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.488em, -0.521em); top: -1.931em; left: 50%; margin-left: -1.886em;"><span class="mrow" id="MathJax-Span-4354"><span class="mi" id="MathJax-Span-4355" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mi" id="MathJax-Span-4356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4357" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mi" id="MathJax-Span-4358" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-4359" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mi" id="MathJax-Span-4360" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-4361" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-4362" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mi" id="MathJax-Span-4363" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-4364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.893em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.847em; vertical-align: -0.493em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">P(w) = \frac{U(w)^{3/4}}{NormFactor}</script>, where the <span class="MathJax" id="MathJax-Element-86-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4365" style="width: 1.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.466em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4366"><span class="mn" id="MathJax-Span-4367" style="font-family: STIXGeneral-Regular;">3</span><span class="texatom" id="MathJax-Span-4368"><span class="mrow" id="MathJax-Span-4369"><span class="mo" id="MathJax-Span-4370" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-4371" style="font-family: STIXGeneral-Regular;">4</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">3/4</script> power downsamples frequent words.</li>
</ul>
<p><img src="resources/E2A442EBC63748AE0FB6C9326D319E2E.png" alt="Screenshot 2020-05-24 at 6.21.03 PM.png"></p>
<h2>Aside: GloVe</h2>
<p>How to word vectors capture semantic meaning? Whatever 'units' of meaning (captured by ferquency of context words) exist, the process to generate the word vectors must linearly map them.</p>
<h3>Count-based Word Vectors: Old way to make word vectors</h3>
<ul>
<li>(Relationship between Word2Vec and LSA)</li>
<li>If we set the window to be the whole document size, and don't use dense embedding vectors (just use one-hot), then we have "Latent Semantic Analysis". The traditional approach to language embedding. Then you can do dimensionality reduction (SVD) on the giant matrix, and you get SVD word vectors. (This never really worked really well, so it never really caught on.)</li>
<li>Then you fiddle with the counts to scale the high frequency words, count closer words more, replacing counts with Pearson correlations etc you get getter word vectors..<br>
Issues with co-occurence vectors - very huge because of large vocabulary, and very sparse.</li>
</ul>
<p>This sums up the two philosophies to making word embeddings:</p>
<ul>
<li>Skipgram
<ul>
<li>Scales well</li>
</ul>
</li>
<li>Count-based
<ul>
<li>Primiarily used to capture word similarity, gave disproportional importance to large counts</li>
</ul>
</li>
</ul>
</div><div class="cell text-cell"></div><div class="cell text-cell"></div><div class="cell text-cell"><img src="resources/B94010EACA97F87E84465BD95F4407F6.png" alt="Screenshot 2019-12-21 at 11.33.24 PM.png" width="576" height="330"><div>Large or small ratios are dimensions of meaning whereas ratios close to 1 are not.<br><div><img src="resources/3508CD6556AB37C48F2DBFD7A8D8DFA6.png" alt="Screenshot 2019-12-21 at 11.34.03 PM.png" width="572" height="317"><br></div></div><div><br></div><div><div style="text-align: center;"><span style="font-size: 12px;"><br></span></div></div></div><div class="cell markdown-cell"><h3>Key insight in GloVE:</h3>
<p>If you set <span class="MathJax" id="MathJax-Element-87-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4372" style="width: 8.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.207em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.559em, 1000em, 3.008em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4373"><span class="msubsup" id="MathJax-Span-4374"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4375" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.732em;"><span class="mi" id="MathJax-Span-4376" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.011em; left: 0.732em;"><span class="mi" id="MathJax-Span-4377" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4378"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4379" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-4380" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4381" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-4382" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">log</span><span class="mo" id="MathJax-Span-4383"></span><span class="mi" id="MathJax-Span-4384" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-4385" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4386" style="font-family: STIXGeneral-Italic;">i</span><span class="texatom" id="MathJax-Span-4387"><span class="mrow" id="MathJax-Span-4388"><span class="mo" id="MathJax-Span-4389" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-4390" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-4391" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.359em; vertical-align: -0.402em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">w_i^Tw_j = \log P(i | j)</script>, the immediately we get <span class="MathJax" id="MathJax-Element-88-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4392" style="width: 11.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.529em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.346em, 1000em, 3.226em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4393"><span class="msubsup" id="MathJax-Span-4394"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4395" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.732em;"><span class="mi" id="MathJax-Span-4396" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.526em); top: -2.161em; left: 0.732em;"><span class="mi" id="MathJax-Span-4397" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4398" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4399"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4400" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-4401" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4402" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-4403" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4404" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-4405" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4406" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4407" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-4408" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">log</span><span class="mo" id="MathJax-Span-4409"></span><span class="mfrac" id="MathJax-Span-4410" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.922em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.507em); top: -2.849em; left: 50%; margin-left: -0.901em;"><span class="mrow" id="MathJax-Span-4411"><span class="mi" id="MathJax-Span-4412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-4413" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4414" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-4415"><span class="mrow" id="MathJax-Span-4416"><span class="mo" id="MathJax-Span-4417" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-4418" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-4419" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.603em, -0.507em); top: -1.91em; left: 50%; margin-left: -0.901em;"><span class="mrow" id="MathJax-Span-4420"><span class="mi" id="MathJax-Span-4421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-4422" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-4423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="texatom" id="MathJax-Span-4424"><span class="mrow" id="MathJax-Span-4425"><span class="mo" id="MathJax-Span-4426" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-4427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-4428" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.922em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.837em; vertical-align: -0.644em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">w_x^T(w_a-w_b) = \log \frac{P(x|a)}{P(x|b)}</script>, i.e. if you make the dot products = log(co-occurence probability), then the vector differences occur with a ratio of the co-occurence probabilities.<br>
So the objective function to train GloVE is<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-89-Frame" style=""><nobr><span class="math" id="MathJax-Span-4429" style="width: 18.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.005em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.603em, 1000em, 4.099em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4430"><span class="mi" id="MathJax-Span-4431" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-4432" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-4433" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.056em;"><span class="mo" id="MathJax-Span-4434" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.724em, -0.472em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-4435"><span class="mrow" id="MathJax-Span-4436"><span class="mi" id="MathJax-Span-4437" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-4438" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-4439" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-4440" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-4441" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.49em, -0.453em); top: -3.509em; left: 0.479em;"><span class="mi" id="MathJax-Span-4442" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-4443" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-4444" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4445"><span style="display: inline-block; position: relative; width: 1.157em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.536em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4446" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.044em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.632em;"><span class="texatom" id="MathJax-Span-4447"><span class="mrow" id="MathJax-Span-4448"><span class="mi" id="MathJax-Span-4449" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4450" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4451" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-4452" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4453"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4454" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.732em;"><span class="mi" id="MathJax-Span-4455" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.011em; left: 0.732em;"><span class="mi" id="MathJax-Span-4456" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4457"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000em, 4.185em, -0.701em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-4458"><span class="mrow" id="MathJax-Span-4459"><span class="munderover" id="MathJax-Span-4460"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4461" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.048em; left: 0.201em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-4462" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-4463" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4464" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-4465" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.484em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4466" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-4467" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4468" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-4469" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1000em, 4.178em, -0.813em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-4470"><span class="mrow" id="MathJax-Span-4471"><span class="munderover" id="MathJax-Span-4472"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.484em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4473" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.29em; left: 0.088em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-4474" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-4475" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4476" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-4477" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">log</span><span class="mo" id="MathJax-Span-4478"></span><span class="msubsup" id="MathJax-Span-4479" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.157em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.536em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4480" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.044em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.632em;"><span class="texatom" id="MathJax-Span-4481"><span class="mrow" id="MathJax-Span-4482"><span class="mi" id="MathJax-Span-4483" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4484" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-4485"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-4486" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.338em;"><span class="mn" id="MathJax-Span-4487" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.631em; vertical-align: -1.612em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-89">J = \sum_{i,j=1}^V f(X_{ij})(w_i^T\tilde w_j + b_i + \tilde b_j - \log X_{ij})^2</script><br>
where the <span class="MathJax" id="MathJax-Element-90-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4488" style="width: 2.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.309em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-4489"><span class="mi" id="MathJax-Span-4490" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-4491" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-4492"><span style="display: inline-block; position: relative; width: 1.157em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.536em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-4493" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.044em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.632em;"><span class="texatom" id="MathJax-Span-4494"><span class="mrow" id="MathJax-Span-4495"><span class="mi" id="MathJax-Span-4496" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-4497" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-4498" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">f(X_{ij})</script> function controlls the influence of very common word pairs.<br>
Essentially, set the loss to the square difference between the doct product and the log probabilities (with bias terms)<p></p>
<p>Based on count occurences but trained iteratively like Work2Vec ## Evaluation of Word Vectors</p>
<ul>
<li>Intrinsic word vector evaluation- Performance on Analogy tasks</li>
</ul>
<h2>Appendix:</h2>
<h3>The Structure of Langauge</h3>
<p>We assume people have a lot of world knowledge, so we can express a lot with very limited information.</p>
<h3>Notes On Word Vectors</h3>
<ul>
<li><strong>The high frequency effect</strong> - 'the' 'and' 'or' have high dot products with every word - the 'high frequency effect'. The first principal component of all word vectors is the 'high frequency effect' and if you just lop it off you can make your semantic representation better.</li>
<li>Because of sparse coding (in sparse vector spaces) you can actually denoise superpositions (independent component analysis), to separate out multiple senses of a word. (Can look at the paper: Linear Algebraic Structure of Word Senses, with Applications to Polysemy).</li>
<li>Wikipedia data works very well for word vectors, better than news (prob b/c of topical coveraeg).</li>
</ul>
<h3>Evaluation of Word Vectors</h3>
<ul>
<li>Intrinsic word vector evaluation- Performance on Analogy tasks</li>
</ul>
<h3>Old Stuff</h3>
<p><strong>WordNet</strong> - synonym sets, people don't really use it anymore.<br>
<strong>NLTK</strong> - swiss army knife of nlp - can do anything but not good at anything.<br>
Always use good tools.</p>
</div></div>
    </body>
    </html>
  