
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS224n - *Lecture 8 - Machine Translation, Seq2Seq, Attention</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><img src="resources/E0E2670F00F6F1A2CF1B0225C49C2B55.png" alt="Screenshot 2019-12-31 at 1.03.35 PM.png" width="604" height="362"><div style="font-size: 17px;"><b>Alignment</b></div><div><img src="resources/26A91FCDE917649E78F79B366D582D45.png" alt="Screenshot 2019-12-31 at 1.04.48 PM.png" width="596" height="236"><div>Alighment Can be Complex! (Appendix 1)</div><div>Back in the day we used statistical machine translation (Appendix 2)</div><div><br></div><div style="font-size: 19px;"><b>Neural Machine Translation</b></div><div style="font-size: 14px;">Sequence to Sequence (2014).</div><div style="font-size: 14px;">Seq2seq can also do many other NLP tasks-&nbsp;</div><div style="font-size: 14px;">&nbsp; - Summarization (Long text -&gt; short text)</div><div style="font-size: 14px;">&nbsp; - Dialgoue (Previous utterances -&gt; next utterance)</div><div style="font-size: 14px;">&nbsp; - Parsing (input text -&gt; output parse as sequence)</div><div style="font-size: 14px;">&nbsp; - Code generation (Natural Language -&gt; Python Code)</div><div style="font-size: 14px;">Seq2Seq is an example of a <b>conditional language model</b>. The conditional is because its predictions are conditions on the source sentence x. In other words,</div><div style="font-size: 14px;"><img src="resources/8D12B9A42945C23272A570D7580925C5.png" alt="Screenshot 2019-12-31 at 1.16.27 PM.png" width="548" height="145" style="font-size: 13px;"></div><div style="font-size: 14px;"><img src="resources/B19E4D1E32C16CC5B488693782AB2DF7.png" alt="Screenshot 2019-12-31 at 1.13.51 PM.png" width="629" height="464"><br></div><div style="font-size: 18px;"><b>Training NMT systems</b></div><div style="font-size: 14px;">Get a big parallel corpus.</div><div style="font-size: 14px;">Feed source sentence into encoder RNN</div><div style="font-size: 14px;">Start out the first hidden state of the decoder RNN as the kit hidden state of the encoder RNN, and feed target sentence into decoder RNN.</div><div style="font-size: 14px;">For every step of the decoder RNN, produce the probability distribution of the next decoded word. Compute a loss over every word of the decoded output sequence as the negative CE of the next word. Average all of the losses to get the total losses for the example. (If the decoder produces &lt;end&gt; too early in training, keep going).</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;">Seq2Seq is trained as a single system and Backprop operates “end-to-end”, from the final losses to the weights of the encoder RNN.</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;">To deal with variable length sentences, we pad and short sentences to a pre-defined max length, and make sure that we don’t use any hidden states that came from the padding.</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;"><img src="resources/292D864D884D7C123FEA32BC6668DEC6.png" alt="Screenshot 2019-12-31 at 1.21.46 PM.png" width="627" height="471"><br></div><div style="font-size: 14px;"><br></div><div style="font-size: 19px;"><b>Decoding with Beam Search</b></div><div style="font-size: 14px;">The basic decoding method is <b>greedy decoding</b>, but often we do <b>beam search </b>to get better searches.</div><div style="font-size: 14px;">On each step of the decoder, keep track of the k most probable partial translation (which we call hypotheses)</div><div style="font-size: 14px;">k is the beam size (in practice around 5 to 10).</div><div style="font-size: 14px;"></div></div></div><div class="cell markdown-cell"><p>A hypothesis <span class="MathJax" id="MathJax-Element-198-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6466" style="width: 4.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.773em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.952em, -0.531em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6467"><span class="msubsup" id="MathJax-Span-6468"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6469" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mn" id="MathJax-Span-6470" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6471" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6472" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-6473" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6474" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6475" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-6476" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.339em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-198">y_1,…,y_t</script> has a score which is its log probability. Scores are all negative, higher score is better. We search for high-(normalized) scoring hypotheses, tracking top k on each step. We do not normalize the scores when computing candidates using beam search.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-199-Frame" style=""><nobr><span class="math" id="MathJax-Span-6477" style="width: 32.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.617em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.679em, 1000em, 3.96em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6478"><span class="mi" id="MathJax-Span-6479" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-6480" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-6481" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-6482" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mi" id="MathJax-Span-6483" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-6484" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-6485" style="font-family: STIXGeneral-Italic;">y</span><span class="mn" id="MathJax-Span-6486" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-6487" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6488" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-6489" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6490" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6491" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-6492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6493" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-6494" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-6495" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">log</span><span class="mo" id="MathJax-Span-6496"></span><span class="msubsup" id="MathJax-Span-6497" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6498" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6499"><span class="mrow" id="MathJax-Span-6500"><span class="mi" id="MathJax-Span-6501" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6502" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6503" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6504"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6505" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mn" id="MathJax-Span-6506" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6507" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6508" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-6509" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6510" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6511" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-6512" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6513"><span class="mrow" id="MathJax-Span-6514"><span class="mo" id="MathJax-Span-6515" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-6516" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6517" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-6518" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-6519" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-6520" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-6521"><span class="mrow" id="MathJax-Span-6522"><span class="mi" id="MathJax-Span-6523" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-6524" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-6525" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.654em, 1000em, 2.485em, -0.48em); top: -3.509em; left: 0.563em;"><span class="mi" id="MathJax-Span-6526" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6527" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-6528"></span><span class="msubsup" id="MathJax-Span-6529" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6530" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6531"><span class="mrow" id="MathJax-Span-6532"><span class="mi" id="MathJax-Span-6533" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6534" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6535" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6536"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6537" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-6538" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6539"><span class="mrow" id="MathJax-Span-6540"><span class="mo" id="MathJax-Span-6541" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6542"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6543" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mn" id="MathJax-Span-6544" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6545" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6546" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-6547" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6548" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6549" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="texatom" id="MathJax-Span-6550"><span class="mrow" id="MathJax-Span-6551"><span class="mi" id="MathJax-Span-6552" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-6553" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-6554" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6555" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-6556" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6557" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.393em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-199">score(y1,…,y_t) = \log P_{LM}(y_1,…,y_t | x) = \sum_{i=1}^t \log P_{LM} (y_i | y_1,…,y_{i-1},x)</script><p></p>
<p><strong>Stopping in beam search</strong>: When a hypothesis produces <span class="MathJax" id="MathJax-Element-200-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6558" style="width: 3.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.547em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.727em, -0.451em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6559"><span class="mo" id="MathJax-Span-6560" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="mi" id="MathJax-Span-6561" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">e</span><span class="mi" id="MathJax-Span-6562" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-6563" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mo" id="MathJax-Span-6564" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.91em; vertical-align: -0.089em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-200"><end></script>, that hypothesis is complete. At this point we place it aside and continue exploring other hypothesis via beam search. We continue beam search until: We reach timestep threshold <span class="MathJax" id="MathJax-Element-201-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6565" style="width: 0.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.676em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6566"><span class="mi" id="MathJax-Span-6567" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-201">T</script>, or we have at least <span class="MathJax" id="MathJax-Element-202-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6568" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6569"><span class="mi" id="MathJax-Span-6570" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-202">n</script> completed hypothesis.</p>
<p>Selecting the final output senquence. When we have our final list of candidate scores, as generally shorter hypotheses have higher scores, to fix this, we must normalize the scores by length (<span class="MathJax" id="MathJax-Element-203-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6571" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.126em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6572"><span class="mn" id="MathJax-Span-6573" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-6574"><span class="mrow" id="MathJax-Span-6575"><span class="mo" id="MathJax-Span-6576" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-6577" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-203">1/t</script>) before picking the final output.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-204-Frame" style=""><nobr><span class="math" id="MathJax-Span-6578" style="width: 14.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.063em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.679em, 1000em, 3.96em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6579"><span class="mfrac" id="MathJax-Span-6580"><span style="display: inline-block; position: relative; width: 0.627em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-6581" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -1.848em; left: 50%; margin-left: -0.169em;"><span class="mi" id="MathJax-Span-6582" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 0.627em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-6583" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-6584" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-6585"><span class="mrow" id="MathJax-Span-6586"><span class="mi" id="MathJax-Span-6587" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-6588" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-6589" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.654em, 1000em, 2.485em, -0.48em); top: -3.509em; left: 0.563em;"><span class="mi" id="MathJax-Span-6590" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6591" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-6592"></span><span class="msubsup" id="MathJax-Span-6593" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6594" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6595"><span class="mrow" id="MathJax-Span-6596"><span class="mi" id="MathJax-Span-6597" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-6598" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6599" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6600"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6601" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-6602" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6603"><span class="mrow" id="MathJax-Span-6604"><span class="mo" id="MathJax-Span-6605" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6606"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6607" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mn" id="MathJax-Span-6608" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6609" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6610" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">…</span><span class="mo" id="MathJax-Span-6611" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6612" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6613" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="texatom" id="MathJax-Span-6614"><span class="mrow" id="MathJax-Span-6615"><span class="mi" id="MathJax-Span-6616" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-6617" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-6618" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6619" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-6620" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6621" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.393em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-204">\frac{1}{t} \sum_{i=1}^t \log P_{LM} (y_i | y_1,…,y_{i-1},x)</script><p></p>
</div><div class="cell text-cell"><div style="font-size: 14px;"><img src="resources/E02DF6E6ECB5E5C8971E4B52D3B18C8B.png" alt="Screenshot 2019-12-31 at 1.30.48 PM.png" width="611" height="464"><br></div><div style="font-size: 14px;"><img src="resources/CF9E4FB440DD46DA394C9981E27F370C.png" alt="Screenshot 2019-12-31 at 1.31.33 PM.png" width="622" height="469"><br></div><div style="font-size: 21px;"><br></div><div style="font-size: 19px;"><b>BLEU- &nbsp;Bilingual Evaluation Understudy</b></div><div style="font-size: 17px;">Comparison of machine translation and human translation.</div><div style="font-size: 17px;">Look at all the 1,2,3 and 4 grams that appear in the machine translation, how many of those appeared in at least one human translations? (n-gram precision)</div><div style="font-size: 17px;">+ penalty for too-short system translations.</div><div style="font-size: 17px;"><br></div><div style="font-size: 17px;"><div style="font-size: 19px;"><b>Attention</b></div></div><div style="font-size: 14px;">Attention solves the seq2seq informational bottleneck problem</div><div style="font-size: 14px;"><img src="resources/6292025793F06940F9152108DA73907C.png" alt="Screenshot 2020-01-22 at 10.56.27 PM.png" width="623" height="463" style="font-size: 13px;"><br></div><div style="font-size: 15px;">Attention: On each step of the decoder, use a direct connection of the encoder to focus on a particular part of the source sequence. The attention score is basically a dot product.</div><div style="font-size: 17px;"><img src="resources/98DB414DEB853FE494F83962A72E5AA6.png" alt="Screenshot 2020-01-22 at 10.57.53 PM.png" width="627" height="465"><b><br></b></div><div style="font-size: 17px;">(1) Given a decoder state, we generate the attention score with each encoder state, which is just the dot product.</div><div style="font-size: 17px;"><img src="resources/52B76B963EEF7DC6631966E5587B5902.png" alt="Screenshot 2020-01-22 at 10.58.30 PM.png" width="628" height="474"><b><br></b></div><div style="font-size: 14px;">(2) We take the softmax all those hidden states to determine the <b>attention distribution</b>. This is the weighting of importances of encoder states to the current &nbsp;decoder state.</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;"><img src="resources/08C97E6CAB585F1C952BF431B8F30D36.png" alt="Screenshot 2020-01-22 at 10.59.11 PM.png" width="627" height="466"><br></div><div style="font-size: 14px;">(3) We then form the attention output, which is the weighted interpolation of the source encoder hidden states weighted by the attention distribution.&nbsp;</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;"><img src="resources/4F352E97FE85536D8F7C0E0FE597829A.png" alt="Screenshot 2020-01-22 at 11.02.15 PM.png" width="626" height="465"><br></div><div style="font-size: 14px;">(4) Concatenate attention output with decoder hidden state and use model to predict the next word. The dependency of the next word on the attention part of the full concatenated state is learned from training data.</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;">(Optional)</div><div style="font-size: 14px;"><img src="resources/78B2BB0334A415B79DF2B7CBF6246FF5.png" alt="Screenshot 2020-01-22 at 11.04.56 PM.png" width="626" height="466"><br></div><div style="font-size: 14px;">(5- optional) Sometimes we take the attention output encoding from the previous step and also feed it into the decoder along with the usual decoder input.</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;">Attention is soft alignment.</div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;">Attention in equations:</div><div style="font-size: 14px;"><img src="resources/3B51E0DF121CFC40A21A148F0A69D8A2.png" alt="Screenshot 2020-01-22 at 11.08.33 PM.png" width="601" height="457"><br></div><div><div style="font-size: 17px;"><br></div><div style="font-size: 17px;"><b>Generalized Attention</b></div><div style="font-size: 17px;">Given a set of vector <font><i>values</i></font>&nbsp;and a vector <i>query</i>, attention is a technique to compuite a weighted sum of the values dependent on the query. We say the query <i>attends</i>&nbsp;to the values.</div><div style="font-size: 17px;"><br></div><div style="font-size: 17px;">Interpretation of Attention</div><div style="font-size: 17px;"><ul><li>The weighted sum is a selective sumamry of the information ciontained in the values, and the query determines which values to focus on.<br></li><li>Or, attention is a way to ontain a fixed-size reprenetaion of an arbitrary set of representations (the values) dependent on some other representaiton (the query)<br></li></ul></div><div><span style="font-size: 15px;">Ex) In seq2seq, the decoder hidden state is the query and they attend to all the encoder hidden states, which are the values.</span><br></div><div style="font-size: 17px;"><br></div><div style="font-size: 17px;"><b>Variants of Attention</b><br></div><div style="font-size: 17px;"></div></div></div><div class="cell markdown-cell"><p>In all attention variants we have some <em>values</em> <span class="MathJax" id="MathJax-Element-205-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6622" style="width: 7.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.095em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.502em, 1000em, 2.863em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6623"><span class="msubsup" id="MathJax-Span-6624"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6625" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mn" id="MathJax-Span-6626" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6627" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6628" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-6629" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-6630" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-6631" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6632" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6633" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-6634" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6635" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6636" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6637" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6638"><span class="mrow" id="MathJax-Span-6639"><span class="msubsup" id="MathJax-Span-6640"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6641" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6642" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.261em; vertical-align: -0.241em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-205">h_1,...,h_N \in R^{d_1}</script> and a <em>query</em> <span class="MathJax" id="MathJax-Element-206-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6643" style="width: 3.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.502em, 1000em, 2.73em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6644"><span class="mi" id="MathJax-Span-6645" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-6646" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6647" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6648" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6649"><span class="mrow" id="MathJax-Span-6650"><span class="msubsup" id="MathJax-Span-6651"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6652" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6653" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.113em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-206">s \in R^{d_2}</script></p>
<ol>
<li>Compute the attention scores <span class="MathJax" id="MathJax-Element-207-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6654" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.523em, 1000em, 2.73em, -0.476em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6655"><span class="mi" id="MathJax-Span-6656" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-6657" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6658" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6659" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="mi" id="MathJax-Span-6660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.089em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-207">e \in R^N</script></li>
<li>Take softmax to get the <em>attention distribution</em> <span class="MathJax" id="MathJax-Element-208-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6661" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6662"><span class="mi" id="MathJax-Span-6663" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-208">\alpha</script><br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-209-Frame" style=""><nobr><span class="math" id="MathJax-Span-6664" style="width: 9.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.953em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.49em, 1000em, 2.91em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6665"><span class="mi" id="MathJax-Span-6666" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-6667" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-6668" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">s</span><span class="mi" id="MathJax-Span-6669" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-6670" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mi" id="MathJax-Span-6671" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-6672" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-6673" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-6674" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6675" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-6676" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-6677" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-6678" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6679" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6680" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.619em;"><span class="mi" id="MathJax-Span-6681" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.326em; vertical-align: -0.292em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-209">\alpha = softmax(e) \in R^N</script></li>
<li>Use the attention distribution to take the weighted sum of values<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-210-Frame" style=""><nobr><span class="math" id="MathJax-Span-6682" style="width: 8.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.827em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.603em, 1000em, 3.96em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6683"><span class="mi" id="MathJax-Span-6684" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-6685" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-6686" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-6687" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-6688"><span class="mrow" id="MathJax-Span-6689"><span class="mi" id="MathJax-Span-6690" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-6691" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-6692" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.488em, -0.521em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-6693" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6694" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6695" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-6696" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6697"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6698" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-6699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6700" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6701" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6702" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6703"><span class="mrow" id="MathJax-Span-6704"><span class="msubsup" id="MathJax-Span-6705"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6706" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6707" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.477em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-210">\alpha = \sum_{i=1}^N \alpha_i h_i \in R^{d_1}</script></li>
</ol>
<p>The variants of attention are as follows:</p>
<ul>
<li>
<p><strong>Basic Dot Product Attention</strong>: <span class="MathJax" id="MathJax-Element-211-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6708" style="width: 6.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.8em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.54em, 1000em, 2.86em, -0.476em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6709"><span class="msubsup" id="MathJax-Span-6710"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.476em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6711" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-6712" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6713" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6714" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6715" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mi" id="MathJax-Span-6716" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6717"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6718" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-6719" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6720" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mi" id="MathJax-Span-6721" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.215em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-211">e_i = s^T h_i \in R</script><br>
Note: this assumes the size of your key (<span class="MathJax" id="MathJax-Element-212-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6722" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 2.515em, -0.492em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-6723"><span class="msubsup" id="MathJax-Span-6724"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6725" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6726" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.05em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-212">d_2</script>) and the size of your values (<span class="MathJax" id="MathJax-Element-213-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6727" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 2.515em, -0.492em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-6728"><span class="msubsup" id="MathJax-Span-6729"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6730" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6731" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.05em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-213">d_1</script>) is the same.</p>
<ul>
<li>This is the fastest and most space saving (<span class="MathJax" id="MathJax-Element-214-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6732" style="width: 2.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.421em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6733"><span class="mi" id="MathJax-Span-6734" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-6735" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6736"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6737" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6738" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6739" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-214">O(d_1)</script>) but captures the least amount of attention.</li>
</ul>
</li>
<li>
<p><strong>Multiplicative attention</strong>: <span class="MathJax" id="MathJax-Element-215-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6740" style="width: 7.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.757em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.54em, 1000em, 2.86em, -0.476em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6741"><span class="msubsup" id="MathJax-Span-6742"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.476em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6743" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-6744" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6745" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6746" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6747" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mi" id="MathJax-Span-6748" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6749" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-6750"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6751" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-6752" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6753" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mi" id="MathJax-Span-6754" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.215em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-215">e_i = s^T W h_i \in R</script></p>
<ul>
<li>where <span class="MathJax" id="MathJax-Element-216-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6755" style="width: 5.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.899em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.502em, 1000em, 2.73em, -0.436em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6756"><span class="mi" id="MathJax-Span-6757" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="mo" id="MathJax-Span-6758" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6759" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.609em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6760" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6761"><span class="mrow" id="MathJax-Span-6762"><span class="msubsup" id="MathJax-Span-6763"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6764" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6765" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-6766" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="msubsup" id="MathJax-Span-6767"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6768" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6769" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.113em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-216">W \in R^{d_2 \times d_1}</script> is a learned Weight matrix.<br>
-This is popular, more slow but captures the least amount of attention</li>
</ul>
</li>
<li>
<p>Simplified Variants of Multiplictive Attention (From FusionNet)</p>
<ul>
<li><span class="MathJax" id="MathJax-Element-217-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6770" style="width: 5.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.124em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.559em, 1000em, 3.093em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6771"><span class="msubsup" id="MathJax-Span-6772"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6773" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6774"><span class="mrow" id="MathJax-Span-6775"><span class="mi" id="MathJax-Span-6776" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-6777" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6778" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6779" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6780" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-6781" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.011em; left: 0.45em;"><span class="mi" id="MathJax-Span-6782" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6783" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-6784"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6785" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.507em;"><span class="mi" id="MathJax-Span-6786" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.454em; vertical-align: -0.496em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-217">S_{ij} = c_i^T W q_j</script> is the original multiplicative attention.</li>
<li><span class="MathJax" id="MathJax-Element-218-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6787" style="width: 7.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.306em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.523em, 1000em, 3.093em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6788"><span class="msubsup" id="MathJax-Span-6789"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6790" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6791"><span class="mrow" id="MathJax-Span-6792"><span class="mi" id="MathJax-Span-6793" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-6794" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6795" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6796" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6797" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-6798" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.011em; left: 0.45em;"><span class="mi" id="MathJax-Span-6799" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6800"><span style="display: inline-block; position: relative; width: 1.377em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.405em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6801" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.043em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.851em;"><span class="mi" id="MathJax-Span-6802" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6803" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="msubsup" id="MathJax-Span-6804"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6805" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.507em;"><span class="mi" id="MathJax-Span-6806" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.493em; vertical-align: -0.496em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-218">S_{ij} = c_i^T U^T V q_j</script> where <span class="MathJax" id="MathJax-Element-219-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6807" style="width: 2.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.844em, -0.405em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6808"><span class="mi" id="MathJax-Span-6809" style="font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.043em;"></span></span><span class="mo" id="MathJax-Span-6810" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-6811" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.006em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-219">U, V</script> are low rank</li>
<li><span class="MathJax" id="MathJax-Element-220-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6812" style="width: 8.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.432em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.523em, 1000em, 3.093em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6813"><span class="msubsup" id="MathJax-Span-6814"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6815" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6816"><span class="mrow" id="MathJax-Span-6817"><span class="mi" id="MathJax-Span-6818" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-6819" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6820" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6821" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6822" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-6823" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.011em; left: 0.45em;"><span class="mi" id="MathJax-Span-6824" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6825"><span style="display: inline-block; position: relative; width: 1.555em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6826" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 1.029em;"><span class="mi" id="MathJax-Span-6827" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6828" style="font-family: STIXGeneral-Italic;">D</span><span class="mi" id="MathJax-Span-6829" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-6830"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6831" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.507em;"><span class="mi" id="MathJax-Span-6832" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.493em; vertical-align: -0.496em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-220">S_{ij} = c_i^T W^T D W q_j</script> where <span class="MathJax" id="MathJax-Element-221-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6833" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.957em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6834"><span class="mi" id="MathJax-Span-6835" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-221">W</script> is low rank and <span class="MathJax" id="MathJax-Element-222-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6836" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6837"><span class="mi" id="MathJax-Span-6838" style="font-family: STIXGeneral-Italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-222">D</script> is diag</li>
<li><span class="MathJax" id="MathJax-Element-223-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6839" style="width: 13.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.5em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.523em, 1000em, 3.093em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6840"><span class="msubsup" id="MathJax-Span-6841"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6842" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6843"><span class="mrow" id="MathJax-Span-6844"><span class="mi" id="MathJax-Span-6845" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-6846" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6847" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-6848" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">R</span><span class="mi" id="MathJax-Span-6849" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-6850" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-6851" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-6852" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6853"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6854" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-6855" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.011em; left: 0.45em;"><span class="mi" id="MathJax-Span-6856" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6857"><span style="display: inline-block; position: relative; width: 1.555em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6858" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 1.029em;"><span class="mi" id="MathJax-Span-6859" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6860" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-6861" style="font-family: STIXGeneral-Italic;">D</span><span class="mi" id="MathJax-Span-6862" style="font-family: STIXGeneral-Italic;">R</span><span class="mi" id="MathJax-Span-6863" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-6864" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-6865" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-6866" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-6867" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span class="msubsup" id="MathJax-Span-6868"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6869" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.507em;"><span class="mi" id="MathJax-Span-6870" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6871" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.493em; vertical-align: -0.496em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-223">S_{ij} = Relu(c_i^T W^T) D Relu(W q_j)</script> FusionNet Attention because of a heuristic 'non-linearities are very important in deep learning'.</li>
<li>Space complexity of the similified variants are <span class="MathJax" id="MathJax-Element-224-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6872" style="width: 7.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.306em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6873"><span class="mi" id="MathJax-Span-6874" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-6875" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-6876" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6877"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6878" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6879" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6880" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-6881" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6882" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6883" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6884" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-6885"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6886" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6887" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6888" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-224">O((d_1+d_2)d_3)</script> where <span class="MathJax" id="MathJax-Element-225-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6889" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 2.525em, -0.492em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-6890"><span class="msubsup" id="MathJax-Span-6891"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6892" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6893" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.061em; vertical-align: -0.24em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-225">d_3</script> is the dimensionality of the reduced dimension diagonal.</li>
</ul>
</li>
<li>
<p><strong>Additive Attention (aka MLP Attention)</strong>: <span class="MathJax" id="MathJax-Element-226-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6894" style="width: 13.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.387em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.54em, 1000em, 2.88em, -0.476em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6895"><span class="msubsup" id="MathJax-Span-6896"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.476em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6897" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-6898" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6899" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6900" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6901" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mi" id="MathJax-Span-6902" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6903" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">tanh</span><span class="mo" id="MathJax-Span-6904"></span><span class="mo" id="MathJax-Span-6905" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6906"><span style="display: inline-block; position: relative; width: 1.184em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6907" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.884em;"><span class="mi" id="MathJax-Span-6908" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6909"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6910" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-6911" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6912" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-6913" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6914" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mn" id="MathJax-Span-6915" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6916" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-6917" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-6918" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mi" id="MathJax-Span-6919" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.237em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-226">e_i = v^T \tanh(W_ih_i + w_2s) \in R</script></p>
<ul>
<li>where <span class="MathJax" id="MathJax-Element-227-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6920" style="width: 5.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.293em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.502em, 1000em, 2.853em, -0.436em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6921"><span class="msubsup" id="MathJax-Span-6922"><span style="display: inline-block; position: relative; width: 1.353em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6923" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.884em;"><span class="mn" id="MathJax-Span-6924" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6925" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6926" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.609em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6927" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6928"><span class="mrow" id="MathJax-Span-6929"><span class="msubsup" id="MathJax-Span-6930"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6931" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6932" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-6933" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="msubsup" id="MathJax-Span-6934"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6935" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6936" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.249em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-227">W_1 \in R^{d_3 \times d_1}</script>, <span class="MathJax" id="MathJax-Element-228-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6937" style="width: 5.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.293em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.502em, 1000em, 2.853em, -0.436em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6938"><span class="msubsup" id="MathJax-Span-6939"><span style="display: inline-block; position: relative; width: 1.353em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6940" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.884em;"><span class="mn" id="MathJax-Span-6941" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6942" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6943" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.609em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6944" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6945"><span class="mrow" id="MathJax-Span-6946"><span class="msubsup" id="MathJax-Span-6947"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6948" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6949" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-6950" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">×</span><span class="msubsup" id="MathJax-Span-6951"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6952" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6953" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.249em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-228">W_2 \in R^{d_3 \times d_2}</script> are learned weight matrices and <span class="MathJax" id="MathJax-Element-229-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6954" style="width: 3.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.209em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.502em, 1000em, 2.73em, -0.487em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6955"><span class="mi" id="MathJax-Span-6956" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-6957" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-6958" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.404em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6959" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6960"><span class="mrow" id="MathJax-Span-6961"><span class="msubsup" id="MathJax-Span-6962"><span style="display: inline-block; position: relative; width: 0.71em; height: 0px;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-6963" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.375em;"><span class="mn" id="MathJax-Span-6964" style="font-size: 50%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.113em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-229">v \in R^{d_3}</script> is a learned weight vector.</li>
<li><span class="MathJax" id="MathJax-Element-225-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6889" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 2.525em, -0.492em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-6890"><span class="msubsup" id="MathJax-Span-6891"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6892" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6893" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.061em; vertical-align: -0.24em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-225">d_3</script> (the attention dimensionality) is a hyperparameter</li>
<li>This is essentially a shallow neural net put between every two positions in the context and the query to get the similarity score. Space is <span class="MathJax" id="MathJax-Element-230-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6965" style="width: 4.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.448em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6966"><span class="mi" id="MathJax-Span-6967" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-6968" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6969"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6970" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6971" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6972"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6973" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6974" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-6975"><span style="display: inline-block; position: relative; width: 1.005em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6976" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.536em;"><span class="mn" id="MathJax-Span-6977" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6978" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-230">O(d_1d_2d_3)</script>.</li>
</ul>
</li>
<li>
<p>Deep Neural Net between Context and Query Attention</p>
<ul>
<li>You can also use a deeper neural net between context and query embeddings to calculate the similarity score, but this is prohibitively costly and no one does this.</li>
</ul>
</li>
</ul>
</div><div class="cell text-cell"><div><div style="font-size: 17px;"><br></div><div style="font-size: 17px;"><b>Benefits of Attention:</b></div><div style="font-size: 15px;">- Significantly improves NMT performance,</div><div style="font-size: 15px;">- Solves the Bottleneck problem</div><div style="font-size: 15px;">- Helps with the Vanishing Gradient Problem (direct attention connections reduces distance just like shortcut connections)</div><div style="font-size: 15px;">- Provides Interperability</div><div style="font-size: 17px;"><b><br></b></div><div style="font-size: 17px;"><b>Essential Tips to Training RNN Models</b></div><div style="font-size: 15px;">1<span style="">. Use an LSTM or GRU</span></div><div style="font-size: 15px;"><span style="">2. Initlaize recurrent matrices to be orthogonal</span></div><div style="font-size: 15px;"><span style="">3. Intialize other matrices with a sensible (small!) scale</span></div><div style="font-size: 15px;"><span style="">4. Initalize forget gate bias to 1: default to remembering</span></div><div style="font-size: 15px;"><span style="">5. Use Adam or AdaDelta or AdaGrad</span></div><div style="font-size: 15px;"><span style="">6. Clip the norm of the gradient: 1-5 seems to be a reasonable threshold when used together with Adam or AdaDelta</span></div><div style="font-size: 15px;"><span style="">7. Either only dropout vertically or look into using Bayesian Dropout (Gal and Gahramani - not natively in PyTorch yet unf)</span></div><div style="font-size: 15px;"><span style="">8. Be patient!&nbsp;</span></div><div style="font-size: 15px;"><span style=""><br></span></div><div style="font-size: 15px;"><span style=""><b>Experimental Strategy:</b></span></div><div style="font-size: 15px;">Work incrementally!</div><div style="font-size: 15px;">Start with a very simple model and get it to work</div><div style="font-size: 15px;">Add bells and whistles one-by-one and get the model working with each of them (or abandom them)</div><div style="font-size: 15px;"><br></div><div style="font-size: 15px;">1. Initially run on a tiny amount of data</div><div style="font-size: 15px;">&nbsp; - You will see bugs much more easily on a tiny dataset</div><div style="font-size: 15px;">&nbsp; - Something like 8 examples is good</div><div style="font-size: 15px;">&nbsp; - Often synthetic data is useful for htis</div><div style="font-size: 15px;">&nbsp; - Make sure you can get 100% on this data, other wise your model is definitely not powerful enough or it is broken&nbsp;</div><div style="font-size: 15px;"><br></div><div style="font-size: 15px;">2. Then run your model on a large dataset</div><div style="font-size: 15px;">&nbsp; - It should still score close to 100% on the training data after optimization, otherwise, you probably want to consider a more powerful model. Overfitting to training data is not something to be scared of and is to be expected.</div><div style="font-size: 15px;">&nbsp; - However, since you want generalization performace, regularize your model so it doesn't overfit on dev, using generous dropout.</div><div style="font-size: 17px;"><br></div><div style="font-size: 17px;"><b>Research ideas:</b></div><div style="font-size: 17px;">Learning Temporal Events In text - what came before, what came after</div><div style="font-size: 14px;"><br></div><div style="font-size: 16px;">Look at the ‘residual encodings’ in NMT systems - the encoding remaining in the decoder hidden state after &lt;EOS&gt; is produced. These encodings must capture something inherent in the language pair.</div><div style="font-size: 14px;"><br></div></div><div style="font-size: 21px;"><b>Appendix 1:</b></div><div style="font-size: 16px;">Note: Calculating softmaxes at the end ismore expensive than doing the RNN computation - because the vocab size is huge!</div><div style="font-size: 21px;"><b><br></b></div><div><img src="resources/D5152567EBFB4FE050CF8F4D73CE8EBE.png" alt="Screenshot 2019-12-31 at 1.05.30 PM.png" width="578" height="408"><img src="resources/C61D74DF02E5676C809C2263D6A2F7A5.png" alt="Screenshot 2019-12-31 at 1.06.05 PM.png" width="616" height="455"><b><br></b></div><div><img src="resources/52F3693ECBA387757579379782DE481F.png" alt="Screenshot 2019-12-31 at 1.06.28 PM.png" width="543" height="414"><br></div><div><br></div><div style="font-size: 18px;"><b>Appendix 2: Statistical Machine Translation</b></div><div>Essentially, form many candidate output sentences based on different possible the direct translations of words and different alignments. The number was too much to put in memory so candidates with low probability are pruned out.</div><div>SMT had lots and lots of subcomponents for feature engineering, using lots of tables etc.</div><div><b><br></b></div><div><img src="resources/DAA82EBAF220E770109CFE9E65CD7DB9.png" alt="Screenshot 2019-12-31 at 1.09.08 PM.png" width="617" height="458"><br></div><div><br></div><div><div><br></div><div><div><br><div><div style="font-size: 16px;"><b>Appendix 3: How to deal with Unknown tokens in vocabualary:</b></div><div style="font-size: 16px;">&nbsp; -&nbsp;<b>Hierarchical softmax</b>: tree-structured vocabulary, allows you to use a larger vocabulary with less space</div><div style="font-size: 16px;">&nbsp; -&nbsp;<b>Noise-constrastive estimation</b>: binary classification</div><div style="font-size: 16px;">&nbsp; - Train on the subset of the vocabulary at a time, test on a smart set of possible translations</div><div style="font-size: 16px;">&nbsp; - Use&nbsp;<b>attention</b>&nbsp;to work out what you are translating, and do a dictionary lookup or simple transform of the word found by attention.</div></div></div></div></div><div style="font-size: 16px;"><br></div><div><div style="font-size: 16px;"><b>Appendix 3: BLEU Metric</b></div><div><font size="3"><b></b></font></div></div></div><div class="cell markdown-cell"><p>BLEU is a weighted geometric mean, with a brevity penalty factor added, on n-grams. Note that it's precision oriented, so p1 etc is the proportion of 1-grams in the machine translation also in the reference translation, and so on.<br>
Note that in BLEU, you are are only allowed to use each 1-gram in the regerence translation once to match the machine translation for a given 1-gram level, and similary for all levels of n.<br>
n=1,2,3,4 us ually used.</p>
<pre><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>exp( 0.5 * log p1 + 
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>0.25 * log p2 +
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>0.125 * log p3 +
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>0.125 * log p4 -
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>max(words-in-refernece / words-in-machine - 1, 0) )
</div></div></div></pre>
</div><div class="cell text-cell"></div></div>

    </body>
    </html>
  