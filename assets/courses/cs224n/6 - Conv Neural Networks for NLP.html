
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS224n Lecture 11- *CNNs for NLP</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell">Learn about how to debug neural nets<div><b>CNNs and Downsides of RNNs:</b><div>RNNs cannot capture phrases without prefix context</div><div>Often capture too much of last words in final vector.&nbsp;</div></div><div>CNNs are very fast! Much faster than RNNs<br></div><div><br></div><div style="font-size: 22px;"><b>CNNs</b></div><div>What if we compute vectors for every possible word subsequence of a certain length? (Every n-gram)</div><div><br></div><div><br></div><div style="font-size: 20px;"><b>Convolutions</b></div><div>A patch or <b>kernel</b>&nbsp;of weights which is slid over a sequence (or matrix), producing a dot product for each position. When we run CNNs we often pad the front and back so the ourput is the same length.</div><div><br></div><div><img src="resources/2C7838192986F45AF46CC094FD87139C.png" alt="Screenshot 2020-01-24 at 3.58.36 PM.png" width="600" height="454"><br></div><div>Because one convolution only captures one value for each filter, we often use multiple filters to get multiple values, which we call <i>features</i>. The idea is that each filter specializes in some aspect of the sentence.<img src="resources/9AD9F90528206C969393DABB69732F58.png" alt="Screenshot 2020-01-24 at 4.04.21 PM.png" width="602" height="445"></div><div><br></div><div style="font-size: 20px;"><b>Important Ideas for CNNs (With NLP Focus)</b></div><div><b>Maxpooling</b></div><div>Summarizes the output of a CNN.&nbsp;</div><div>For each of the features computed by the convolution, compute the max over all words of the returned feature values.<img src="resources/B7EE1C86CD80D1DE413862FB7C9C8BCF.png" alt="Screenshot 2020-01-24 at 4.05.52 PM.png" width="599" height="436"></div><div><div><br></div><div><b>Batch Norm</b></div><div>(Ioffe and Szegedy. 2015.)</div><div>Batch norm is almost always used in deep CNNs.</div><div>Transform the convolution output of a mini batch (whatever random 32 examples you saw) by scaling the activations to have zero mean and unit variance before pushing it to the next layer of the Conv Block. Ensures that what comes out of the conv block are always at the same scale.</div><div><ul><li>This allows deep NNs to learn much more reliably, becasue a lot of hyperparameter tuning in deep NN training is being very fussy about hyperparaneters to keep a scale of things about right so they dont get too big or too small. Batch-norm takes away the need to be so fussy about it.<br></li></ul></div><div><br></div><div><br></div><div><br></div><div><b>1x1 Convolutions</b></div><div>1x1 Convolutions are convolutions with a kernel size of 1. This gives you a position specific fully connected linear layer across channels!</div><div>You can do this because you want to map down from having a lot of channels to having fewer channels, or to get another linearities.</div><div>If you put fully connected layers over everything, they involve a lot of parameters, but putting in size 1 convolutions involve very few parameters.</div><div><br></div><div><b>Avg pooling</b></div><div>You can also take the average of each computed feature for each value. This corresponds roughly to “on average how much of this feature, ie. the sentence being about food, is present in the sentence?” Sometimes used. Used much less than maxpool.</div></div><div><br></div><div><b>Other Notions</b></div><div><div>Other notions used in CNNs but less common in NLP applications are in Appendix (2). They include</div><div>- Stride(2), &nbsp;Local Max Pool, Stride=2, k-max pooling over time</div></div><h2>Convolutional Neural Networks for Sentence Classification (2014, very early paper)</h2>
</div><div class="cell text-cell"><p>Single Sentence Text Classification (Old)<img src="resources/B96CF46DE78A4BB46CA5BF06D9B40D93.png" alt="Screenshot 2020-01-24 at 4.25.12 PM.png"></p>
<p>Below, <em>f</em> is a nonlinearity. In this paper they use a bias term and right-padding only (most people do symmetric padding).</p>
<p><img src="resources/C5C421E27B4767C6EA7A4DF01636C439.png" alt="Screenshot 2020-01-24 at 4.27.03 PM.png"></p>
<p>At the end, do maxpooling. They have multiple features of different kernel sizes to do the analysis</p>
<p><img src="resources/98D46BFA64E92C522DBE0DF4D27879F0.png" alt="Screenshot 2020-01-24 at 4.28.05 PM.png"></p>
<p>He used two identical copies of word vectors (GloVE) concatenated together to represent words. One set was frozen while the other was fine-tuned during training. Elemnts from both copies went in together in the max-pool.</p>
</div><div class="cell markdown-cell"><p>To obtain final feature vector <span class="MathJax" id="MathJax-Element-110-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5085" style="width: 7.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.644em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.616em, 1000em, 2.859em, -0.509em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5086"><span class="mi" id="MathJax-Span-5087" style="font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-5088" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-5089" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">[</span><span class="msubsup" id="MathJax-Span-5090"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000em, 4.178em, -0.823em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-5091"><span class="mrow" id="MathJax-Span-5092"><span class="munderover" id="MathJax-Span-5093"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5094" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.07em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-5095" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-5096" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5097" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-5098" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5099" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5100" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5101" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-5102" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000em, 4.178em, -0.823em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-5103"><span class="mrow" id="MathJax-Span-5104"><span class="munderover" id="MathJax-Span-5105"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5106" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.07em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-5107" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5108" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5109" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.13em; vertical-align: -0.236em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">z = [\hat c_1,...,\hat c_m]</script> he used <span class="MathJax" id="MathJax-Element-111-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5110" style="width: 4.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.604em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5111"><span class="mi" id="MathJax-Span-5112" style="font-family: STIXGeneral-Italic;">m</span><span class="mo" id="MathJax-Span-5113" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-5114" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">300</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">m=300</script>, with 100 feature maps each of sizes 3, 4, 5.<br>
Finally, the classification was done through a simple softmax layer.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-112-Frame" style=""><nobr><span class="math" id="MathJax-Span-5115" style="width: 11.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.91em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.474em, 1000em, 2.91em, -0.531em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5116"><span class="mi" id="MathJax-Span-5117" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-5118" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-5119" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">s</span><span class="mi" id="MathJax-Span-5120" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-5121" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mi" id="MathJax-Span-5122" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-5123" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-5124" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-5125" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5126" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-5127"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5128" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 1.029em;"><span class="texatom" id="MathJax-Span-5129"><span class="mrow" id="MathJax-Span-5130"><span class="mo" id="MathJax-Span-5131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5132" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-5133" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-5134" style="font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-5135" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-5136" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span><span class="mo" id="MathJax-Span-5137" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.344em; vertical-align: -0.292em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-112">y = softmax(W^{(S)}z+b)</script><p></p>
<p><strong>Finally, they used dropout</strong>: Create masking vector <span class="MathJax" id="MathJax-Element-113-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5138" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5139"><span class="mi" id="MathJax-Span-5140" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.615em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">r</script> of Bernoulli random variables with probability <span class="MathJax" id="MathJax-Element-114-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5141" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5142"><span class="mi" id="MathJax-Span-5143" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">p</script> of being <span class="MathJax" id="MathJax-Element-115-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5144" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5145"><span class="mn" id="MathJax-Span-5146" style="font-family: STIXGeneral-Regular;">1</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.875em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">1</script>. Delete features during training: <span class="MathJax" id="MathJax-Element-116-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5147" style="width: 13.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.824em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.507em, 1000em, 2.91em, -0.531em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5148"><span class="mi" id="MathJax-Span-5149" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-5150" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-5151" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">s</span><span class="mi" id="MathJax-Span-5152" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-5153" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mi" id="MathJax-Span-5154" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-5155" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-5156" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-5157" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-5158" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-5159"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5160" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 1.029em;"><span class="texatom" id="MathJax-Span-5161"><span class="mrow" id="MathJax-Span-5162"><span class="mo" id="MathJax-Span-5163" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5164" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-5165" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5166" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5167" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-5168" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∘</span><span class="mi" id="MathJax-Span-5169" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">z</span><span class="mo" id="MathJax-Span-5170" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-5171" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-5172" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span><span class="mo" id="MathJax-Span-5173" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.307em; vertical-align: -0.292em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">y=softmax(W^{(S)}(r \circ z) + b)</script></p>
<p>At test time, no dropout, but becuase before you were dropping out a lot of stuff, scale weight matric by dropout prob <span class="MathJax" id="MathJax-Element-117-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5174" style="width: 3.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.097em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5175"><span class="mi" id="MathJax-Span-5176" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-5177" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-5178" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">0.5</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.116em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">p=0.5</script>: <span class="MathJax" id="MathJax-Element-118-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5179" style="width: 6.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.8em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.199em, 1000em, 2.908em, -0.497em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5180"><span class="msubsup" id="MathJax-Span-5181"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(2.868em, 1000em, 4.185em, -0.497em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-5182"><span class="mrow" id="MathJax-Span-5183"><span class="munderover" id="MathJax-Span-5184"><span style="display: inline-block; position: relative; width: 0.957em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5185" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.396em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-5186" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.996em; left: 0.957em;"><span class="texatom" id="MathJax-Span-5187"><span class="mrow" id="MathJax-Span-5188"><span class="mo" id="MathJax-Span-5189" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5190" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-5191" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5192" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-5193" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="msubsup" id="MathJax-Span-5194"><span style="display: inline-block; position: relative; width: 2.005em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.436em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5195" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 1.029em;"><span class="texatom" id="MathJax-Span-5196"><span class="mrow" id="MathJax-Span-5197"><span class="mo" id="MathJax-Span-5198" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5199" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-5200" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.647em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">\hat W^{(S)} = pW^{(S)}</script></p>
<p>Also: Constrain <span class="MathJax" id="MathJax-Element-119-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5201" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 2.515em, -0.466em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-5202"><span class="msubsup" id="MathJax-Span-5203"><span style="display: inline-block; position: relative; width: 0.806em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.466em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5204" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.337em;"><span class="mn" id="MathJax-Span-5205" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.05em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">l_2</script> norms of weight vectors of each class to a fixed number s. Not very common. If weights were too large, they were rescaled so that they equal 3. Not very common to do.</p>
</div><div class="cell text-cell"><img src="resources/FFC2C3228CBBFCA0A63C7C98AD2077CC.png" alt="Screenshot 2020-01-24 at 4.34.15 PM.png" width="593" height="450"></div><div class="cell text-cell"><h2>Very Deep CNNs for Text Classification (VD-CNN)</h2>
<p>(Conneau, Schwenl, LeCun, EACL2017).<br>
Starting Point: Build a computer vision-like CNN stack for NLP. This is significant because previous CNNs for NLP has not been very deep.</p><p>The authors started from the character level onwards. They truncate or pad documents to 1024 documents.</p><p></p><ol><li>For each character, learn a character embedding of dim 16 (dim is not 16x1024)<br></li><li>Stick that through a convolutional layer with a kernel size of 3 and 64 output channel (dim is now 64x2014)</li><li>For n in 64,128,256,512:<br></li><ol><li>Stick that through a convolutional block of size (3,n) x2</li><li>Do local pool to halve the size of the size of the sentence but doubple the size of the channels (features). Ourput is size n x 1024/(n/64). Don't do on last loop.</li></ol><li>Do k-max pooling, keep 8 strongest values in each channel. (Dim=512 x 8)<br></li><li>Put it through 3 fully connected layers (512x8xnum_classes)<br></li></ol><p></p>
<p>Each Convolutional block is two convolutional layers of kernel 3, each collowed by batch norm and a ReLU nonlinearity. Pad to preserve dimension. Each convolutional block also has a skip connection that goes directly from the start of the block to the end.</p>
</div><div class="cell text-cell"><img src="resources/76CAF87D1AA32CCE98F3839C158116AB.png" alt="Screenshot 2020-01-24 at 5.25.59 PM.png" width="1040" height="816"><br><div><img src="resources/11756A5592295E72679622222A51BE82.png" alt="Screenshot 2020-01-24 at 5.25.36 PM.png" width="570" height="437"><br></div></div><div class="cell markdown-cell"><p>They used huge datasets to test their model<br>
Deeper networks work better up to 29 layers, after that point, it didn't much better with depth.</p>
<p>In vision, people generally use ResNet50 or ReNet101 for good results. They only use ResNet34 for a very lightweigh model. But in language it seems that the model stops improving after depth ~30.</p>
</div><div class="cell markdown-cell"><h2>Quasi-Recurrent Neural Networks (Q-RNN, which are actually CNNs)</h2>
<p>RNNs are a standard building blocks for NLP, but they paralleize badly and slowly. Idea: Take the best and paralleizable parts of RNNs and CNNs.</p>
<p>Rather than doing the standard LSTM things which is calculate the update value and gates for your new time slice, we instaed stick a relation between <span class="MathJax" id="MathJax-Element-120-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5206" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5207"><span class="mi" id="MathJax-Span-5208" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-5209" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mn" id="MathJax-Span-5210" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.888em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">t-1</script> and <span class="MathJax" id="MathJax-Element-121-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5211" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5212"><span class="mi" id="MathJax-Span-5213" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.743em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">t</script> states into the max-pooling layer of a CNN.</p>
<p>So we still compute candidate, forget, and ourput gates, but these candidates and gated values are done inside a pooling layer via a convolutional operation. So element-wise gaten pseudo-recurrence ofr parallelism across channels is done in pooling layer: <span class="MathJax" id="MathJax-Element-122-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5214" style="width: 13.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.937em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.953em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5215"><span class="msubsup" id="MathJax-Span-5216"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5217" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-5218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5219" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-5220" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5221" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.066em; left: 0.304em;"><span class="mi" id="MathJax-Span-5222" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5223" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⊙</span><span class="msubsup" id="MathJax-Span-5224" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.708em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5225" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="texatom" id="MathJax-Span-5226"><span class="mrow" id="MathJax-Span-5227"><span class="mi" id="MathJax-Span-5228" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-5229" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-5230" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5231" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-5232" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mn" id="MathJax-Span-5233" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-5234" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-5235" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5236" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.066em; left: 0.304em;"><span class="mi" id="MathJax-Span-5237" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5238" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-5239" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⊙</span><span class="msubsup" id="MathJax-Span-5240" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5241" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5242" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.161em; vertical-align: -0.34em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">h_t = f_t \odot h_{t-1} + (1-f_t) \odot z_t</script></p>
</div><div class="cell text-cell"><img src="resources/D76E4A94DE7320D4BC8DFF93C4F7D78E.png" alt="Screenshot 2020-01-25 at 12.30.53 PM.png" width="291" height="367"></div><div class="cell markdown-cell"><p>In the pseudo-recurrence, you are modeling an interaction between words and the words next to it at each time slice, but its just worked out locally rather than being carried forward in one layer. But if you made your networks deeper using Q-RNNs, you expand your window of inference and you get a certain window of carry forward interactions.</p>
<p>Q-RNNS are not always better than LSTMs, but they are much faster. Long-term this isn't the idea that will end up winning out (Transformers will likely be that idea).</p>
<h3>More detail about Q-RNNs:</h3>
<p>QRNNs use a regular convolution layer in the timestep dimension to compute three vectors for each input: a candidate vector, a forget gate, and an output gate.<br>
More specifically, given an input sequence of <span class="MathJax" id="MathJax-Element-123-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5243" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5244"><span class="mi" id="MathJax-Span-5245" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-123">n</script>-dimensional vectors <span class="MathJax" id="MathJax-Element-124-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5246" style="width: 5.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.18em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.853em, -0.534em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5247"><span class="msubsup" id="MathJax-Span-5248"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5249" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mn" id="MathJax-Span-5250" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5251" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-5252" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5253" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mn" id="MathJax-Span-5254" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5255" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-5256" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5257" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5258" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="msubsup" id="MathJax-Span-5259" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.029em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5260" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-5261" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">x_1, x_2, ... x_T</script> , the convolution layer for the candidate vectors with <span class="MathJax" id="MathJax-Element-125-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5262" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5263"><span class="mi" id="MathJax-Span-5264" style="font-family: STIXGeneral-Italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-125">m</script> filters produces a sequence of <span class="MathJax" id="MathJax-Element-126-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5265" style="width: 0.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.676em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5266"><span class="mi" id="MathJax-Span-5267" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-126">T</script>  m-dimensional output vectors <span class="MathJax" id="MathJax-Element-127-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5268" style="width: 6.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.462em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.853em, -0.509em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5269"><span class="msubsup" id="MathJax-Span-5270"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5271" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-5272" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5273" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-5274" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5275" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-5276" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5277" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-5278" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5279" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5280" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5281" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-5282" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5283" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5284" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.767em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">z_1, z_2, ..., z_T</script>. The same goes for the forget gates and output gates. The precise equations are<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-128-Frame" style=""><nobr><span class="math" id="MathJax-Span-5285" style="width: 15.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.682em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.219em, 1000em, 4.111em, -0.487em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-5286"><span class="mtable" id="MathJax-Span-5287" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 13.345em; height: 0px;"><span style="position: absolute; clip: rect(2.461em, 1000em, 6.316em, -0.654em); top: -4.505em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.86em, -0.509em); top: -3.98em; right: 0em;"><span class="mtd" id="MathJax-Span-5288"><span class="mrow" id="MathJax-Span-5289"><span class="msubsup" id="MathJax-Span-5290"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5291" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5292" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5293" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.687em, 1000em, 2.953em, -0.654em); top: -2.546em; right: 0em;"><span class="mtd" id="MathJax-Span-5329"><span class="mrow" id="MathJax-Span-5330"><span class="msubsup" id="MathJax-Span-5331"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5332" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.066em; left: 0.304em;"><span class="mi" id="MathJax-Span-5333" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5334" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.937em, 1000em, 2.86em, -0.509em); top: -1.049em; right: 0em;"><span class="mtd" id="MathJax-Span-5369"><span class="mrow" id="MathJax-Span-5370"><span class="msubsup" id="MathJax-Span-5371"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5372" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5373" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5374" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.505em;"></span></span><span style="position: absolute; clip: rect(2.6em, 1000em, 6.814em, -0.494em); top: -4.899em; left: 1.802em;"><span style="display: inline-block; position: relative; width: 11.543em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.999em, -0.494em); top: -3.98em; left: 0em;"><span class="mtd" id="MathJax-Span-5294"><span class="mrow" id="MathJax-Span-5295"><span class="mi" id="MathJax-Span-5296" style="font-family: STIXGeneral-Regular;">tanh</span><span class="mo" id="MathJax-Span-5297"></span><span class="mo" id="MathJax-Span-5298" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5299" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-5300" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-5301" style="font-family: STIXGeneral-Italic;">n</span><span class="msubsup" id="MathJax-Span-5302"><span style="display: inline-block; position: relative; width: 1.428em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5303" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.45em;"><span class="texatom" id="MathJax-Span-5304"><span class="mrow" id="MathJax-Span-5305"><span class="msubsup" id="MathJax-Span-5306"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.49em, -0.457em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-5307" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.052em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.624em;"><span class="mi" id="MathJax-Span-5308" style="font-size: 50%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-5309" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-5310"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5311" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-5312" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5313" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-5314" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5315" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5316" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5317" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-5318" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.493em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5319" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-5320"><span class="mrow" id="MathJax-Span-5321"><span class="mi" id="MathJax-Span-5322" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-5323" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-5324" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-5325" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-5326" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5327" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-5328" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 3.062em, -0.48em); top: -2.546em; left: 0em;"><span class="mtd" id="MathJax-Span-5335"><span class="mrow" id="MathJax-Span-5336"><span class="mi" id="MathJax-Span-5337" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-5338" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5339" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-5340" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-5341" style="font-family: STIXGeneral-Italic;">n</span><span class="msubsup" id="MathJax-Span-5342"><span style="display: inline-block; position: relative; width: 1.428em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5343" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.45em;"><span class="texatom" id="MathJax-Span-5344"><span class="mrow" id="MathJax-Span-5345"><span class="msubsup" id="MathJax-Span-5346"><span style="display: inline-block; position: relative; width: 0.902em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.49em, -0.457em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-5347" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.052em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.624em;"><span class="mi" id="MathJax-Span-5348" style="font-size: 50%; font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.073em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-5349" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-5350"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5351" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-5352" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5353" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-5354" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5355" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5356" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5357" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-5358" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.493em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5359" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-5360"><span class="mrow" id="MathJax-Span-5361"><span class="mi" id="MathJax-Span-5362" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-5363" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-5364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-5365" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-5366" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5367" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-5368" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.964em, -0.48em); top: -1.049em; left: 0em;"><span class="mtd" id="MathJax-Span-5375"><span class="mrow" id="MathJax-Span-5376"><span class="mi" id="MathJax-Span-5377" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-5378" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-5379" style="font-family: STIXGeneral-Italic;">c</span><span class="mi" id="MathJax-Span-5380" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-5381" style="font-family: STIXGeneral-Italic;">n</span><span class="msubsup" id="MathJax-Span-5382"><span style="display: inline-block; position: relative; width: 1.484em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5383" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.45em;"><span class="texatom" id="MathJax-Span-5384"><span class="mrow" id="MathJax-Span-5385"><span class="msubsup" id="MathJax-Span-5386"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.49em, -0.457em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-5387" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.052em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.624em;"><span class="mi" id="MathJax-Span-5388" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-5389" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-5390"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5391" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-5392" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5393" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-5394" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5395" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5396" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-5397" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-5398" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.493em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5399" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-5400"><span class="mrow" id="MathJax-Span-5401"><span class="mi" id="MathJax-Span-5402" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-5403" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-5404" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-5405" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-5406" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5407" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-5408" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.899em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.557em; vertical-align: -2.001em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-128">\begin{align} z_t = & \tanh(conv_{W_z}(x_t, ..., x_{t - k + 1})) \\ f_t = & \sigma(conv_{W_f}(x_t, ..., x_{t - k + 1})) \\ z_t = & \sigma(conv_{W_o}(x_t, ..., x_{t - k + 1}))  \end{align}</script><br>
This is just a normal convolution. The real magic happens in the pooling layer.<br>
Using the inputs computed above, the QRNN computes the hidden states (outputs) according to the following equation:<p></p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-129-Frame" style=""><nobr><span class="math" id="MathJax-Span-5409" style="width: 12.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.092em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.583em, 1000em, 3.309em, -0.321em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-5410"><span class="mtable" id="MathJax-Span-5411" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 10.755em; height: 0px;"><span style="position: absolute; clip: rect(2.744em, 1000em, 5.068em, -0.488em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.858em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.86em, -0.477em); top: -3.178em; right: 0em;"><span class="mtd" id="MathJax-Span-5412"><span class="mrow" id="MathJax-Span-5413"><span class="msubsup" id="MathJax-Span-5414"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5415" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5416" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5417" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.86em, -0.488em); top: -1.79em; right: 0em;"><span class="mtd" id="MathJax-Span-5443"><span class="mrow" id="MathJax-Span-5444"><span class="msubsup" id="MathJax-Span-5445"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.712em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5446" style="font-family: STIXGeneral-Italic;">h</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-5447" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5448" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.507em, 1000em, 5.068em, -0.654em); top: -3.998em; left: 1.858em;"><span style="display: inline-block; position: relative; width: 8.896em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.953em, -0.654em); top: -3.178em; left: 0em;"><span class="mtd" id="MathJax-Span-5418"><span class="mrow" id="MathJax-Span-5419"><span class="msubsup" id="MathJax-Span-5420"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5421" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.066em; left: 0.304em;"><span class="mi" id="MathJax-Span-5422" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5423" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∘</span><span class="msubsup" id="MathJax-Span-5424" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5425" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-5426"><span class="mrow" id="MathJax-Span-5427"><span class="mi" id="MathJax-Span-5428" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-5429" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-5430" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5431" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-5432" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mn" id="MathJax-Span-5433" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-5434" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-5435" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5436" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.066em; left: 0.304em;"><span class="mi" id="MathJax-Span-5437" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5438" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-5439" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∘</span><span class="msubsup" id="MathJax-Span-5440" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5441" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5442" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.924em, 1000em, 2.86em, -0.48em); top: -1.79em; left: 0em;"><span class="mtd" id="MathJax-Span-5449"><span class="mrow" id="MathJax-Span-5450"><span class="msubsup" id="MathJax-Span-5451"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5452" style="font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-5453" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-5454" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∘</span><span class="msubsup" id="MathJax-Span-5455" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5456" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5457" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.775em; vertical-align: -1.11em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-129">\begin{align} c_t = & f_t \circ c_{t-1} + (1 - f_t) \circ z_t \\ h_t = & o_t \circ c_t  \end{align}</script><p></p>
<p>where <span class="MathJax" id="MathJax-Element-130-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5458" style="width: 0.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.394em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.978em, 1000em, 2.586em, -0.467em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5459"><span class="mo" id="MathJax-Span-5460" style="font-family: STIXGeneral-Regular;">∘</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.425em; vertical-align: 0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-130">\circ</script> is the Hadamard product.</p>
<p>This equation looks like the equation for the LSTM, and the difference may seem a bit unclear at first. The important difference is that the sequential processing only occurs in the pooling layer and that the values of <span class="MathJax" id="MathJax-Element-131-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5461" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.509em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-5462"><span class="msubsup" id="MathJax-Span-5463"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5464" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-5465" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">z_t</script>, <span class="MathJax" id="MathJax-Element-132-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5466" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.349em, 1000em, 2.615em, -0.654em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-5467"><span class="msubsup" id="MathJax-Span-5468"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5469" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.066em; left: 0.304em;"><span class="mi" id="MathJax-Span-5470" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.155em; vertical-align: -0.34em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-132">f_t</script>, and <span class="MathJax" id="MathJax-Element-133-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5471" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.48em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-5472"><span class="msubsup" id="MathJax-Span-5473"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-5474" style="font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-5475" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-133">o_t</script> do not depend on any previous values. This is the essence of QRNNs: do the heavy computation in parallel and do minimal sequential processing in the pooling layers.</p>
<p>That is, the output hidden states of each layer of a Q-RNN at each position do contain some and may be overwritten by some 'past' information as determined by the forget and ourput gates, but it can only be as far past as the kernel size.Thus for each layer, the span of dependencies that can be learned in the feature representation is only the kernel size, but longer and longer dependencies can be learned as we increase the depth.</p>
<p><a href="https://mlexplained.com/2018/04/09/paper-dissected-quasi-recurrent-neural-networks-explained/">Source</a></p>
</div><div class="cell text-cell"><img src="resources/5A2985923E8C111B81B923D26D967DAD.png" alt="Screenshot 2020-01-24 at 7.18.50 PM.png" width="690" height="174">\<div><img src="resources/9BD04A6BADA9074AE05C77AD15858B10.png" alt="Screenshot 2020-01-24 at 7.22.29 PM.png" width="703" height="517"><br></div></div><div class="cell markdown-cell"><h1>General Ideas in ConvNets for NLP</h1>
<h2>Gating Units used Vertically</h2>
<p>The gating/skipping that we wall in LSTMs and GRUs is a general idea, which is now used in a whole bunch of places. You can also gate vertically between layers of convolutions.<br>
Indeed the key idea- summing candidate update with shortcut connection- is needed for very deep networks to work.</p>
</div><div class="cell text-cell"><img src="resources/CA27FB5DB67E6E1A1F2C819CD0C28E3F.png" alt="Screenshot 2020-01-24 at 4.55.52 PM.png" width="571" height="226"></div><div class="cell markdown-cell"><h2></h2>
<h3>Residual Block (He et al 2016)</h3>
<p>Simple skip connection, used in ResNet. The skipped embedding is added (not concatenated) to the output of the Conv layer.</p>
<h3>Highway block (Srivistava et al 2015)</h3>
<p>Instead of adding the identity and the Conv layer, multiply the Conv layer outout to a <span class="MathJax" id="MathJax-Element-126-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5265" style="width: 0.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.676em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5266"><span class="mi" id="MathJax-Span-5267" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-126">T</script> gate and the identity ourput to a <span class="MathJax" id="MathJax-Element-134-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-5476" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.441em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5477"><span class="mi" id="MathJax-Span-5478" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.884em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-134">C</script> gate.</p>
<p>The residual block is about just as powerful as a highway block, and it is also simpler. How to interpret the residual block is that the default action is to carry over the identity to the next layer, and the job of the Conv block is to learn the deviations from the identity which should be taken between the layer.</p>
<p>The highway block seems more powerful as you are able to control both how much of the identity and how much of the new signal gets carried forth. But it isn't really, because you have have the Conv block in the residual network learn the amount of identity signal to lose.</p>
</div><div class="cell markdown-cell"><h1>Appendix</h1>
<p>(1) 1D CNNs in Pytorch</p>
<pre><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>batch_size = 16
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>word_embed_size = 4
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>seq_len = 7
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>input = torch.randn(batch_size, word_embed_size, seq_len)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>conv1 = Conv1d(in_channels=word_embed_size, out_channels=3, kernel_size=3) # can add: padding=1
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>hidden1 = conv1(input)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>hidden2 = torch.max(hidden1, dim=2) # max pool
</div></div></div></pre>
<p>(2) Other less helpful notions:<br>
The below are all ways to compress data. They are from vision, not many people actually use them in NLP.</p>
<ul>
<li>Stride(2) - We can jump every 2 words in the convolution. Rarely used.</li>
<li>Local Max Pool, Stride=2. After getting the features from the convolutions, compress the representation into half the size by taking the max of every 2 positions.</li>
<li>k-max pooling over time:
<ul>
<li>pick the k highest activations in the sequence and keep them in the order they origianlly appeared, throwing out the rest.</li>
</ul>
</li>
</ul>
</div><div class="cell text-cell"><img src="resources/C1E3468969DF1E74B61921AC47A775B3.png" alt="Screenshot 2020-01-24 at 4.18.22 PM.png" width="575" height="428"><div><img src="resources/7FBD2EAB02EA2558A3385241EA8CA3D9.png" alt="Screenshot 2020-01-24 at 4.19.12 PM.png" width="586" height="428"><br></div><div><br></div></div><div class="cell text-cell"><img src="resources/D522F76EBD1BA3560E522210314E5D1E.png" alt="Screenshot 2020-01-24 at 4.20.49 PM.png" width="605" height="447"><br><div><br></div><div>(3) Comparison of models simple to complex:</div><div><img src="resources/C8A625EF3B24AE4210A47A40BB3855DD.png" alt="Screenshot 2020-01-24 at 4.41.40 PM.png" width="598" height="426"><br></div><div><br></div><div>(4) CNN on NMT (2013, very old, the first NMT paper of the modern era)</div><div>The encoder was a CNN, which was decoded with a sequence model.</div><div>It’s really easy to use CNN as encoders.</div><div>It’s harder to use CNNs as decoders (because you have to use masking of future words during training).</div><div><img src="resources/F2BF19AC8C14A4FC0E74945B2C6B122D.png" alt="Screenshot 2020-01-24 at 5.05.26 PM.png" width="602" height="456"><br></div><div><br></div><div>(5) Character level CNNs for POS tagging</div><div>Character level CNNs to build a word embedding.</div><div><img src="resources/A05EB46DDB3B6FCC77A0247A45A1715D.png" alt="Screenshot 2020-01-24 at 5.08.42 PM.png" width="594" height="445"><br></div></div><div class="cell markdown-cell"></div></div>

    </body>
    </html>
  