
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>Lecture 12 - Network Embeddings (Graph Representations)</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><h2>Network node embeddings (Graph Representation Learning)</h2>
<ul>
<li>Goal: Efficient task-independent graph embeddings, for applications including clustering/community detection, node classification, and link prediction (Example (1)).</li>
</ul>
</div><div class="cell text-cell"><img src="resources/03B98EC3049413ABB4778C860169809E.png" alt="Screenshot 2019-10-29 at 7.34.57 PM.png" width="559" height="203"><div></div></div><div class="cell text-cell"><img src="resources/EE3DB606FD41C2A52B1624D29C565522.png" alt="Screenshot 2019-10-29 at 7.36.15 PM.png" width="486" height="120"><div></div></div><div class="cell markdown-cell"><p>Assume we have a Graph <span class="MathJax" id="MathJax-Element-245-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2824" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2825"><span class="mi" id="MathJax-Span-2826" style="font-family: STIXGeneral-Italic;">G</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.884em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">G</script> with vertex set <span class="MathJax" id="MathJax-Element-246-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2827" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2828"><span class="mi" id="MathJax-Span-2829" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">V</script>, and adjacency matrix <span class="MathJax" id="MathJax-Element-247-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2830" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2831"><span class="mi" id="MathJax-Span-2832" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">A</script>.</p>
<p><strong>Goal:</strong> Embed the nodes so that similairity in the embedding space (e.g. dot product) approximates similarity in the originla network, in terms of the graph neighborhood. To accomplish this we learn an encoding function <span class="MathJax" id="MathJax-Element-248-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2833" style="width: 3.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.759em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.508em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2834"><span class="mi" id="MathJax-Span-2835" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mi" id="MathJax-Span-2836" style="font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-2837" style="font-family: STIXGeneral-Italic;">c</span><span class="mo" id="MathJax-Span-2838" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2839" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-2840" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-248">Enc(v)</script>.</p>
<p>Sub-goals</p>
<ol>
<li>Define an encoder (a mapping from nodes to embeddings)</li>
<li>Define a node similarity function (i.e. a measure of similarity in the original network)</li>
<li>Optimize the parameters of the encoder so that<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-249-Frame" style=""><nobr><span class="math" id="MathJax-Span-2841" style="width: 10.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.234em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.559em, 1000em, 2.909em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2842"><span class="mi" id="MathJax-Span-2843" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-2844" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2845" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2846" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2847" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-2848" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-2849" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2850" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mi" id="MathJax-Span-2851" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-2852" style="font-family: STIXGeneral-Italic;">y</span><span class="mo" id="MathJax-Span-2853" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2854" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2855" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2856" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-2857" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2858" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span><span class="msubsup" id="MathJax-Span-2859" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2860" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-2861" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.49em, -0.493em); top: -2.161em; left: 0.45em;"><span class="mi" id="MathJax-Span-2862" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2863"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2864" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2865" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.249em; vertical-align: -0.291em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-249">similiarty(u,v) \approx z_v^T z_u</script></li>
</ol>
<p>Aside. Basic Starter Example: "Shallow Encoding"</p>
<ul>
<li>Simplest encoding approach: encoder is just an embedding-lookup. Each node is assigned a unique embedding vector. That is,<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-250-Frame" style=""><nobr><span class="math" id="MathJax-Span-2866" style="width: 6.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.631em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.508em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2867"><span class="mi" id="MathJax-Span-2868" style="font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mi" id="MathJax-Span-2869" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-2870" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.022em;"></span></span><span class="mo" id="MathJax-Span-2871" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2872" style="font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-2873" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2874" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-2875" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mi" id="MathJax-Span-2876" style="font-family: STIXGeneral-Italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-250">ENC(v) = Z v</script>, and v is a one-hot indicator vector and Z is the matrix of all the embedding columns.</li>
</ul>
</div><div class="cell text-cell"><img src="resources/AA4249DE1FEE4F344884DC15C33A39D0.png" alt="Screenshot 2019-10-29 at 7.43.43 PM.png" width="573" height="247"></div><div class="cell markdown-cell"><p>Aside: How to define node similarity?<br>
Key choice of methods is how they define node similarity.<br>
Should two nodes have similar embeddings if they</p>
<ul>
<li>are connected?</li>
<li>share neighbors?</li>
<li>have similar 'structural roles'? (no)</li>
</ul>
<h2>DeepWalk: Random Walk Approaches to Node Embeddings</h2>
<p>We say that <span class="MathJax" id="MathJax-Element-251-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2877" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.559em, 1000em, 2.865em, -0.509em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2878"><span class="msubsup" id="MathJax-Span-2879"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2880" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-2881" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.477em); top: -2.161em; left: 0.45em;"><span class="mi" id="MathJax-Span-2882" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2883"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2884" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2885" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2886" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.2em; vertical-align: -0.243em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-251">z_u^Tz_v \approx</script> Prob that u and v co-occuer on a random walk over the network.<br>
We want to estimate the prob of visditing node v on a random walk starting from node u using some random walk strategy R (<span class="MathJax" id="MathJax-Element-252-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2887" style="width: 3.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.984em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2888"><span class="msubsup" id="MathJax-Span-2889"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2890" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-2891" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2892" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2893" style="font-family: STIXGeneral-Italic;">v</span><span class="texatom" id="MathJax-Span-2894"><span class="mrow" id="MathJax-Span-2895"><span class="mo" id="MathJax-Span-2896" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2897" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2898" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-252">P_R(v|u)</script>).<br>
And then optimize embeddings to encode these random walk statistics. This is called <strong>DeepWalk</strong></p>
<p>Algo: DeepWalk:</p>
<ol>
<li>Run short, fixed-length random walks starting from each node on the graph using some strategy R.</li>
<li>For each node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script> collect <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script>, the multiset of nodes visited on random walks starting from <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script>.(2)</li>
<li>Optimize embeddings according to: Given node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script>, predict its neighbots <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script>, to minimize the sum log likelihood of neighbors:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-255-Frame" style=""><nobr><span class="math" id="MathJax-Span-2910" style="width: 11.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.473em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 3.972em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2911"><span class="mi" id="MathJax-Span-2912" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-2913" style="font-family: STIXGeneral-Italic;">a</span><span class="msubsup" id="MathJax-Span-2914"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2915" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-2916" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2917" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.028em;"><span class="mo" id="MathJax-Span-2918" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.597em, -0.477em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-2919"><span class="mrow" id="MathJax-Span-2920"><span class="mi" id="MathJax-Span-2921" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2922" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-2923" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2924" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2925"></span><span class="mo" id="MathJax-Span-2926" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2927" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-2928" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2929"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2930" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2931" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2932" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2933" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2934" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-2935"><span class="mrow" id="MathJax-Span-2936"><span class="mo" id="MathJax-Span-2937" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2938"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2939" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2940" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2941" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.616em; vertical-align: -1.471em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-255">max_z \sum_{u \in V} \log(P(N_R(u)|z_u)</script> (5,6 )<br>
where we define probability using the softmax parameterization.</li>
</ol>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-256-Frame" style=""><nobr><span class="math" id="MathJax-Span-2942" style="width: 14.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.782em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.991em, 1000em, 3.76em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2943"><span class="mi" id="MathJax-Span-2944" style="font-family: STIXGeneral-Italic;">P</span><span class="mi" id="MathJax-Span-2945" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-2946" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2947"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2948" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2949" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2950"><span class="mrow" id="MathJax-Span-2951"><span class="mo" id="MathJax-Span-2952" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2953"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2954" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2955" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2956" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2957" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-2958" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 7.496em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.92em, -0.482em); top: -3.232em; left: 50%; margin-left: -2.365em;"><span class="mrow" id="MathJax-Span-2959"><span class="mi" id="MathJax-Span-2960" style="font-family: STIXGeneral-Regular;">exp</span><span class="mo" id="MathJax-Span-2961"></span><span class="mo" id="MathJax-Span-2962" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2963"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2964" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2965" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2966" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋅</span><span class="msubsup" id="MathJax-Span-2967" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2968" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2969" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2970" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.604em, 1000em, 3.018em, -0.449em); top: -1.792em; left: 50%; margin-left: -3.688em;"><span class="mrow" id="MathJax-Span-2971"><span class="munderover" id="MathJax-Span-2972"><span style="display: inline-block; position: relative; width: 2.44em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-2973" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-2974"><span class="mrow" id="MathJax-Span-2975"><span class="mi" id="MathJax-Span-2976" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-2977" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-2978" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2979" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">exp</span><span class="mo" id="MathJax-Span-2980"></span><span class="mo" id="MathJax-Span-2981" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2982"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2983" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2984" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2985" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋅</span><span class="msubsup" id="MathJax-Span-2986" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2987" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2988" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2989" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 7.496em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.823em; vertical-align: -1.236em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-256">Pr(z_v | z_u) = \frac{\exp(z_v \cdot z_u)}{\sum_{n \in V} \exp(z_n \cdot z_u)}</script><br>
Note that this assumes independence: Conditional likelihood factoizes over the set of neighbors (you can add log likelihoods).<p></p>
<p>In actuality, we have to estimate the log likelihood using random sampling, and the true equaiton used for computation is given below. (3)<br>
The above method is essentially work2vec, applied to random walks over the graph interpreted as 'sentences'. (6)</p>
<h3>Computational Process:</h3>
<p><strong>Must use negative sampling</strong></p>
</div><div class="cell text-cell"><img src="resources/3B7C4BE77E90BF2AE516B040385D37A4.png" alt="Screenshot 2019-10-29 at 8.25.35 PM.png" width="532" height="325"></div><div class="cell markdown-cell"><p>But this is too expensive: Nested sum over nodes gives <span class="MathJax" id="MathJax-Element-257-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2990" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.484em, 1000em, 2.88em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2991"><span class="mi" id="MathJax-Span-2992" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-2993" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-2994"><span class="mrow" id="MathJax-Span-2995"><span class="mo" id="MathJax-Span-2996" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-2997" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="msubsup" id="MathJax-Span-2998"><span style="display: inline-block; position: relative; width: 0.694em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2999"><span class="mrow" id="MathJax-Span-3000"><span class="mo" id="MathJax-Span-3001" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.225em;"><span class="mn" id="MathJax-Span-3002" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3003" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.299em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-257">O(|V|^2)</script> complexity, the reason is the normalization term from the softmax.</p>
<p>Solution: <strong>Negative Sampling</strong>:<br>
<i>Distribute the log, replace the exp with a  sigmoid function, and instead of normalizing over all the nodes, just normalize over a random sample of the nodes. You ahve to replace the exp with a sigmoid function because the sigmoid makes each term a "probability" between 0 and 1, putting the numerator and denominator in the same scale and making it possible to normalize over not all the nodes.</i></p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-258-Frame" style=""><nobr><span class="math" id="MathJax-Span-3004" style="width: 12.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.149em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.488em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-3005"><span class="mi" id="MathJax-Span-3006" style="font-family: STIXGeneral-Regular;">log</span><span class="mrow" id="MathJax-Span-3007" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-3008" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">(</span></span><span class="mfrac" id="MathJax-Span-3009"><span style="display: inline-block; position: relative; width: 6.764em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.559em, 1000em, 2.92em, -0.482em); top: -3.232em; left: 50%; margin-left: -1.999em;"><span class="mrow" id="MathJax-Span-3010"><span class="mi" id="MathJax-Span-3011" style="font-family: STIXGeneral-Regular;">exp</span><span class="mo" id="MathJax-Span-3012"></span><span class="mo" id="MathJax-Span-3013" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3014"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3015" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-3016" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.477em); top: -2.161em; left: 0.45em;"><span class="mi" id="MathJax-Span-3017" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3018"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3019" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3020" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3021" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.559em, 1000em, 3.018em, -0.449em); top: -1.747em; left: 50%; margin-left: -3.322em;"><span class="mrow" id="MathJax-Span-3022"><span class="munderover" id="MathJax-Span-3023"><span style="display: inline-block; position: relative; width: 2.44em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-3024" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-3025"><span class="mrow" id="MathJax-Span-3026"><span class="mi" id="MathJax-Span-3027" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-3028" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-3029" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3030" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">exp</span><span class="mo" id="MathJax-Span-3031"></span><span class="mo" id="MathJax-Span-3032" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3033"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3034" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-3035" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.477em); top: -2.161em; left: 0.45em;"><span class="mi" id="MathJax-Span-3036" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3037"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3038" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3039" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3040" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 6.764em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-3041" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">)</span></span></span><span class="mo" id="MathJax-Span-3042" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-258">\log \left( \frac{\exp(z_u^Tz_v)}{\sum_{n \in V} \exp(z_u^Tz_n)} \right) \approx</script><br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-259-Frame" style=""><nobr><span class="math" id="MathJax-Span-3043" style="width: 19.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.962em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.582em, 1000em, 3.96em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3044"><span class="mi" id="MathJax-Span-3045" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-3046"></span><span class="mo" id="MathJax-Span-3047" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3048" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-3049" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3050"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3051" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-3052" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.477em); top: -2.161em; left: 0.45em;"><span class="mi" id="MathJax-Span-3053" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3054"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3055" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3056" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3057" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3058" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3059" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="munderover" id="MathJax-Span-3060" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3061" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3062"><span class="mrow" id="MathJax-Span-3063"><span class="mi" id="MathJax-Span-3064" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3065" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3066" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.557em, 1000em, 2.485em, -0.497em); top: -3.509em; left: 0.507em;"><span class="mi" id="MathJax-Span-3067" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3068" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-3069"><span class="mi" id="MathJax-Span-3070" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-3071"></span><span class="mo" id="MathJax-Span-3072" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3073" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span class="mo" id="MathJax-Span-3074" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3075"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3076" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.653em; left: 0.45em;"><span class="mi" id="MathJax-Span-3077" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.477em); top: -2.161em; left: 0.45em;"><span class="mi" id="MathJax-Span-3078" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3079"><span style="display: inline-block; position: relative; width: 1.142em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3080" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.45em;"><span class="texatom" id="MathJax-Span-3081"><span class="mrow" id="MathJax-Span-3082"><span class="msubsup" id="MathJax-Span-3083"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.484em, -0.497em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3084" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.394em;"><span class="mi" id="MathJax-Span-3085" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3086" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3087" style="font-family: STIXGeneral-Regular;">)</span></span></span><span class="mo" id="MathJax-Span-3088" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3089" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">s</span><span class="mo" id="MathJax-Span-3090" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-3091" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-3092" style="font-family: STIXGeneral-Regular;">.</span><span class="mspace" id="MathJax-Span-3093" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-3094" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3095" style="font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-3096" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3097"><span class="mrow" id="MathJax-Span-3098"><span class="munderover" id="MathJax-Span-3099"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.998em; left: 0.125em;"><span class="mspace" id="MathJax-Span-3100" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.04em, 1000em, 2.52em, -0.467em); top: -2.492em; left: 0em;"><span class="mo" id="MathJax-Span-3101" style="font-family: STIXGeneral-Regular;">~</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-3102"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3103" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-3104" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.5em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-259">\log(\sigma(z_u^Tz_v)) - \sum_{i=1}^k {\log(\sigma(z_u^Tz_{n_i}))}, s.t.  \; n_i \tilde \;P_V</script><p></p>
<p>How to we take the ramdom samples? We sample <span class="MathJax" id="MathJax-Element-260-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3105" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3106"><span class="mi" id="MathJax-Span-3107" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.895em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">k</script> negative nodes proportional to degree. In practice, k = 5 - 20.</p>
<p>(Ref 5)<br>
So in actuality, in step 3. above, we optimize embeddings using Stochastic Gradient Descent according to</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-261-Frame" style=""><nobr><span class="math" id="MathJax-Span-3108" style="width: 13.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.444em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 4.078em, -0.474em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3109"><span class="texatom" id="MathJax-Span-3110"><span class="mrow" id="MathJax-Span-3111"><span class="mi" id="MathJax-Span-3112" style="font-family: STIXGeneral-Italic;">ℒ</span></span></span><span class="mo" id="MathJax-Span-3113" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-3114" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.028em;"><span class="mo" id="MathJax-Span-3115" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.597em, -0.477em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-3116"><span class="mrow" id="MathJax-Span-3117"><span class="mi" id="MathJax-Span-3118" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3119" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-3120" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3121" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.646em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.648em;"><span class="mo" id="MathJax-Span-3122" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.703em, -0.493em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-3123"><span class="mrow" id="MathJax-Span-3124"><span class="mi" id="MathJax-Span-3125" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-3126" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-3127"><span style="display: inline-block; position: relative; width: 0.912em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.488em, -0.521em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3128" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.521em;"><span class="mi" id="MathJax-Span-3129" style="font-size: 50%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-3130" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3131" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3132" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3133" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-3134"><span class="mo" id="MathJax-Span-3135" style="font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3136" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3137"></span><span class="mo" id="MathJax-Span-3138" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3139" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-3140" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3141" style="font-family: STIXGeneral-Italic;">v</span><span class="texatom" id="MathJax-Span-3142"><span class="mrow" id="MathJax-Span-3143"><span class="mo" id="MathJax-Span-3144" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3145"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3146" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3148" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3149" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.734em; vertical-align: -1.589em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-261">\mathscr{L} = \sum_{u \in V} \sum_{v \in N_R(u)} {-\log( P(v|z_u))} </script><br>
with <span class="MathJax" id="MathJax-Element-262-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3150" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3151"><span class="mi" id="MathJax-Span-3152" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-3153" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3154" style="font-family: STIXGeneral-Italic;">v</span><span class="texatom" id="MathJax-Span-3155"><span class="mrow" id="MathJax-Span-3156"><span class="mo" id="MathJax-Span-3157" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3158"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3159" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3160" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3161" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-262">P(v|z_u)</script> defined according to the softmax and efficiently appromated using negatie sampling. (4)<p></p>
<p>How should we randomly walk? Simplest idea in DeepWalk is to just run fixed-length, unbiased random walks starting from each node, but such a notion of siilarity has flaws. Node2Vec (Jure's discovery, Grover and Leskovec, 2016) uses a biased random walk instead.</p>
<h2>Node2Vec:</h2>
<ul>
<li>Goal is Same as above: Embed nodes with similar network neighborhoods close in the fature space. We frame this goal as prediction-task independent maximum likelihood optimization problem. (7)</li>
<li>Idea: Uses biased random walks to trade off between local and global views of the network. In some ways this is like an interpolation between a BFS and DFS search over the network.</li>
</ul>
</div><div class="cell text-cell"><img src="resources/195140CE330EE82AC2A862976211BE73.png" alt="Screenshot 2019-10-29 at 9.16.04 PM.png" width="570" height="437"></div><div class="cell markdown-cell"><p>Def: A biased fixed-length random walk R that given a node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script> generates neighborhood <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> is defined by two parameters: (8)</p>
<ul>
<li>Return parameter <span class="MathJax" id="MathJax-Element-264-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3165" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3166"><span class="mi" id="MathJax-Span-3167" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">p</script>: Return back to the previous node
<ul>
<li>As the random walk make a step, with prob <span class="MathJax" id="MathJax-Element-264-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3165" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3166"><span class="mi" id="MathJax-Span-3167" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">p</script> you return to the last step.</li>
</ul>
</li>
<li>In-out parameter <span class="MathJax" id="MathJax-Element-266-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3171" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3172"><span class="mi" id="MathJax-Span-3173" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">q</script>:
<ul>
<li>Moving outwards (DFS) vs inwards (BFS)</li>
<li>Intuitively, <span class="MathJax" id="MathJax-Element-266-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3171" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3172"><span class="mi" id="MathJax-Span-3173" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">q</script> is the 'ratio' of BFS vs DFS.</li>
</ul>
</li>
</ul>
<p>The biased 2nd order random walks explore network neirhborhoods in the following way: Suppose the random walk just traversed edge <span class="MathJax" id="MathJax-Element-267-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3174" style="width: 3.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.759em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3175"><span class="mo" id="MathJax-Span-3176" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3177"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3178" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3179" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3180" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3181" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-3182" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-267">(s_1, w)</script> and is now at <span class="MathJax" id="MathJax-Element-268-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3183" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3184"><span class="mi" id="MathJax-Span-3185" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-268">w</script>. At every step, there are three possible actions:</p>
<ul>
<li>Go back to the previous node (decrease distance 1)</li>
<li>Maintain the same distance to the starting node (simulates BFS).</li>
<li>Go to a node one farther from the starting node (simulates DFS).</li>
</ul>
</div><div class="cell text-cell"><img src="resources/23088742F66B53C7428E08C89B101C4B.png" alt="Screenshot 2019-10-29 at 9.18.19 PM.png" width="450" height="189"><div><img src="resources/0D7B58F532CB7768E02C20BF0CF1CF7F.png" alt="Screenshot 2019-10-29 at 9.23.13 PM.png" width="550" height="325"><br></div></div><div class="cell markdown-cell"><ul>
<li>We use <span class="MathJax" id="MathJax-Element-273-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3198" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3199"><span class="mi" id="MathJax-Span-3200" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">p</script> and <span class="MathJax" id="MathJax-Element-274-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3201" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3202"><span class="mi" id="MathJax-Span-3203" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">q</script> to put transition proabilities over the edges as sbove.
<ul>
<li>a BFS-like walk has a low value of <span class="MathJax" id="MathJax-Element-273-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3198" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3199"><span class="mi" id="MathJax-Span-3200" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">p</script>, a DFS-like walk has a low value of <span class="MathJax" id="MathJax-Element-274-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3201" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3202"><span class="mi" id="MathJax-Span-3203" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">q</script>. THe difference between BFS and DFS is that BFS captures the micro-view of the neighborhood, while DFS captures the macro-view of the neighborhood. (Example- (8)) The neighborhood <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> are the nodes visited by the ramdom walk.</li>
</ul>
</li>
</ul>
<p>So the full algo is:</p>
<h3>Algo (Node2Vec):</h3>
<ol>
<li>Compute random walk probabilities given <span class="MathJax" id="MathJax-Element-273-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3198" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3199"><span class="mi" id="MathJax-Span-3200" style="font-family: STIXGeneral-Italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">p</script> and <span class="MathJax" id="MathJax-Element-274-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3201" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3202"><span class="mi" id="MathJax-Span-3203" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">q</script>.</li>
<li>Simulate r random walks of length <span class="MathJax" id="MathJax-Element-275-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3204" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.466em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3205"><span class="mi" id="MathJax-Span-3206" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.895em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-275">l</script> starting from eahch node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script></li>
<li>Optimize the node2vec objective using SGD.</li>
</ol>
<p>Node2vec has linear time-complexity, and all three steps are individually parallelizable.</p>
<h2>Final Notes</h2>
<h3>How to use embeddings:</h3>
<ul>
<li>Clustering/community detection: Cluster nodes/points based on <span class="MathJax" id="MathJax-Element-279-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3223" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.509em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3224"><span class="msubsup" id="MathJax-Span-3225"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3226" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3227" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-279">z_i</script>.</li>
<li>Node classificaiton: Predict label <span class="MathJax" id="MathJax-Element-277-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3212" style="width: 2.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.858em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3213"><span class="mi" id="MathJax-Span-3214" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3215" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3216"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3217" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3219" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.107em; vertical-align: -0.292em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-277">f(z_i)</script> of node <span class="MathJax" id="MathJax-Element-278-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3220" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.711em, 1000em, 2.714em, -0.458em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3221"><span class="mi" id="MathJax-Span-3222" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.863em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-278">i</script> based on <span class="MathJax" id="MathJax-Element-279-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3223" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.509em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3224"><span class="msubsup" id="MathJax-Span-3225"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3226" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3227" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-279">z_i</script>.</li>
<li>Link prediction: Predict edge <span class="MathJax" id="MathJax-Element-280-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3228" style="width: 1.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.91em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3229"><span class="mo" id="MathJax-Span-3230" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3231" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3232" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3233" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-3234" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.105em; vertical-align: -0.292em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-280">(i,j)</script> based on <span class="MathJax" id="MathJax-Element-282-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3247" style="width: 3.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.097em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3248"><span class="mi" id="MathJax-Span-3249" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3250" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3251"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3252" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3253" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3254" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3255" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3256" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3257" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3258" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-282">f(z_i,z_j)</script>
<ul>
<li>We can have <span class="MathJax" id="MathJax-Element-282-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3247" style="width: 3.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.097em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3248"><span class="mi" id="MathJax-Span-3249" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3250" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3251"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3252" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3253" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3254" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3255" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3256" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3257" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3258" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-282">f(z_i,z_j)</script> be the concatenation, avg, product, or differnece between the embeddings.</li>
<li>Concatenate: <span class="MathJax" id="MathJax-Element-283-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3259" style="width: 9.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.164em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3260"><span class="mi" id="MathJax-Span-3261" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3262" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3263"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3264" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3265" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3266" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3267" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3268" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3269" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3270" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3271" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3272" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">g</span><span class="mo" id="MathJax-Span-3273" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-3274" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-3275"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3276" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3277" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3278" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3279" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3280" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3281" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3282" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3283" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-283">f(z_i,z_j) = g([z_i,z_j])</script></li>
<li>Hadamard: <span class="MathJax" id="MathJax-Element-284-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3284" style="width: 9.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.108em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3285"><span class="mi" id="MathJax-Span-3286" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3287" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3288"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3289" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3290" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3291" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3292" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3293" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3294" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3295" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3296" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3297" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">g</span><span class="mo" id="MathJax-Span-3298" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3299"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3300" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3301" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3302" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∗</span><span class="msubsup" id="MathJax-Span-3303" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3304" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3305" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3306" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-284">f(z_i,z_j) = g(z_i * z_j)</script> (per-coordinate product)</li>
<li>Sum/Avg: <span class="MathJax" id="MathJax-Element-285-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3307" style="width: 9.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.277em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3308"><span class="mi" id="MathJax-Span-3309" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3310" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3311"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3312" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3313" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3314" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3315" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3316" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3317" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3318" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3319" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3320" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">g</span><span class="mo" id="MathJax-Span-3321" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3322"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3323" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3324" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3325" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3326" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3327" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3328" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3329" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-285">f(z_i,z_j) = g(z_i+z_j)</script></li>
<li>Distance: <span class="MathJax" id="MathJax-Element-286-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3330" style="width: 10.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.572em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.999em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3331"><span class="mi" id="MathJax-Span-3332" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-3333" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3334"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3335" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3336" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3337" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-3338" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3339" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3340" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3341" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3342" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-3343" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">g</span><span class="mo" id="MathJax-Span-3344" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-3345"><span class="mrow" id="MathJax-Span-3346"><span class="mo" id="MathJax-Span-3347" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-3348"><span class="mrow" id="MathJax-Span-3349"><span class="mo" id="MathJax-Span-3350" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3351"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3352" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3353" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3354" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-3355" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3356" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3357" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3358"><span class="mrow" id="MathJax-Span-3359"><span class="mo" id="MathJax-Span-3360" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3361"><span style="display: inline-block; position: relative; width: 0.694em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-3362"><span class="mrow" id="MathJax-Span-3363"><span class="mo" id="MathJax-Span-3364" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.225em;"><span class="mn" id="MathJax-Span-3365" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3366" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.207em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-286">f(z_i,z_j) = g(||z_i-z_j||_2)</script></li>
</ul>
</li>
</ul>
<h3>Which Approaches to use</h3>
<p>Node2vec performs better on node calssification whiel multi-hop methods perform better on link prediction.<br>
Random walk approaches are gnerally more efficient.</p>
<h3>What if we wanted to embed entire graphs?</h3>
<p>You can use this to go graph anomay detection, classifying social networks, analyze reddit comment threads, represent molecules as graphs and identify carcinogenic networks etc.<br>
Two approaches to full graph-embedding:</p>
<ol>
<li>Simple idea: The embedding of the graph is simply the sum of the embeddings of the nodes.</li>
<li>Introduce a 'virtual node' which is connected to all the nodes in the graoh to represent the (sub) graph and run a standard graph embedding technique.</li>
</ol>
<h3>Other Random walk ideas:</h3>
<ul>
<li>Different kinds of biased random walks
<ul>
<li>Based on node attributes (Done et al 2017), based on learned weights (Abu-El-Hajia et al 2017)</li>
</ul>
</li>
<li>Alternative optimization schemes
<ul>
<li>Directly optimized based on 1-hop and 2-hop random walk probabilites (LINE)</li>
</ul>
</li>
<li>Network preprocessing techniques
<ul>
<li>Run random walks on modified versions of the original network. (Struct2vec, HARP)</li>
</ul>
</li>
</ul>
<h2>Appendix:</h2>
<h3>Appendix 1: Why random walks?</h3>
<ol>
<li>Expressivity: Flexible stochastic definiton of node similarity that incorporates both local and higher-order neighborhood information</li>
<li>Efficiency: Do not need to consider all node paits when training, only need to consider nodes that co-occur on ranodm walks.</li>
</ol>
<h4>Intuition Between Random Walks:</h4>
<p>Find embedding of nodes to d-dimensional space so that node similarity is preserved.<br>
Idea: Learn node embedding such that nearby nodes are close together in the network. Given a node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script>, how do we define nearby nodes? Define a node <strong>neighborhood</strong>: <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> is the neighborhood of <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script> defined by some strategy <span class="MathJax" id="MathJax-Element-287-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3367" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3368"><span class="mi" id="MathJax-Span-3369" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-287">R</script>.</p>
<h4>Feature Learning as Optimization:</h4>
<p>Given <span class="MathJax" id="MathJax-Element-288-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3370" style="width: 3.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.209em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.455em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3371"><span class="mi" id="MathJax-Span-3372" style="font-family: STIXGeneral-Italic;">G</span><span class="mo" id="MathJax-Span-3373" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3374" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-3375" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-3376" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-3377" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-288">G(V,E)</script>, our goal is to learn a mapping <span class="MathJax" id="MathJax-Element-289-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3378" style="width: 5.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.673em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.493em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3379"><span class="mi" id="MathJax-Span-3380" style="font-family: STIXGeneral-Italic;">z</span><span class="mo" id="MathJax-Span-3381" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:</span><span class="mi" id="MathJax-Span-3382" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">u</span><span class="mo" id="MathJax-Span-3383" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-3384" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-3385"><span class="mrow" id="MathJax-Span-3386"><span class="mi" id="MathJax-Span-3387" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.698em; left: 0.788em;"><span class="mi" id="MathJax-Span-3388" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.183em; vertical-align: -0.152em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-289">z: u \rightarrow \mathbb{R}^d</script> to minimize the log-likelihood objective:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-290-Frame" style=""><nobr><span class="math" id="MathJax-Span-3389" style="width: 11.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.304em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 3.972em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3390"><span class="mi" id="MathJax-Span-3391" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-3392" style="font-family: STIXGeneral-Italic;">a</span><span class="msubsup" id="MathJax-Span-3393"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3394" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-3395" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3396" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.028em;"><span class="mo" id="MathJax-Span-3397" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.597em, -0.477em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-3398"><span class="mrow" id="MathJax-Span-3399"><span class="mi" id="MathJax-Span-3400" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3401" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-3402" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3403" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-3404"><span class="mi" id="MathJax-Span-3405" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-3406"></span><span class="mi" id="MathJax-Span-3407" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-3408" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3409"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3410" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-3411" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3412" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3413" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3414" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-3415"><span class="mrow" id="MathJax-Span-3416"><span class="mo" id="MathJax-Span-3417" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3418"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3419" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3420" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3421" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.616em; vertical-align: -1.471em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-290">max_z \sum_{u \in V} {\log P(N_R(u) | z_u)}</script> where <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> is the neighborhood of node u.<br>
Given node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script>, we want to learn feature representations predictive of nodes in its neighborhood <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script>, under the assumption that condition likelihood factorizes over the set of neighbors:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-291-Frame" style=""><nobr><span class="math" id="MathJax-Span-3422" style="width: 17.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.822em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 4.078em, -0.466em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3423"><span class="mi" id="MathJax-Span-3424" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-3425" style="font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-3426" style="font-family: STIXGeneral-Italic;">g</span><span class="mo" id="MathJax-Span-3427" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3428" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-3429" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3430"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3431" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-3432" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3433" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3434" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3435" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-3436"><span class="mrow" id="MathJax-Span-3437"><span class="mo" id="MathJax-Span-3438" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3439"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3440" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3441" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3442" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3443" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-3444" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.534em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.591em;"><span class="mo" id="MathJax-Span-3445" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.703em, -0.493em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-3446"><span class="mrow" id="MathJax-Span-3447"><span class="mi" id="MathJax-Span-3448" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-3449" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-3450"><span style="display: inline-block; position: relative; width: 0.799em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.488em, -0.521em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3451" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.521em;"><span class="mi" id="MathJax-Span-3452" style="font-size: 50%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-3453" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3454" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3455" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3456" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3457"></span><span class="mo" id="MathJax-Span-3458" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3459" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-3460" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3461"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3462" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3463" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3464"><span class="mrow" id="MathJax-Span-3465"><span class="mo" id="MathJax-Span-3466" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3467"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3468" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3469" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3470" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3471" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.734em; vertical-align: -1.589em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-291">log(P(N_R(u)|z_u) = \sum_{v \in N_s (u)} \log(P(z_v | z_u))</script><p></p>
<h2>Notes:</h2>
<p>(1)</p>
</div><div class="cell text-cell"><img src="resources/DF288A68EAAD6CC14D6BAC1B47F06ED9.png" alt="Screenshot 2019-10-29 at 7.35.41 PM.png" width="556" height="313"><div></div><div></div></div><div class="cell markdown-cell"><p>(2) <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> can have repeat elements since nodes can be visited multipe times on random walks.</p>
</div><div class="cell markdown-cell"><p>(3) Softmax works because the sum of the exponents <span class="MathJax" id="MathJax-Element-292-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3472" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.678em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3473"><span class="mo" id="MathJax-Span-3474" style="font-family: STIXGeneral-Regular;">≈</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.624em; vertical-align: -0.035em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-292">\approx</script> the maximum of the exponents, the big guy eats up all the others.</p>
<p>(4) Note that this is a random sample over all nodes, not just nodes in the neighborhood.</p>
<p>(5)<br>
So in actuality, in step 3. above, we optimize embeddings using Stochastic Gradient Descent according to</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-293-Frame" style=""><nobr><span class="math" id="MathJax-Span-3475" style="width: 13.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.444em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 4.078em, -0.474em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3476"><span class="texatom" id="MathJax-Span-3477"><span class="mrow" id="MathJax-Span-3478"><span class="mi" id="MathJax-Span-3479" style="font-family: STIXGeneral-Italic;">ℒ</span></span></span><span class="mo" id="MathJax-Span-3480" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-3481" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.028em;"><span class="mo" id="MathJax-Span-3482" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.597em, -0.477em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-3483"><span class="mrow" id="MathJax-Span-3484"><span class="mi" id="MathJax-Span-3485" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3486" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-3487" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3488" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.646em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.648em;"><span class="mo" id="MathJax-Span-3489" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.703em, -0.493em); top: -1.159em; left: 0em;"><span class="texatom" id="MathJax-Span-3490"><span class="mrow" id="MathJax-Span-3491"><span class="mi" id="MathJax-Span-3492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-3493" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="msubsup" id="MathJax-Span-3494"><span style="display: inline-block; position: relative; width: 0.912em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.488em, -0.521em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3495" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.521em;"><span class="mi" id="MathJax-Span-3496" style="font-size: 50%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-3497" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3498" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-3499" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3500" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-3501"><span class="mo" id="MathJax-Span-3502" style="font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-3503" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3504"></span><span class="mo" id="MathJax-Span-3505" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3506" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-3507" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3508" style="font-family: STIXGeneral-Italic;">v</span><span class="texatom" id="MathJax-Span-3509"><span class="mrow" id="MathJax-Span-3510"><span class="mo" id="MathJax-Span-3511" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3512"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3513" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3514" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3515" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3516" style="font-family: STIXGeneral-Regular;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.734em; vertical-align: -1.589em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-293">\mathscr{L} = \sum_{u \in V} \sum_{v \in N_R(u)} {-\log( P(v|z_u))} </script><br>
with <span class="MathJax" id="MathJax-Element-294-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3517" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3518"><span class="mi" id="MathJax-Span-3519" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-3520" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3521" style="font-family: STIXGeneral-Italic;">v</span><span class="texatom" id="MathJax-Span-3522"><span class="mrow" id="MathJax-Span-3523"><span class="mo" id="MathJax-Span-3524" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3525"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.784em, -0.509em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3526" style="font-family: STIXGeneral-Italic;">z</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3527" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3528" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-294">P(v|z_u)</script> defined according to the softmax and efficiently appromated using negatie sampling. (4)<p></p>
<p>(6) This is very analogous to work2vec. In work2vec, we have a sliding window over words and we try to predict what words are near to a particular one to form the embedding. In Node2Vec, we have a random walk over nodes and we try to predict what nodes are close to a particular one to form the embedding.</p>
<p>Specifically, node2vec is, we take a graph, we get a random walk over the graph, that gives us a sequence of nodes which is like a 'sentence', and then we run 'word2vec' on that sequence to determine what nodes should be in the neighborhood of a particular node.</p>
<p>Similarly to word2vec, each node can have 2 embeddings, a separate embedding for whether they are in the center of the set or in the context of the set.</p>
<p>(7) Key observation: Flexible notion of network neighborhood <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> of node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script> leads to rich node embeddings. Use flexible, biased random walks that can trade off between local and global views of the network.<br>
Using the 1st order labeled random walk, develop biased 2nd order random walk R to generate netwokr neighborhood <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2902" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="msubsup" id="MathJax-Span-2904"><span style="display: inline-block; position: relative; width: 1.254em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.718em, -0.527em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2905" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.728em;"><span class="mi" id="MathJax-Span-2906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2907" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2908" style="font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-2909" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">N_R(u)</script> of node <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2899" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.465em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2900"><span class="mi" id="MathJax-Span-2901" style="font-family: STIXGeneral-Italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">u</script>.</p>
</div><div class="cell text-cell"><p>(8)<img src="resources/FDF7E352C0E69C13027837CD8899416B.png" alt="Screenshot 2019-10-29 at 9.28.41 PM.png" width="525" height="316"></p><p>In the micro view (BFS, medium p high q), the yellow nodes are the fringe nodes, the blue nodes are connectors between the local nodes and the center nodes, and the blue nodes are the center nodes. In the micro view, you never have a view of the whole network, just what a node looks like in the context of its surroundings, so you get nodes with similar functions (similar types of connectedness) embedded to similar coordinates.</p><p>In the macro view (DFS, medium p low q), the nodes are similar to each other based on how similar they are in the context of the whole graph. So you see clusters of nodes (communities) embedded similarly in the graph.</p>
</div><div class="cell markdown-cell"></div><div class="cell text-cell"><div><br></div></div><div class="cell markdown-cell"></div></div>
   
    </body>
    </html>
  