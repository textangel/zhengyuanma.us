
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>Lecture 5 - Clustering</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><h1>Lecture 5 - Clustering</h1>
<p>The curse of dimensionality - in large dimensional spaces, almost all points are far away from each other, and almost any two vectors are almost orthogonal.</p>
<h2>K-means</h2>
<p>The Basic Algorithm for Clustering is K-means.<br>
K-means is Expectation Maximization (EM) applied to a Naive Bayes Model.</p>
<ul>
<li>E step - Assign to each data point the centroid it is closest to</li>
<li>M step - Update the new centroids as the mean of all the points assigned to it.<br>
<span class="MathJax" id="MathJax-Element-72-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-724" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-725"><span class="mi" id="MathJax-Span-726" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.895em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">k</script> centroids are initialized randomly (actually there is a lot of sensitivity to initizalition in terms of performance since we only find a local optimum).<br>
nai</li>
</ul>
<pre><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>def kmeans(dataSet, k):
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    numFeatures = dataSet.getNumFeatures()
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    centroids = getRandomCentroids(numFeatures, k)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    iterations = 0
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    oldCentroids = None
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    while not shouldStop(oldCentroids, centroids, iterations):
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    oldCentroids = centroids
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    iterations += 1
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    labels = getLabels(dataSet, centroids)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    centroids = getCentroids(dataSet, labels, k)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    return centroids
</div></div></div></pre>
<h2>BFR Algorithm</h2>
<p>K means for data that doesn’t fit in memory<br>
Assumes that clusters are normally distributed around a centroid in Euclidean space. Standard deviations in different dimensions may vary. Clusters are axis-aligned ellipses.</p>
<p>Goal is to find cluster centroids, point assignment done in second pass<br>
Want memory required <code>O(clusters)</code> not <code>O(data)</code><br>
Idea: rather than keeping data points, BFR keeps summary statistics of groups of points</p>
<p>Generates clusters dynamically as we discover more data.</p>
</div><div class="cell markdown-cell"><p><img src="resources/E9196E92198F470C1D7C03CF242D6C95.png" alt="Screen Shot 2020-08-31 at 7.29.50 PM.png" width="500"></p>
</div><div class="cell markdown-cell"><h2>BFR Algo</h2>
<ol>
<li>Initalize K clusters/ centroids</li>
<li>Load in a bag points from disk</li>
<li>Assign new points to one of the K original clusters, if they are within some distance threshold of the cluster (see ‘Details’ below)
<ul>
<li>incorporate those points to the cluster’s summary statistics and then add them to the discard set</li>
</ul>
</li>
<li>Cluster the remaining points, and create new clusters
<ul>
<li>Use any in-memory clustering algorithm to cluster the remaining points and the old retained set (RS). Clusters go to Compression Set (CS), outlying points go to RS.</li>
</ul>
</li>
<li>Try to merge new clusters from step 4 with any of the existing clusters
<ul>
<li>Adjust the statistics of the clusters to account for the new points.
<ul>
<li>Add the count to n, add vector sum to the SUM, add sum of squares to SUMSQ</li>
</ul>
</li>
<li>Also consider merging compressed sets in the compression set at this stage.</li>
</ul>
</li>
<li>Repeat steps 2-5 until all points are eliminated.
<ul>
<li>If this is the last round, merge all compressed sets in teh CS and all RS points to their nearest cluster.</li>
</ul>
</li>
</ol>
<p>Points are read from disk one main-memory-full-batch at a time<br>
Most points from previous memory loads are summarised by sample statistics<br>
Step 1) From the initial load we select the initial k centroids by some sensible approach</p>
<p><strong>Possible Initializaitons</strong></p>
<ul>
<li>Take k random points</li>
<li>Take a small random sample and cluster optimally</li>
<li>Take a sample, pick a random point, and then k-1 more points, each as far from the previously selected points as possible.</li>
</ul>
<p>3 sets of summary statistics we keep track of (1)</p>
<ul>
<li>Discard Set (DS) - Already clustered
<ul>
<li>Points close enough to a current centroid to be summarised</li>
</ul>
</li>
<li>Compression Set (CS) - Summarised but not assigned to cluster
<ul>
<li>Groups of points that are close together but not close to any existing centroid.</li>
<li>These points are summarised, but not assigned to a cluster</li>
</ul>
</li>
<li>Retained Set( RS) - Outlier points waiting for assignment
<ul>
<li>Isolated points waiting to be assigned to a compression set.</li>
</ul>
</li>
</ul>
<p>For each cluster, the discard set is summarised by the <code>2d+1</code> points (n, SUM, SUMSQ), where <code>d</code> is the number of dimensions and</p>
<ul>
<li>n is the number of points, a scalar</li>
<li>SUM is the vector sum, element wise, a vector</li>
<li>SUMSQ is the sum of squares element wise, a vector</li>
</ul>
<p>Then, the average in each dimension (the centroid) is <code>SUM/n</code> and variance of a clusters discard set in dimension <code>i</code> is :<br>
<span class="MathJax" id="MathJax-Element-73-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-727" style="width: 7.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.926em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.161em, 1000em, 3.054em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-728"><span class="mfrac" id="MathJax-Span-729"><span style="display: inline-block; position: relative; width: 2.823em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.668em, 1000em, 2.637em, -0.495em); top: -2.883em; left: 50%; margin-left: -1.351em;"><span class="mrow" id="MathJax-Span-730"><span class="mi" id="MathJax-Span-731" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mi" id="MathJax-Span-732" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.03em;"></span></span><span class="mi" id="MathJax-Span-733" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-734" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="msubsup" id="MathJax-Span-735"><span style="display: inline-block; position: relative; width: 0.785em; height: 0px;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.606em, -0.465em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-736" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.042em; left: 0.563em;"><span class="mi" id="MathJax-Span-737" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.484em, -0.497em); top: -1.964em; left: 50%; margin-left: -0.197em;"><span class="mi" id="MathJax-Span-738" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.823em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-739" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-740" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 2.631em; height: 0px;"><span style="position: absolute; clip: rect(2.83em, 1000em, 4.518em, -0.507em); top: -3.998em; left: 0em;"><span class="mfrac" id="MathJax-Span-741"><span style="display: inline-block; position: relative; width: 1.922em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.668em, 1000em, 2.589em, -0.495em); top: -2.836em; left: 50%; margin-left: -0.901em;"><span class="mrow" id="MathJax-Span-742"><span class="mi" id="MathJax-Span-743" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mi" id="MathJax-Span-744" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.03em;"></span></span><span class="msubsup" id="MathJax-Span-745"><span style="display: inline-block; position: relative; width: 0.87em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.519em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-746" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.648em;"><span class="mi" id="MathJax-Span-747" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.484em, -0.497em); top: -1.964em; left: 50%; margin-left: -0.197em;"><span class="mi" id="MathJax-Span-748" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.922em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.034em; left: 2.162em;"><span class="mn" id="MathJax-Span-749" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.851em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">\frac{SUMSQ_i}{n} - \frac{SUM_i}{n}^2</script>. The cluster is defined with these two statistics.</p>
</div><div class="cell markdown-cell"><p><img src="resources/C7A6F7E7603AEA84042CDABE1968834F.png" alt="Screen Shot 2020-08-31 at 7.29.58 PM.png" width="500"></p>
</div><div class="cell markdown-cell"><h3><strong>Details:</strong></h3>
<p>Distance thresholds:</p>
<ul>
<li><strong>Mahalanobis distance:</strong> The normalised Euclidean distance from centroid. Given point <span class="MathJax" id="MathJax-Element-74-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-750" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-751"><span class="mi" id="MathJax-Span-752" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">x</script>, centroid <span class="MathJax" id="MathJax-Element-75-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-753" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-754"><span class="mi" id="MathJax-Span-755" style="font-family: STIXGeneral-Italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">c</script>:
<ul>
<li><span class="MathJax" id="MathJax-Element-76-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-756" style="width: 15.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.57em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.087em, 1000em, 3.286em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-757"><span class="mi" id="MathJax-Span-758" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mo" id="MathJax-Span-759" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-760" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-761" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-762" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">c</span><span class="mo" id="MathJax-Span-763" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-764" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msqrt" id="MathJax-Span-765" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 9.653em; height: 0px;"><span style="position: absolute; clip: rect(1.394em, 1000em, 3.007em, -0.449em); top: -2.534em; left: 1.07em;"><span class="mrow" id="MathJax-Span-766"><span class="munderover" id="MathJax-Span-767"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-768" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.487em, -0.496em); top: -2.797em; left: 0.957em;"><span class="mi" id="MathJax-Span-769" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.485em, -0.472em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mi" id="MathJax-Span-772" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-773" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-774" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-775" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-776" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-777" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-778"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-779" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-780" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-781" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-782" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-783" style="font-family: STIXGeneral-Italic;">c</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-785" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-786"><span class="mrow" id="MathJax-Span-787"><span class="mo" id="MathJax-Span-788" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="msubsup" id="MathJax-Span-789"><span style="display: inline-block; position: relative; width: 0.83em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-790" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.53em;"><span class="mi" id="MathJax-Span-791" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-792"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.859em, -0.473em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-793" style="font-family: STIXGeneral-Regular;">]</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.698em; left: 0.338em;"><span class="mn" id="MathJax-Span-794" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-795" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.009em, 1000em, 3.397em, -0.507em); top: -4.456em; left: 1.07em;"><span style="display: inline-block; position: relative; width: 8.584em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 8.084em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.425em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.876em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.326em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.777em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.227em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.678em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 3.128em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 3.579em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 4.029em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 4.48em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 4.93em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 5.381em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 5.831em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 6.282em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 6.732em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 7.183em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 7.633em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.277em, 1000em, 4.462em, -0.395em); top: -3.71em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.191em; vertical-align: -0.71em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">d(x,c) = \sqrt{\sum_{i=1}^d (   [(x_i - c_i)/\sigma_i]^2   )}</script>, where <span class="MathJax" id="MathJax-Element-77-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-796" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.48em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="msubsup" id="MathJax-Span-798"><span style="display: inline-block; position: relative; width: 0.83em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-799" style="font-family: STIXGeneral-Italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.033em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.53em;"><span class="mi" id="MathJax-Span-800" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">\sigma_i</script> is the standard deviation of points in the cluster in the <code>i</code>th dimension.</li>
<li>It measures distances in different coordinates at different resolutions. It normalises each dimension by the stddev.</li>
<li>If clusters are normally distributed in <code>d</code> dimensions, then after one transformation, one stddev = <span class="MathJax" id="MathJax-Element-78-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-801" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.196em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.483em, 1000em, 3.062em, -0.395em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-802"><span class="msqrt" id="MathJax-Span-803"><span style="display: inline-block; position: relative; width: 1.295em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0.957em;"><span class="mrow" id="MathJax-Span-804"><span class="mo" id="MathJax-Span-805" style="font-family: STIXGeneral-Regular;">(</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.901em, 1000em, 1.309em, -0.507em); top: -1.952em; left: 0.957em;"><span style="border-left-width: 0.338em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: -0.07em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span><span style="position: absolute; clip: rect(2.856em, 1000em, 4.426em, -0.395em); top: -3.897em; left: 0em;"><span style="font-family: STIXGeneral-Regular;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-806" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mo" id="MathJax-Span-807" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.461em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">\sqrt(d)</script>, that is, 68% of the points of the cluster will have a Mahalanobis distance <span class="MathJax" id="MathJax-Element-79-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-808" style="width: 3.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.209em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.483em, 1000em, 3.062em, -0.451em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-809"><span class="mo" id="MathJax-Span-810" style="font-family: STIXGeneral-Regular;">&lt;</span><span class="msqrt" id="MathJax-Span-811" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.295em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0.957em;"><span class="mrow" id="MathJax-Span-812"><span class="mo" id="MathJax-Span-813" style="font-family: STIXGeneral-Regular;">(</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.901em, 1000em, 1.309em, -0.507em); top: -1.952em; left: 0.957em;"><span style="border-left-width: 0.338em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: -0.07em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span><span style="position: absolute; clip: rect(2.856em, 1000em, 4.426em, -0.395em); top: -3.897em; left: 0em;"><span style="font-family: STIXGeneral-Regular;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-814" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mo" id="MathJax-Span-815" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.503em; vertical-align: -0.461em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">< \sqrt(d)</script>.</li>
<li>Accept a point for a cluster if its Mahalanobis distance for the point and the cluster is &lt; some threshold, for example, 2 stddev.<br>
When should 2 Compression Set (CS) clusters be combined?</li>
</ul>
</li>
<li>Compute the variance of the combined subcluster by adding the two (n, SUM, SUMSQ), combine two clusters if the combined variance is below some threshold.</li>
</ul>
<p>(1)<br>
There is a distance threshold that is used to assign points to one of the k original clusters.<br>
Compression set- not attached to the cluster<br>
Retained set - leftover points</p>
<h2>CURE Algorithm (Clustering Using Representatives)</h2>
<h3>Motivations:</h3>
<p>Problem with BFR/k-means: Assumes clusters are normally distributed in each dimension, and axes are fixed - ellipses at an angle are NOT ok. CURE algorithm</p>
<ul>
<li>Assumes a Euclidean distance, allows clusters to assume any shape.</li>
<li>CURE uses a collection of representative points to represent clusters.</li>
</ul>
</div><div class="cell markdown-cell"><p><img src="resources/C806F8D4FF7AD08854A6272A90619708.png" alt="Screen Shot 2020-08-31 at 7.30.36 PM.png" width="500"></p>
</div><div class="cell markdown-cell"><h4>CURE Algorithm: 2 Passes:</h4>
<p>(See Appendix 2 for pictures)<br>
<strong>Pass 1:</strong> Getting Representative Points<br>
0.  Pick a random sample of points that fit into main memory.</p>
<ol>
<li>Initial Clusters by in-memory hierarchical clustering (group nearest points/clusters.)</li>
<li>Pick representative points:
<ul>
<li>For each cluster, pick a sample of points as dispersed as possible.</li>
<li>From the sample, pick representatives by moving the points farthest away from each other (say) 20% towards the centroid of the cluster. The moved points are the representatives.</li>
</ul>
</li>
</ol>
<p><strong>Pass 2:</strong> Assigning Points</p>
<ol>
<li>Rescan the whole dataset and place each point <code>p</code> in the “closest cluster”
<ul>
<li>Closest is the closest representative point to <code>p</code>, <code>p</code> gets assigned to the representative’s cluster.</li>
</ul>
</li>
</ol>
<p>Intuition: A large, dispersed cluster will have large moves from its boundary, while a small dense cluster will have little move. So this also favours a small dense cluster over a nearby large dispersed cluster.</p>
</div><div class="cell markdown-cell"><p><img src="resources/40DF103178376A0F5BEBFE34E44067D9.png" alt="Screen Shot 2020-08-31 at 7.31.03 PM.png" width="500"></p>
</div><div class="cell markdown-cell"><h2>Appendices</h2>
<h3>Apendix 1: Mahalanobis Distance</h3>
</div><div class="cell markdown-cell"><p><img src="resources/0348238400DCD9BE6516945AB11C7540.png" alt="Screen Shot 2020-08-31 at 7.30.20 PM.png" width="500"></p>
<h2>Appendices</h2>
<h3>Apendix 1: More on CURE</h3>
</div><div class="cell markdown-cell"><p><img src="resources/58AB5A7549BFF69DFD1AB99DB89B9ACB.png" alt="Screen Shot 2020-08-31 at 7.31.25 PM.png" width="500"></p>
<p><img src="resources/3CDA106B47F2E045DA193E8A30E78091.png" alt="Screen Shot 2020-08-31 at 7.31.28 PM.png" width="500"><br>
<img src="resources/9691C46B2253FF6892AD0DA8EAE58108.png" alt="Screen Shot 2020-08-31 at 7.31.32 PM.png" width="500"></p>
<p><img src="resources/EBA6745140FEAD53C300E9429C5B183C.png" alt="Screen Shot 2020-08-31 at 7.31.42 PM.png" width="500"></p>
</div></div>
    
    </body>
    </html>
  