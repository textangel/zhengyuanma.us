
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS234 - Lecture 5 - Linear Value Function Approximation</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p>Today we estimate the Value and Q function as a function with parameters <span class="MathJax" id="MathJax-Element-533-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14189" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14190"><span class="mi" id="MathJax-Span-14191" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-533">w</script>: <span class="MathJax" id="MathJax-Element-534-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14192" style="width: 16.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.203em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.391em, 1000em, 2.885em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14193"><span class="mo" id="MathJax-Span-14194" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14195" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-14196" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14197" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14198" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14199" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-14200" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Q</span><span class="mo" id="MathJax-Span-14201" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14202" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14203" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-14204" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-14205" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14206" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14207" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="mo" id="MathJax-Span-14208" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="texatom" id="MathJax-Span-14209"><span class="mrow" id="MathJax-Span-14210"><span class="munderover" id="MathJax-Span-14211"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14212" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14213" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14214" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14215" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14216" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14217" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14218" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14219" style="font-family: STIXGeneral-Regular;">,</span><span class="texatom" id="MathJax-Span-14220" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-14221"><span class="munderover" id="MathJax-Span-14222"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14223" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14224" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14225" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14226" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14227" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-14228" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-14229" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14230" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14231" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14232" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.408em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-534">(V(s),Q(s,a)) \rightarrow (\hat V(s;w), \hat Q(s,a;w))</script>. This helps us reduce memory, computation, and experience needed to find V,Q, <span class="MathJax" id="MathJax-Element-535-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14233" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14234"><span class="mi" id="MathJax-Span-14235" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-535">\pi</script>. See slides for intro.</p>
<p>Linear Value Function Approximation (Appendix 1): If <span class="MathJax" id="MathJax-Element-536-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14236" style="width: 6.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.912em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.534em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14237"><span class="msubsup" id="MathJax-Span-14238"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14239" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mn" id="MathJax-Span-14240" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14241" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14242" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14243" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14244" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-14245" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14246" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mn" id="MathJax-Span-14247" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14248" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14249" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14250" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14251" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-14252" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">⋯</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-536">x_1(s), x_2(s), \cdots</script> are feature vectors computed over <span class="MathJax" id="MathJax-Element-537-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14253" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14254"><span class="mi" id="MathJax-Span-14255" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-537">s</script>, approximate the value function with:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-538-Frame" style=""><nobr><span class="math" id="MathJax-Span-14256" style="width: 14.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.782em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.753em, 1000em, 4.099em, -0.607em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14257"><span class="texatom" id="MathJax-Span-14258"><span class="mrow" id="MathJax-Span-14259"><span class="munderover" id="MathJax-Span-14260"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14261" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14262" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14263" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14264" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14265" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14266" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14267" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14268" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-14269" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-14270" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.724em, -0.594em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-14271"><span class="mrow" id="MathJax-Span-14272"><span class="mi" id="MathJax-Span-14273" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-14274" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-14275" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.497em); top: -3.509em; left: 0.479em;"><span class="mi" id="MathJax-Span-14276" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-14277" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14278" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-14279" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14280" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14281" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-14282" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-14283"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14284" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-14285" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14286" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-14287" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-14288" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14289" style="font-family: STIXGeneral-Italic;">s</span><span class="msubsup" id="MathJax-Span-14290"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-14291" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.338em;"><span class="mi" id="MathJax-Span-14292" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-14293" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.464em; vertical-align: -1.612em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-538">\hat V(s;w) = \sum_{j=1}^n x_j(s)w_j = x(s)^T w</script><p></p>
<h2>Relation to Previous Material</h2>
<p>The updates are still exactly the same as in previous lectues, only instaed of updating the value (V) function or the state-action value (Q) function, we update the weights <span class="MathJax" id="MathJax-Element-533-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14189" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14190"><span class="mi" id="MathJax-Span-14191" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-533">w</script> instead. This requires us to multiply the update step by a gradient.</p>
<p>The update rule is now<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-539-Frame" style=""><nobr><span class="math" id="MathJax-Span-14294" style="width: 31.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.928em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.439em, 1000em, 3.453em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-14295"><span class="mtable" id="MathJax-Span-14296" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 27.588em; height: 0px;"><span style="position: absolute; clip: rect(3.201em, 1000em, 5.037em, -0.507em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -4.625em; right: 0em;"><span class="mtd" id="MathJax-Span-14297"><span class="mrow" id="MathJax-Span-14298"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.127em; right: 0em;"><span class="mtd" id="MathJax-Span-14343"><span class="mrow" id="MathJax-Span-14344"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.24em, 1000em, 5.243em, -0.459em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 20.045em; height: 0px;"><span style="position: absolute; clip: rect(1.404em, 1000em, 2.88em, -0.459em); top: -3.162em; left: 0em;"><span class="mtd" id="MathJax-Span-14299"><span class="mrow" id="MathJax-Span-14300"><span class="mi" id="MathJax-Span-14301" style="font-family: STIXGeneral-Regular;">Δ</span><span class="mi" id="MathJax-Span-14302" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-14303" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-14304" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">α</span><span class="mo" id="MathJax-Span-14305" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14306"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14307" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-14308" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14309" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="texatom" id="MathJax-Span-14310" style="padding-left: 0.25em;"><span class="mrow" id="MathJax-Span-14311"><span class="munderover" id="MathJax-Span-14312"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14313" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14314" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14315" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14316"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14317" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14318" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14319" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14320" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14321" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14322" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-14323"><span style="display: inline-block; position: relative; width: 1.37em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14324" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-14325" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-14326"><span class="mrow" id="MathJax-Span-14327"><span class="munderover" id="MathJax-Span-14328"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14329" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14330" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14331" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14332"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14333" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14334" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14335" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14336" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14337" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-14338" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-14339" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.404em, 1000em, 2.909em, -0.459em); top: -1.663em; left: 0em;"><span class="mtd" id="MathJax-Span-14345"><span class="mrow" id="MathJax-Span-14346"><span class="mi" id="MathJax-Span-14347" style="font-family: STIXGeneral-Regular;">Δ</span><span class="mi" id="MathJax-Span-14348" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-14349" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-14350" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">α</span><span class="mo" id="MathJax-Span-14351" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14352" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-14353" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-14354" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="texatom" id="MathJax-Span-14355"><span class="mrow" id="MathJax-Span-14356"><span class="munderover" id="MathJax-Span-14357"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14358" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14359" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14360" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14361"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14362" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-14363"><span class="mrow" id="MathJax-Span-14364"><span class="mi" id="MathJax-Span-14365" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-14366" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-14367" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14368" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14369" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14370" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14371" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="texatom" id="MathJax-Span-14372" style="padding-left: 0.25em;"><span class="mrow" id="MathJax-Span-14373"><span class="munderover" id="MathJax-Span-14374"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14375" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14376" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14377" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14378"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14379" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14380" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14381" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14382" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14383" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-14384" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-14385"><span style="display: inline-block; position: relative; width: 1.37em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14386" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-14387" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-14388"><span class="mrow" id="MathJax-Span-14389"><span class="munderover" id="MathJax-Span-14390"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14391" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14392" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14393" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14394"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14395" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14396" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14397" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14398" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14399" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-14400" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-14401" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.518em, 1000em, 5.255em, -0.507em); top: -3.998em; left: 22.295em;"><span style="display: inline-block; position: relative; width: 5.293em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.717em, -0.507em); top: -3.162em; right: 0em;"><span class="mtd" id="MathJax-Span-14340"><span class="mrow" id="MathJax-Span-14341"><span class="mtext" id="MathJax-Span-14342" style="font-family: STIXGeneral-Regular;">Monte Carlo</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.507em); top: -1.663em; right: 0em;"><span class="mtd" id="MathJax-Span-14402"><span class="mrow" id="MathJax-Span-14403"><span class="mtext" id="MathJax-Span-14404" style="font-family: STIXGeneral-Regular;">TD Learning</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.097em; vertical-align: -1.271em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-539"> \begin{align} & \Delta w = \alpha (G_t - \hat V(s_t; w)) \nabla_w \hat V(s_t; w) \;\;  & \text{Monte Carlo} \\ & \Delta w = \alpha (r + \gamma \hat V(s_{t+1}; w) - \hat V(s_t; w)) \nabla_w \hat V(s_t; w) \;\;  & \text{TD Learning} \end{align} </script><br>
Note: Change <span class="MathJax" id="MathJax-Element-540-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14405" style="width: 3.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.322em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.404em, 1000em, 2.88em, -0.607em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14406"><span class="texatom" id="MathJax-Span-14407"><span class="mrow" id="MathJax-Span-14408"><span class="munderover" id="MathJax-Span-14409"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14410" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.286em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14411" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14412" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14413"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14414" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14415" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14416" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14417" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14418" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.388em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-540">\hat V(s_t; w)</script> to <span class="MathJax" id="MathJax-Element-541-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14419" style="width: 5.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.617em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.391em, 1000em, 2.885em, -0.682em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14420"><span class="texatom" id="MathJax-Span-14421"><span class="mrow" id="MathJax-Span-14422"><span class="munderover" id="MathJax-Span-14423"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14424" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14425" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14426" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14427"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14428" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14429" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14430" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-14431" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14432" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-14433" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14434" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14435" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14436" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.408em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-541">\hat Q(s_t, a_t; w)</script> to use Q-values, in particular, using Q-values for the TD-learning step is SARSA and adding a <span class="MathJax" id="MathJax-Element-542-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14437" style="width: 2.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.252em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.567em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-14438"><span class="munderover" id="MathJax-Span-14439"><span style="display: inline-block; position: relative; width: 2.215em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-14440" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="texatom" id="MathJax-Span-14441"><span class="mrow" id="MathJax-Span-14442"><span class="mi" id="MathJax-Span-14443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.811em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-542">\max_{a}</script> in front of the target <span class="MathJax" id="MathJax-Element-543-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-14444" style="width: 4.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.279em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.391em, 1000em, 2.885em, -0.682em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-14445"><span class="texatom" id="MathJax-Span-14446"><span class="mrow" id="MathJax-Span-14447"><span class="munderover" id="MathJax-Span-14448"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14449" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-14450" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-14451" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-14452"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-14453" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-14454" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-14455" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-14456" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-14457" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-14458" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">w</span><span class="mo" id="MathJax-Span-14459" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.408em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-543">\hat Q(s_t, a; w)</script> term is Q-learning.<p></p>
</div><div class="cell text-cell"><div>Appendix 1:</div><div><b>Linear Function Approximation for Value Functions (Intro)</b></div><div><img src="resources/C351CDAB97F91AF2E565526CA8219A83.png" alt="Screenshot 2020-03-30 at 1.06.15 PM.png" width="645" height="482"></div><div><br></div><div><b>Monte Carlo</b></div><div><img src="resources/48844EFB3E101A56D3051CF586AA559C.png" alt="Screenshot 2020-03-30 at 1.10.26 PM.png" width="635" height="478"><br></div><div><br></div><div><img src="resources/AB5B1FE5662A9033A29190EC069AF72B.png" alt="Screenshot 2020-03-30 at 1.10.45 PM.png" width="644" height="477"><br></div><div><br></div><div><b>Batch MC Value Function Approximation for Policy Evaluation</b><br></div><div>If you have all data and it is small enough, you can compute the optimal weight matrix directly and analytically.</div><div><img src="resources/BE8396447119DD9EB96119B117C7A1A4.png" alt="Screenshot 2020-03-30 at 1.29.42 PM.png" width="641" height="476"><b><br></b></div><div><br></div><div><br></div><div><div><b>TD Learning Function Approximation:</b><br></div><div>&nbsp;<img src="resources/1AB4D3657BC366AA5CF3B5D9A0347954.png" alt="Screenshot 2020-03-30 at 1.32.14 PM.png" width="639" height="478"><img src="resources/F8C1E31A8A1666E150CA603ADBA7A34E.png" alt="Screenshot 2020-03-30 at 1.32.54 PM.png" width="641" height="482">‘</div><div><img src="resources/9212C71713741D16CDB0D6B1A05D9E81.png" alt="Screenshot 2020-03-30 at 1.33.31 PM.png" width="642" height="473">‘'<br></div><div><img src="resources/9777D5D5E6006A65D48D828A72D20A7F.png" alt="Screenshot 2020-03-30 at 1.34.01 PM.png" width="644" height="476"></div></div><div><br></div><div><b>Appendix 1.3 Linear Function Approximation for Value Functions:&nbsp;Convergence Guarentees</b><img src="resources/3653B8885F154B6E3E4B4D669EF7386E.png" alt="Screenshot 2020-03-30 at 1.23.08 PM.png" width="650" height="488">’'</div><div><br></div><div>Def: <b>balance equation-</b>&nbsp;We look at all the all the actions we could take in the current state distribution (d(s’)), and we look at where we can transition to on the next state (p(s’|s,a)), and get the new state distribution in the next state, and they have to be identical.</div><div>The <b>stationary distribution</b> d(s) tells us in the long run what proprotion of the time you will spend in each of the states.</div><div><br></div><div><b>For Monte Carlo</b></div><div><img src="resources/470EA1C7908D32F5D9573CEE68FCF200.png" alt="Screenshot 2020-03-30 at 1.27.33 PM.png" width="488" height="363"><br></div><div><img src="resources/33BC5418DF8CD6D4B001DCABD7530899.png" alt="Screenshot 2020-03-30 at 1.39.19 PM.png" width="645" height="479"></div><div><div>We look at the mean squared error of our value function approximator with respect to the stationary distribution. (Intuition: We care more about states that we expect to visit a lot).&nbsp;<br></div><div>Then Monte Varlo Policy Evaluation with Linear Value Function Approximation converges to the weights with min MSE possible w.r.t the stationary distribution.</div></div><div>The TD learning oplicy evalutioan with linear function approimation converges to the weights with min MSE possible w.r.t the stationary distribution within a 1/(1-\gamma) boundary.&nbsp;</div><div>TD has a slightly higher error than MC becuase you are propagating back errors through bootstrapping.</div><div><br></div><div><div><b>Appendix 1.2 Eample: Baird 1995 Example for MC policy evaluation.&nbsp;</b></div><div><img src="resources/F604BB8073CE72B325C7DB0EBFD8953F.png" alt="Screenshot 2020-03-30 at 1.17.04 PM.png" width="483" height="359"><br></div><div>There are 7 states (s1,…,s7)</div><div>There are 7 features computed on the states (s1 = 2w1+w8, …, s6=2w6+w8, s7=w7+2w8) as in picture above.</div><div>Note that the feature space is larger than the state space which is totally okay.</div><div>There are two actions: a1 - deterministically go to s7, s2 - go to states s1,…,s6 with equal probability.</div><div>To make it nice there is a tiny change of termination every time you are in s7.</div><div><br></div><div>We start the weights as [11111111], and then we update the weights for every action in every episode.</div><div>MC &nbsp;updates the weights -3, while TD learning updates is -0.3. This is expected since TD learning makes smaller updates but makes them more frequently.</div><div><br></div><div><img src="resources/DB1E7016142242B2B684BAB108506656.png" alt="Screenshot 2020-03-30 at 1.35.56 PM.png" width="640" height="482"></div></div><div><br></div><div><br></div><div><b>Control Using Value Function Approximation</b></div><div>This is where things start to get unstable. Now we are doing function approcmation, bootstrapping, sampling, and off-policy learning, but the real source of the instability is the off-policy learning (becuase we change our control policy over time).</div><div>Once you start combining funciton approximation (value and Q estimates are not precise) and bootstrapping (errors propagate back) and off-policy learning (the control policy changes over time depending on what current estimates are), they can fail to converge to something good.</div><div><br></div><div>Now the features is x_j(s,a) cover both the states and the actions</div><div><br></div><div><br></div><div><img src="resources/71F073963CC4CE60ED31AB5D7FECD68C.png" alt="Screenshot 2020-03-30 at 1.48.42 PM.png" width="481" height="361"><br></div><div><br></div><div>Why this starts to pose convergence problems</div><div><img src="resources/588BA5E8BDF0968436F9280FE365EA45.png" alt="Screenshot 2020-03-30 at 1.50.03 PM.png" width="476" height="363"><br></div><div><br></div><div>Summary of convergence with V</div><div><img src="resources/1CBA1FDE2C1A527F88275310A2255427.png" alt="Screenshot 2020-03-30 at 1.51.32 PM.png" width="483" height="361"><br></div><div>However there are some alorithms with convergence guarentees</div><div><img src="resources/FB10D74EB90F8C6DE4947B3D77283A27.png" alt="Screenshot 2020-03-30 at 1.55.46 PM.png" width="477" height="361"><br></div><div><img src="resources/11EBD901A4FB17AD90508875D47F09B9.png" alt="Screenshot 2020-03-30 at 1.56.37 PM.png" width="653" height="481"><br></div><div><br></div><div><b>Summary</b></div><div><img src="resources/22A629A515E31F86295CAAC0F9D5C587.png" alt="Screenshot 2020-03-30 at 1.57.09 PM.png" width="637" height="478"><br></div><div><br></div><div><div><div><b>Appendix 1.5 Eample: Baird 1995 Example for Control</b></div><div><img src="resources/C5CB6CB8EF695EA750A5F83845BF5854.png" alt="Screenshot 2020-03-30 at 1.51.26 PM.png" width="481" height="362"><br></div></div><div>Suppose you were trying to evaluate the value of a policy a1.</div><div>Suppose we use the following approach: If you ever see data that is inconsistent with policy a1 (you took anaction in a1 but did not end up in a state specified by a1), ignore it. (This is known as a <b>behavorial policy</b>).</div><div>However, if you use TD learning on this, your weight can not converge (diverge). Main reason for this is that the distribution of data in your new dataset is not the same as the distribution of data under your desired policy.</div><div><br></div><div><br></div><div><br></div></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div></div></div>
    </body>
    </html>
  