
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS234 - Lecture 14 Monte Carlo Tree Search</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><div><b>Model Free and Model Based RL</b></div>Monte Carlo Tree Search Is Model-Based Reinforcement Learning. Deep RL has not been so successful in Model-Based RL so far, so Model-free approaches have dominated so far.<div><br><div>Model-Free RL:</div><div>&nbsp; - No Model</div><div>&nbsp; - <i>Learn</i> Value function (and/or policy) from experience</div><div>Model-Based RL</div><div>&nbsp; - Learn a model from experience (“simulator”).&nbsp;</div><div>&nbsp; - <i>Plan</i> value function (and/or policy) from model.</div><div>&nbsp; &nbsp; - Can also use the model to do DP updates, or simulate model-free RL, or do policy search. However, estimates may be bad if simulator is bad.</div><div>&nbsp; - Pros:</div><div>&nbsp; &nbsp; &nbsp; &nbsp; - Can effectively learn model by supervised learning models</div><div>&nbsp; &nbsp; &nbsp; &nbsp; - Can reason about model uncertainty (like in upper confidence bound methods for exploration/exploitation trade offs)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; - Very poweful for transfer learning</div><div>&nbsp; - Cons: First learn a model, then construct a value function - two sources of approximation error.&nbsp;</div><div></div></div></div><div class="cell markdown-cell"><h2>Def: MDP Model</h2>
<p>A model M is a representation of an MDP &lt;S,A,P,R&gt;, parameterized by <span class="MathJax" id="MathJax-Element-232-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6773" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6774"><span class="mi" id="MathJax-Span-6775" style="font-family: STIXGeneral-Italic;">η</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-232">\eta</script>. Assume the state space <span class="MathJax" id="MathJax-Element-233-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6776" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6777"><span class="mi" id="MathJax-Span-6778" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.885em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-233">S</script> and action space <span class="MathJax" id="MathJax-Element-234-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6779" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6780"><span class="mi" id="MathJax-Span-6781" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-234">A</script> is fixed and known. A model <span class="MathJax" id="MathJax-Element-235-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6782" style="width: 7.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.532em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.998em, -0.525em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6783"><span class="mi" id="MathJax-Span-6784" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mo" id="MathJax-Span-6785" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">&lt;</span></span><span class="msubsup" id="MathJax-Span-6786" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6787" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6788" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6789" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6790" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6791" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6792" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6793" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.177em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-235">M = <P_\eta, R_\eta></script> represents state transitions <span class="MathJax" id="MathJax-Element-236-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6794" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.998em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6795"><span class="msubsup" id="MathJax-Span-6796"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6797" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6798" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6799" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span><span class="mi" id="MathJax-Span-6800" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">P</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.177em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-236">P_\eta \approx P</script> and <span class="MathJax" id="MathJax-Element-237-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6801" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.998em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6802"><span class="msubsup" id="MathJax-Span-6803"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6804" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6805" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6806" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span><span class="mi" id="MathJax-Span-6807" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.177em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-237">R_\eta \approx R</script> s.t.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-238-Frame" style=""><nobr><span class="math" id="MathJax-Span-6808" style="width: 100%; display: inline-block; min-width: 10.141em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(3.153em, 1000em, 5.917em, -0.52em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-6809"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 4.462em, -0.49em); top: -3.998em; left: 50%; margin-left: -4.528em;"><span class="msubsup" id="MathJax-Span-6810"><span style="display: inline-block; position: relative; width: 1.756em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6811" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6812"><span class="mrow" id="MathJax-Span-6813"><span class="mi" id="MathJax-Span-6814" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6815" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6816" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6817" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="msubsup" id="MathJax-Span-6818" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6819" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6820" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6821" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6822"><span style="display: inline-block; position: relative; width: 1.756em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6823" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6824"><span class="mrow" id="MathJax-Span-6825"><span class="mi" id="MathJax-Span-6826" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6827" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6828" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6829"><span class="mrow" id="MathJax-Span-6830"><span class="mo" id="MathJax-Span-6831" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6832"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6833" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6834" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6835" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6836" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6837" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6838" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6839" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000em, 4.462em, -0.52em); top: -2.542em; left: 50%; margin-left: -4.56em;"><span class="mspace" id="MathJax-Span-6840" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-6841"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6842" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6843"><span class="mrow" id="MathJax-Span-6844"><span class="mi" id="MathJax-Span-6845" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6846" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6847" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6848" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-6849" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6850" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6851" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6852" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-6853"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6854" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6855"><span class="mrow" id="MathJax-Span-6856"><span class="mi" id="MathJax-Span-6857" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6858" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6859" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6860"><span class="mrow" id="MathJax-Span-6861"><span class="mo" id="MathJax-Span-6862" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6863"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6864" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-6865" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6866" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6867" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6868" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6869" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6870" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.818em; vertical-align: -2.005em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-238">S_{t+1} \sim P_\eta (S_{t+1}|A_t, A_t) \\ R_{t+1} = R_\eta (R_{t+1} | S_t, A_t)</script><br>
We typically assume conditional independence between state transitions and rewards<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-239-Frame" style=""><nobr><span class="math" id="MathJax-Span-6871" style="width: 22.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.27em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.882em, -0.437em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6872"><span class="texatom" id="MathJax-Span-6873"><span class="mrow" id="MathJax-Span-6874"><span class="mi" id="MathJax-Span-6875" style="font-family: STIXGeneral-Regular;">ℙ</span></span></span><span class="mo" id="MathJax-Span-6876" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-6877"><span style="display: inline-block; position: relative; width: 1.756em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6878" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6879"><span class="mrow" id="MathJax-Span-6880"><span class="mi" id="MathJax-Span-6881" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6882" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6883" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6884" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6885" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6886" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6887"><span class="mrow" id="MathJax-Span-6888"><span class="mi" id="MathJax-Span-6889" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6890" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6891" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6892"><span class="mrow" id="MathJax-Span-6893"><span class="mo" id="MathJax-Span-6894" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6895"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6896" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-6897" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6898" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6899" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6900" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6901" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6902" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-6903" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-6904" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-6905"><span class="mi" id="MathJax-Span-6906" style="font-family: STIXGeneral-Regular;">ℙ</span></span></span><span class="mo" id="MathJax-Span-6907" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-6908"><span style="display: inline-block; position: relative; width: 1.756em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6909" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-6910"><span class="mrow" id="MathJax-Span-6911"><span class="mi" id="MathJax-Span-6912" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6913" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6914" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6915"><span class="mrow" id="MathJax-Span-6916"><span class="mo" id="MathJax-Span-6917" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6918"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6919" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-6920" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6921" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6922" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6923" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6924" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6925" style="font-family: STIXGeneral-Regular;">]</span><span class="texatom" id="MathJax-Span-6926"><span class="mrow" id="MathJax-Span-6927"><span class="mi" id="MathJax-Span-6928" style="font-family: STIXGeneral-Regular;">ℙ</span></span></span><span class="mo" id="MathJax-Span-6929" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-6930"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6931" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-6932"><span class="mrow" id="MathJax-Span-6933"><span class="mi" id="MathJax-Span-6934" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-6935" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-6936" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-6937"><span class="mrow" id="MathJax-Span-6938"><span class="mo" id="MathJax-Span-6939" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-6940"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6941" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-6942" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6943" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6944" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6945" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-6946" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6947" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.261em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-239">\mathbb{P}[S_{t+1}, R_{t+1} | S_t, A_t] = \mathbb{P}[S_{t+1} | S_t, A_t] \mathbb{P}[R_{t+1} | S_t, A_t]</script><p></p>
<h2>Model Learning</h2>
<p>Goal: Estimate model <span class="MathJax" id="MathJax-Element-240-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6948" style="width: 1.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.66em, -0.525em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-6949"><span class="msubsup" id="MathJax-Span-6950"><span style="display: inline-block; position: relative; width: 1.331em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6951" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-6952" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.177em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-240">M_\eta</script> from experience <span class="MathJax" id="MathJax-Element-241-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6953" style="width: 9.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.39em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.685em, 1000em, 2.884em, -0.407em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6954"><span class="mo" id="MathJax-Span-6955" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-6956"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6957" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mn" id="MathJax-Span-6958" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6959" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6960" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6961" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mn" id="MathJax-Span-6962" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6963" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6964" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6965" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mn" id="MathJax-Span-6966" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6967" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-6968" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-6969" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-6970" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-6971" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-6972" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6973" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-6974" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6975" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.081em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-241">\{S_1, A_1, R_2, ..., S_T\}</script>.<br>
This is a supervised learning problem<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-242-Frame" style=""><nobr><span class="math" id="MathJax-Span-6976" style="width: 100%; display: inline-block; min-width: 9.641em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(5.188em, 1000em, 10.553em, -0.507em); top: -6.025em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-6977"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.161em, 1000em, 4.317em, -0.49em); top: -3.998em; left: 50%; margin-left: -3.327em;"><span class="msubsup" id="MathJax-Span-6978"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6979" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mn" id="MathJax-Span-6980" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6981" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6982" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6983" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mn" id="MathJax-Span-6984" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6985" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-6986" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6987" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mn" id="MathJax-Span-6988" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6989" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6990" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6991" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mn" id="MathJax-Span-6992" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000em, 4.327em, -0.507em); top: -2.695em; left: 50%; margin-left: -3.327em;"><span class="mspace" id="MathJax-Span-6993" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-6994"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6995" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mn" id="MathJax-Span-6996" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-6997" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-6998" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6999" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mn" id="MathJax-Span-7000" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7001" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-7002" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7003" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mn" id="MathJax-Span-7004" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7005" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7006" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.024em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7007" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mn" id="MathJax-Span-7008" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">3</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.823em, 1000em, 4.271em, -0.507em); top: -1.045em; left: 50%; margin-left: -0.256em;"><span class="mspace" id="MathJax-Span-7009" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7010" style="font-family: STIXGeneral-Regular;">⋮</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.161em, 1000em, 4.317em, -0.507em); top: 0.211em; left: 50%; margin-left: -4.34em;"><span class="mspace" id="MathJax-Span-7011" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-7012"><span style="display: inline-block; position: relative; width: 1.981em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7013" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-7014"><span class="mrow" id="MathJax-Span-7015"><span class="mi" id="MathJax-Span-7016" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7017" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-7018" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7019" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7020" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7021" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-7022"><span class="mrow" id="MathJax-Span-7023"><span class="mi" id="MathJax-Span-7024" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7025" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-7026" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7027" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-7028" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7029" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-7030" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7031" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7032" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7033" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7034" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 6.025em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.705em; vertical-align: -4.901em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-242"> S_1, A_1 \rightarrow R_2, S_2 \\ S_2, A_2 \rightarrow R_3, S_3 \\   \vdots \\   S_{T-1}, A_{T-1} \rightarrow R_T, S_T </script><br>
Learning <span class="MathJax" id="MathJax-Element-243-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7035" style="width: 3.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.378em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.917em, 1000em, 2.844em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7036"><span class="mi" id="MathJax-Span-7037" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7038" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7039" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7040" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="mi" id="MathJax-Span-7041" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.779em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-243">s,a \rightarrow r</script> is a regression problem.<br>
Learning <span class="MathJax" id="MathJax-Element-244-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7042" style="width: 4.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.885em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.844em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7043"><span class="mi" id="MathJax-Span-7044" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7045" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7046" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7047" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-7048" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">→</span><span class="msup" id="MathJax-Span-7049" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7050" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-7051" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.128em; vertical-align: -0.219em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-244">s,a, \rightarrow s'</script> is a density estimation problem.<br>
Pick loss function e.g. MSE, KL divergence, and find parameters <span class="MathJax" id="MathJax-Element-232-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6773" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6774"><span class="mi" id="MathJax-Span-6775" style="font-family: STIXGeneral-Italic;">η</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.842em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-232">\eta</script> that minimize empirical loss.<p></p>
<p>Possible Models: Table Lookup Model, Linear Gaussian Networks, Bayesian DNNs (very exciting - but have been hard to train so far). (Appendix 1. for Table Lookup Model)</p>
<h2>Sample-Based Plannig</h2>
<p>Use the model <em>only</em> to generate samples<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-245-Frame" style=""><nobr><span class="math" id="MathJax-Span-7052" style="width: 100%; display: inline-block; min-width: 10.141em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(3.153em, 1000em, 5.917em, -0.52em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-7053"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 4.462em, -0.49em); top: -3.998em; left: 50%; margin-left: -4.495em;"><span class="msubsup" id="MathJax-Span-7054"><span style="display: inline-block; position: relative; width: 1.756em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7055" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-7056"><span class="mrow" id="MathJax-Span-7057"><span class="mi" id="MathJax-Span-7058" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7059" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7060" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7061" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="msubsup" id="MathJax-Span-7062" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7063" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-7064" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7065" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7066"><span style="display: inline-block; position: relative; width: 1.756em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7067" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="texatom" id="MathJax-Span-7068"><span class="mrow" id="MathJax-Span-7069"><span class="mi" id="MathJax-Span-7070" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7071" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7072" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7073"><span class="mrow" id="MathJax-Span-7074"><span class="mo" id="MathJax-Span-7075" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7076"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7077" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7078" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7079" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7080" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7081" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-7082" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7083" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.153em, 1000em, 4.462em, -0.52em); top: -2.542em; left: 50%; margin-left: -4.56em;"><span class="mspace" id="MathJax-Span-7084" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-7085"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7086" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-7087"><span class="mrow" id="MathJax-Span-7088"><span class="mi" id="MathJax-Span-7089" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7090" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7091" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7092" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7093" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7094" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-7095" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7096" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7097"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7098" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-7099"><span class="mrow" id="MathJax-Span-7100"><span class="mi" id="MathJax-Span-7101" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7102" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7103" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7104"><span class="mrow" id="MathJax-Span-7105"><span class="mo" id="MathJax-Span-7106" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7107"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7108" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7109" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7110" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7111" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7112" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-7113" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7114" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.818em; vertical-align: -2.005em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-245">S_{t+1} \sim P_\eta (S_{t+1} | S_t, A_t) \\   R_{t+1} = R_\eta (R_{t+1}|S_t, A_t) </script><br>
Then apply model-free RL to samples, eg MC Control, SARSA, Q-learning.<p></p>
<p>Note: You built the model with data. We do not reuse that data to generate our actual training examples, we only use data generated by the current version of our model!<br>
Why: Sample-based planning methods are often more data efficient.</p>
<h1>Search Algorithms</h1>
<h2>Forward Search</h2>
</div><div class="cell text-cell"><img src="resources/E5ABD4E534503FA76596C137D9D84202.png" alt="Screenshot 2020-04-12 at 5.47.46 PM.png" width="613" height="454"><br><div>In order to figure out the value of each state in the tree, take a max over actions and take an expectation over states. There might be too many states and actions so often we just use simulation based search:</div><div><img src="resources/3EE92B8CF63967529C7AAD4F1C8DF6E5.png" alt="Screenshot 2020-04-12 at 5.50.55 PM.png" width="616" height="452"><br></div><div></div></div><div class="cell text-cell"></div><div class="cell markdown-cell"><h2>Simple MC Search</h2>
<p>Starting from a current state, perform a lot of simulations about the rewards from the current state <span class="MathJax" id="MathJax-Element-246-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7115" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7116"><span class="msubsup" id="MathJax-Span-7117"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7118" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7119" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">s_t</script>, then take one action (depth 1) from that state. Works but slow since we are only taking one step at a time.</p>
<p>Given a model <span class="MathJax" id="MathJax-Element-247-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7120" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.295em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.528em, -0.525em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7121"><span class="msubsup" id="MathJax-Span-7122"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7123" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-7124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.03em; vertical-align: -0.243em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">M_v</script> and a simulation policy <span class="MathJax" id="MathJax-Element-248-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7125" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7126"><span class="mi" id="MathJax-Span-7127" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-248">\pi</script>, and that we are currently at a real state <span class="MathJax" id="MathJax-Element-246-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7115" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7116"><span class="msubsup" id="MathJax-Span-7117"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7118" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7119" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">s_t</script>.<br>
For each possible action <span class="MathJax" id="MathJax-Element-249-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7128" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.73em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7129"><span class="mi" id="MathJax-Span-7130" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7131" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mi" id="MathJax-Span-7132" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">A</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.896em; vertical-align: -0.092em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-249">a \in A</script>:</p>
<ul>
<li>Simulate <span class="MathJax" id="MathJax-Element-250-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7133" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.5em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7134"><span class="mi" id="MathJax-Span-7135" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-250">K</script> episodes from the current (real) state <span class="MathJax" id="MathJax-Element-246-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7115" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7116"><span class="msubsup" id="MathJax-Span-7117"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7118" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7119" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">s_t</script>:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-251-Frame" style=""><nobr><span class="math" id="MathJax-Span-7136" style="width: 14.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.725em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.488em, 1000em, 3.017em, -0.407em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7137"><span class="mo" id="MathJax-Span-7138" style="font-family: STIXGeneral-Regular;">{</span><span class="msubsup" id="MathJax-Span-7139"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7140" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7141" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7142" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7143" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7144" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7145" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7146" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.485em, -0.497em); top: -2.689em; left: 0.619em;"><span class="mi" id="MathJax-Span-7147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.506em, -0.48em); top: -2.023em; left: 0.619em;"><span class="texatom" id="MathJax-Span-7148"><span class="mrow" id="MathJax-Span-7149"><span class="mi" id="MathJax-Span-7150" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7151" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7152" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7153" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-7154" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-7155" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-7156" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-7157" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-7158" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.081em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7159" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.485em, -0.497em); top: -2.703em; left: 0.615em;"><span class="mi" id="MathJax-Span-7160" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.053em; left: 0.555em;"><span class="mi" id="MathJax-Span-7161" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7162"><span style="display: inline-block; position: relative; width: 1.82em; height: 0px;"><span style="position: absolute; clip: rect(1.685em, 1000em, 2.884em, -0.377em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-7163" style="font-family: STIXGeneral-Regular;">}</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.716em; left: 0.507em;"><span class="mi" id="MathJax-Span-7164" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.485em, -0.497em); top: -2.053em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7165"><span class="mrow" id="MathJax-Span-7166"><span class="mi" id="MathJax-Span-7167" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-7168" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7169" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7170" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="msubsup" id="MathJax-Span-7171" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.838em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7172" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="texatom" id="MathJax-Span-7173"><span class="mrow" id="MathJax-Span-7174"><span class="mi" id="MathJax-Span-7175" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mo" id="MathJax-Span-7176" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7177" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.448em; vertical-align: -0.412em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-251">\{s_t, a, R_{t+1}^k,...,S_T^k\}_{k=1}^K \sim M_{v, \pi}</script></li>
<li>Evaluate actions by mean return (Monte-Carlo Evaluation)<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-252-Frame" style=""><nobr><span class="math" id="MathJax-Span-7178" style="width: 14.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.232em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.603em, 1000em, 3.96em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7179"><span class="mi" id="MathJax-Span-7180" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-7181" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7182"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7183" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7184" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7185" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7186" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7187" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7188" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-7189" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.852em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-7190" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.5em); top: -1.848em; left: 50%; margin-left: -0.366em;"><span class="mi" id="MathJax-Span-7191" style="font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 0.852em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7192" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7193" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.585em, -0.497em); top: -1.159em; left: 0.056em;"><span class="texatom" id="MathJax-Span-7194"><span class="mrow" id="MathJax-Span-7195"><span class="mi" id="MathJax-Span-7196" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-7197" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7198" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.477em, -0.502em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-7199" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7200" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7201" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-7202" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7203" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-7204" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7205" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.064em; left: 0.507em;"><span class="mi" id="MathJax-Span-7206" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7207" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7208"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7209" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7210" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7211" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7212" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7213" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.477em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-252">Q(s_t,a) = \frac{1}{K} \sum_{k=1}^K G_t \rightarrow q_\pi (s_t,a)</script></li>
</ul>
<p>Select current (real) action with maximal value <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7214" style="width: 11.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.135em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.921em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7215"><span class="msubsup" id="MathJax-Span-7216"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7217" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7219" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7220" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">arg</span><span class="mo" id="MathJax-Span-7221"></span><span class="munderover" id="MathJax-Span-7222" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.172em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-7223" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="texatom" id="MathJax-Span-7224"><span class="mrow" id="MathJax-Span-7225"><span class="mi" id="MathJax-Span-7226" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7227" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-7228" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7229" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Q</span><span class="mo" id="MathJax-Span-7230" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7231"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7232" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7233" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7234" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7235" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7236" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.117em; vertical-align: -0.304em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">a_t = \arg \max _{a \in A} Q(s_t,a)</script>.<br>
This is essentially doing 1 step of policy improvement according to the simulation policy.</p>
<h2>Expectimax Tree</h2>
<p>Full depth simulation, and then take the optimal path found my simulation.  Tree gets very big, grows exponentially with the horizon.</p>
<p>We can do better than 1 step of policy improvement. If we have the MDP model <span class="MathJax" id="MathJax-Element-247-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7120" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.295em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.528em, -0.525em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7121"><span class="msubsup" id="MathJax-Span-7122"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7123" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-7124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.03em; vertical-align: -0.243em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">M_v</script>, we can compute the optimal q(s,a) values for the current state by constructing an expectimax tree. Expectatons over states, max over actions.<br>
But problem: tree gets very big, grows exponentially with the horizon <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7237" style="width: 5.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.617em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.5em, 1000em, 2.88em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7238"><span class="mi" id="MathJax-Span-7239" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-7240" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-7241" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-7242"><span class="mrow" id="MathJax-Span-7243"><span class="mo" id="MathJax-Span-7244" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-7245" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="texatom" id="MathJax-Span-7246"><span class="mrow" id="MathJax-Span-7247"><span class="mo" id="MathJax-Span-7248" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-7249"><span class="mrow" id="MathJax-Span-7250"><span class="mo" id="MathJax-Span-7251" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-7252" style="font-family: STIXGeneral-Italic;">A</span><span class="msubsup" id="MathJax-Span-7253"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-7254"><span class="mrow" id="MathJax-Span-7255"><span class="mo" id="MathJax-Span-7256" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.225em;"><span class="mi" id="MathJax-Span-7257" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7258" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7259" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.281em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">O((|S||A|^T))</script></p>
<p>Note: In 2 player adversarial settings, use minimax instead of expectimax tree.</p>
<h2>Monte Carlo Tree Search (MCTS)</h2>
<p>This is what the robot does in its head to simulate and plan for the next action:</p>
<p>Medium depth simulation, trying to compute the value at a higher depth than 1 but in a computationally tractable way.<br>
Given Model <span class="MathJax" id="MathJax-Element-247-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7120" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.295em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.528em, -0.525em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7121"><span class="msubsup" id="MathJax-Span-7122"><span style="display: inline-block; position: relative; width: 1.275em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7123" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-7124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.03em; vertical-align: -0.243em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">M_v</script>, build a search tree rooted at the current state <span class="MathJax" id="MathJax-Element-246-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7115" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7116"><span class="msubsup" id="MathJax-Span-7117"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7118" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7119" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">s_t</script>. Samples actions and next states.<br>
Iteratively constriuct and update tree by performing K simulation episodes starting from the root state. After search is finished, select current (real) action with maximum value in each search tree: <span class="MathJax" id="MathJax-Element-255-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7260" style="width: 11.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.135em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.921em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7261"><span class="msubsup" id="MathJax-Span-7262"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7263" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7264" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7265" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7266" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">arg</span><span class="mo" id="MathJax-Span-7267"></span><span class="munderover" id="MathJax-Span-7268" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.172em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-7269" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="texatom" id="MathJax-Span-7270"><span class="mrow" id="MathJax-Span-7271"><span class="mi" id="MathJax-Span-7272" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7273" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-7274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">A</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7275" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Q</span><span class="mo" id="MathJax-Span-7276" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7277"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7278" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7279" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7280" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7281" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7282" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.117em; vertical-align: -0.304em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-255">a_t = \arg \max_{a \in A}Q(s_t,a)</script></p>
<p>Sample until termination or a horizon H, and then go back to start state and start another trajectory. Then take the expectimax reward over the partial tree computed so far to propagate the reward back to the root state. "Slowly fill in the expectimax tree but only have a partial tree because Expextimax tree might be intractible" (Appendix 2)</p>
<p>Simulating an episode involves two phases (in-tree, out-of-tree)</p>
<ul>
<li><strong>Tree policy</strong>: What do you do in some part of the tree where you have some data and have visited many times? Genearlly: Use Upper Confidence Tree Search (below). Or, pick actions for tree nodes to maximize Q(S,A) according to some heuristic.</li>
<li><strong>Roll out policy</strong>: What should you do if you reach a node if you've never been before, or you only visited a few times? Generally: pick actions randomly, or another policy.</li>
</ul>
<p>To evaluate the value of a tree node <span class="MathJax" id="MathJax-Element-256-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7283" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.711em, 1000em, 2.714em, -0.458em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7284"><span class="mi" id="MathJax-Span-7285" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.863em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-256">i</script> at state action pair <span class="MathJax" id="MathJax-Element-257-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7286" style="width: 2.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.027em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7287"><span class="mo" id="MathJax-Span-7288" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7289" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7290" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7291" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7292" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-257">(s,a)</script>, average over all rewards recieved from that node onwards across simulated episodes in which this tree node was reached.</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-258-Frame" style=""><nobr><span class="math" id="MathJax-Span-7293" style="width: 21.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.538em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.603em, 1000em, 3.96em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7294"><span class="mi" id="MathJax-Span-7295" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-7296" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7297" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7298" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7299" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-7300" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.865em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-7301" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -1.848em; left: 50%; margin-left: -0.873em;"><span class="mrow" id="MathJax-Span-7302"><span class="mi" id="MathJax-Span-7303" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-7304" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7305" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7306" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.865em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7307" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7308" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.585em, -0.497em); top: -1.159em; left: 0.056em;"><span class="texatom" id="MathJax-Span-7309"><span class="mrow" id="MathJax-Span-7310"><span class="mi" id="MathJax-Span-7311" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-7312" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7313" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.477em, -0.502em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-7314" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7315" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7316" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.585em, -0.477em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7317"><span class="mrow" id="MathJax-Span-7318"><span class="mi" id="MathJax-Span-7319" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-7320" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-7321" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0.45em;"><span class="mi" id="MathJax-Span-7322" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7323" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7324"><span class="mn" id="MathJax-Span-7325" style="font-family: STIXGeneral-Regular;">𝟙</span></span></span><span class="mo" id="MathJax-Span-7326" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7327" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7328" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mi" id="MathJax-Span-7329" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">e</span><span class="mi" id="MathJax-Span-7330" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-7331" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7332" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-7333" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-7334" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-7335"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7336" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-7337" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7338" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7339" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7340" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7341" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="mi" id="MathJax-Span-7342" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">q</span><span class="mo" id="MathJax-Span-7343" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7344" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7345" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7346" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7347" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.477em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-258">Q(i) = \frac{1}{N(i)} \sum_{k=1}^K \sum_{u=t}^T \mathbb{1}(i \in epi.k) G_k(i) \rightarrow q(s,a)</script><p></p>
<p>Under mild conditions, this converges to the optimal search tree <span class="MathJax" id="MathJax-Element-259-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7348" style="width: 8.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.77em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.912em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7349"><span class="mi" id="MathJax-Span-7350" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-7351" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7352" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-7353" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7354" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">A</span><span class="mo" id="MathJax-Span-7355" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7356" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-7357" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7358" style="font-family: STIXGeneral-Italic;">q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.507em;"><span class="mo" id="MathJax-Span-7359" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7360" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7361" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-7362" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7363" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">A</span><span class="mo" id="MathJax-Span-7364" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.129em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-259">Q(S,A) \rightarrow q^*(S,A)</script>. Note that we're no longer doing expectation or max anymore, but this is okay because we are going to sample actions in a way that over time we will sample actions that look better much more.</p>
<p><strong>Advantages of MC Tree Search</strong></p>
<ul>
<li>highly selective best-first search.</li>
<li>Evaluates states dynamically (unlike DP)</li>
<li>Uses sampling to break the curse of dimensionality</li>
<li>Works for black-box models (only requires samples)</li>
<li>Very sample efficnet</li>
<li>Very computationally effiicent, anytime, parallelizable</li>
</ul>
<h3>Upper Confidence Tree (UCT) Search</h3>
<p>This is a way to implement the <strong>tree policy</strong> above in MCTS.<br>
Idea: borrow idea from banit literature and treat each node where we can selection each action as a multi-armed bandit problem. Treat every distinct node in the tree (could be very many) as a bandits problem, and uses optimism.</p>
<p>For each node <span class="MathJax" id="MathJax-Element-260-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7365" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7366"><span class="msubsup" id="MathJax-Span-7367"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7368" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7369" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">s_i</script> and action from that state <span class="MathJax" id="MathJax-Element-261-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7370" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.661em, -0.49em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7371"><span class="msubsup" id="MathJax-Span-7372"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7373" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7374" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.943em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">a_j</script>, we compute a empirical Q function <span class="MathJax" id="MathJax-Element-262-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7375" style="width: 3.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.491em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.391em, 1000em, 2.999em, -0.682em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7376"><span class="texatom" id="MathJax-Span-7377"><span class="mrow" id="MathJax-Span-7378"><span class="munderover" id="MathJax-Span-7379"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7380" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7381" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7382" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7383"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7384" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7385" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7386" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7387" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7388" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7389" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7390" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.535em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-262">\hat Q(s_i,a_j)</script> based on adding the future rewards we obtained every time we were in that node during simulation previously, and also add a optimistic confidence bound adjustment (usually in the form of <span class="MathJax" id="MathJax-Element-263-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7391" style="width: 4.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.11em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.037em, 1000em, 3.233em, -0.395em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7392"><span class="msqrt" id="MathJax-Span-7393"><span style="display: inline-block; position: relative; width: 4.101em; height: 0px;"><span style="position: absolute; clip: rect(3.214em, 1000em, 4.685em, -0.507em); top: -3.998em; left: 1.07em;"><span class="mrow" id="MathJax-Span-7394"><span class="mfrac" id="MathJax-Span-7395"><span style="display: inline-block; position: relative; width: 2.766em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.918em, 1000em, 2.341em, -0.448em); top: -2.702em; left: 50%; margin-left: -0.113em;"><span class="mo" id="MathJax-Span-7396" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⋅</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.497em); top: -1.915em; left: 50%; margin-left: -1.323em;"><span class="mrow" id="MathJax-Span-7397"><span class="mi" id="MathJax-Span-7398" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7399" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7400"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7401" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.338em;"><span class="mn" id="MathJax-Span-7402" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-7403" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7404" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7405" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-7406" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7407" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.766em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.009em, 1000em, 3.397em, -0.507em); top: -4.167em; left: 1.07em;"><span style="display: inline-block; position: relative; width: 3.031em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 2.531em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.401em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.827em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.253em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.679em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.105em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.277em, 1000em, 4.462em, -0.395em); top: -3.425em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.187em; vertical-align: -1.026em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-263">\sqrt{\frac{\cdot}{n(s_1,a,1)}}</script>, <span class="MathJax" id="MathJax-Element-264-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7408" style="width: 4.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.11em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.831em, 1000em, 3.029em, -0.395em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7409"><span class="msqrt" id="MathJax-Span-7410"><span style="display: inline-block; position: relative; width: 4.101em; height: 0px;"><span style="position: absolute; clip: rect(2.805em, 1000em, 4.685em, -0.507em); top: -3.998em; left: 1.07em;"><span class="mrow" id="MathJax-Span-7411"><span class="mfrac" id="MathJax-Span-7412"><span style="display: inline-block; position: relative; width: 2.766em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.657em, 1000em, 2.603em, -0.493em); top: -2.849em; left: 50%; margin-left: -1.098em;"><span class="mrow" id="MathJax-Span-7413"><span class="mi" id="MathJax-Span-7414" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">ln</span><span class="mo" id="MathJax-Span-7415" style="font-size: 70.7%;"></span><span class="mo" id="MathJax-Span-7416" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7417" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7418" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7419" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7420" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7421" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.497em); top: -1.915em; left: 50%; margin-left: -1.323em;"><span class="mrow" id="MathJax-Span-7422"><span class="mi" id="MathJax-Span-7423" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7424" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7425"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7426" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.338em;"><span class="mn" id="MathJax-Span-7427" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-7428" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7429" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7430" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-7431" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7432" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.766em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.009em, 1000em, 3.397em, -0.507em); top: -4.374em; left: 1.07em;"><span style="display: inline-block; position: relative; width: 3.031em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 2.531em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.401em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.827em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.253em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.679em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.105em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.277em, 1000em, 4.462em, -0.395em); top: -3.629em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.19em; vertical-align: -0.799em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">\sqrt{\frac{\ln (n(s))}{n(s_1,a,1)}}</script> is a common pick) such that our final <span class="MathJax" id="MathJax-Element-265-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7433" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7434"><span class="mi" id="MathJax-Span-7435" style="font-family: STIXGeneral-Italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-265">Q</script> functions we compare to pick the next action is <span class="MathJax" id="MathJax-Element-266-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7436" style="width: 9.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.784em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.375em, 1000em, 3.571em, -0.682em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7437"><span class="texatom" id="MathJax-Span-7438"><span class="mrow" id="MathJax-Span-7439"><span class="munderover" id="MathJax-Span-7440"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7441" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.298em; left: 0.21em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7442" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-7443" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7444"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7445" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7446" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7447" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7448" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7449" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7450" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7451" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7452" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msqrt" id="MathJax-Span-7453" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 4.101em; height: 0px;"><span style="position: absolute; clip: rect(3.214em, 1000em, 4.685em, -0.507em); top: -3.998em; left: 1.07em;"><span class="mrow" id="MathJax-Span-7454"><span class="mfrac" id="MathJax-Span-7455"><span style="display: inline-block; position: relative; width: 2.766em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.918em, 1000em, 2.341em, -0.448em); top: -2.702em; left: 50%; margin-left: -0.113em;"><span class="mo" id="MathJax-Span-7456" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⋅</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.497em); top: -1.915em; left: 50%; margin-left: -1.323em;"><span class="mrow" id="MathJax-Span-7457"><span class="mi" id="MathJax-Span-7458" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7459" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7460"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7461" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.338em;"><span class="mn" id="MathJax-Span-7462" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-7463" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7464" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-7465" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-7466" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7467" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.766em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.009em, 1000em, 3.397em, -0.507em); top: -4.167em; left: 1.07em;"><span style="display: inline-block; position: relative; width: 3.031em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 2.531em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.401em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.827em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.253em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.679em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.105em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.277em, 1000em, 4.462em, -0.395em); top: -3.425em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.187em; vertical-align: -1.026em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">\hat Q(s_i,a_j) + \sqrt{\frac{\cdot}{n(s_1,a,1)}}</script>.</p>
<p>In other words, we maintain an upper confidence bound for every action and every state in our tree. Formally</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-267-Frame" style=""><nobr><span class="math" id="MathJax-Span-7468" style="width: 29.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.971em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.603em, 1000em, 3.96em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7469"><span class="mi" id="MathJax-Span-7470" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-7471" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7472" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7473" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7474" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7475" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7476" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">i</span><span class="mo" id="MathJax-Span-7477" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7478" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-7479" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.611em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-7480" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -1.848em; left: 50%; margin-left: -1.745em;"><span class="mrow" id="MathJax-Span-7481"><span class="mi" id="MathJax-Span-7482" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-7483" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7484" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7485" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7486" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7487" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7488" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">i</span><span class="mo" id="MathJax-Span-7489" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.611em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7490" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7491" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.585em, -0.497em); top: -1.159em; left: 0.056em;"><span class="texatom" id="MathJax-Span-7492"><span class="mrow" id="MathJax-Span-7493"><span class="mi" id="MathJax-Span-7494" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-7495" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7496" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.477em, -0.502em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-7497" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7498" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7499" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.585em, -0.477em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7500"><span class="mrow" id="MathJax-Span-7501"><span class="mi" id="MathJax-Span-7502" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span class="mo" id="MathJax-Span-7503" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-7504" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.578em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0.45em;"><span class="mi" id="MathJax-Span-7505" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7506" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7507"><span class="mn" id="MathJax-Span-7508" style="font-family: STIXGeneral-Regular;">𝟙</span></span></span><span class="mo" id="MathJax-Span-7509" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7510" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7511" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mi" id="MathJax-Span-7512" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">e</span><span class="mi" id="MathJax-Span-7513" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-7514" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7515" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-7516" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-7517" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-7518"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7519" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-7520" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7521" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7522" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7523" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7524" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7525" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7526" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">i</span><span class="mo" id="MathJax-Span-7527" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7528" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7529" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">c</span><span class="msqrt" id="MathJax-Span-7530"><span style="display: inline-block; position: relative; width: 4.552em; height: 0px;"><span style="position: absolute; clip: rect(2.469em, 1000em, 5.03em, -0.507em); top: -3.998em; left: 1.126em;"><span class="mrow" id="MathJax-Span-7531"><span class="mfrac" id="MathJax-Span-7532"><span style="display: inline-block; position: relative; width: 3.161em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.488em); top: -3.21em; left: 50%; margin-left: -1.52em;"><span class="mrow" id="MathJax-Span-7533"><span class="mi" id="MathJax-Span-7534" style="font-family: STIXGeneral-Regular;">ln</span><span class="mo" id="MathJax-Span-7535"></span><span class="mo" id="MathJax-Span-7536" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7537" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7538" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7539" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7540" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7541" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.493em); top: -1.848em; left: 50%; margin-left: -1.267em;"><span class="mrow" id="MathJax-Span-7542"><span class="mi" id="MathJax-Span-7543" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7544" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7545" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7546" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7547" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7548" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.161em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.009em, 1000em, 3.397em, -0.507em); top: -4.648em; left: 1.126em;"><span style="display: inline-block; position: relative; width: 3.426em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.998em; left: 2.926em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.397em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 0.818em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.24em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 1.661em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.083em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -3.998em; left: 2.504em;">‾<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.773em, 1000em, 4.571em, -0.397em); top: -3.396em; left: 0em;"><span style="font-family: STIXSizeTwoSym;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.477em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-267">Q(s,a,i) = \frac{1}{N(s,a,i)} \sum_{k=1}^K \sum_{u=t}^T \mathbb{1}(i \in epi.k) G_k(s,a,i) + c \sqrt{\frac{\ln (n(s))}{n(s,a)}}</script><p></p>
<p>(Appendix 3)</p>
<h2>Other parts of Alpha Go</h2>
<p>Action heuristics (what order to try actions in was pretty important)<br>
Self-play - use the current agent as the opponent as the minimizer of the minimax.</p>
<ul>
<li>If you have two players that are both bad (like two models), one will win and one will lose, and you always get signal (for one of the models) each time.</li>
<li>If you only play against a grandmaster, you won't get reward signals for a long time.</li>
<li>Self play can get stuck in local optimal but if you are exploring you can likely get out of it.</li>
</ul>
<h1>Appendices</h1>
</div><div class="cell text-cell"><b style="font-size: 18px;">Appendix 1: Table Lookup Model</b><div><div>LIterally the current reward and transition model is just the proportions of the counts seen so far.<br><div><img src="resources/34FD345D7D12166BD860B8BE6BF5066B.png" alt="Screenshot 2020-04-12 at 5.24.36 PM.png" width="625" height="463"><br></div><div><br></div><div><img src="resources/B720774A4888D0471944C04EBB940775.png" alt="Screenshot 2020-04-12 at 5.26.01 PM.png" width="616" height="455"><br></div></div><div>MC methods will converge to the min MSE model, and does not make a Markovian assumption, so it will converge in all cases including the case above. But in general it will will not converge to the same policy as if we took the MLE model and did planning.</div><div><br></div><div><img src="resources/8E902FB4BA8F6268E93745F6FDC054E8.png" alt="Screenshot 2020-04-12 at 5.37.46 PM.png" width="620" height="456"></div><div><br></div><div><img src="resources/B07427E14F6327F4F446198CFBDA2591.png" alt="Screenshot 2020-04-12 at 5.39.41 PM.png" width="611" height="454"><br></div><div>Solution 1: It depends why the model is wrong. If you assumed the world is not Markov, Q learning wont help because it also assumes Markov</div><div>Solution 2 still makes the basic assumption that your model class is correct.&nbsp;</div><div><br></div><div>The models we need to make decisions are not the models that we need for preductive accuracy. It doesn’t matter that we can represent many parts of our world accurately, if those parts are irrelevant to our decision-making.</div><div><br></div><div><b><span style="font-size: 19px;">Appendix 2:</span></b><b><span style="font-size: 19px;">&nbsp;Monte Carlo Tree Search</span></b></div><div><img src="resources/A1E20928B8738F987C7DCEE07DC1A842.png" alt="Screenshot 2020-04-12 at 6.04.37 PM.png" width="595" height="451"><b><br></b></div><div><br></div><div><br></div></div></div></div>
    </body>
    </html>
  