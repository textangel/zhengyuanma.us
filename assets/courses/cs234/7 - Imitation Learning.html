
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS234 - Lecture 7 - Imitation Learning</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p><strong>Imitation Learning</strong> - Learning from Demonstrations (Mostly Applications in Driving and Robotics). Why Imitation Learning? <strong>Data Efficiency</strong>: How much data is needed to learn good decisions.</p>
<p><strong>Input:</strong></p>
<ul>
<li>State Space, Action space</li>
<li>Transition model <span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-442" style="width: 4.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.66em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-445" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-447" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mo" id="MathJax-Span-451" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-452" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-453" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-454" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-455" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.168em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">P(s'|s,a)</script></li>
<li>no reward function R</li>
<li>set of one or more teacher's demonstrations <span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-456" style="width: 6.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.8em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-457"><span class="mo" id="MathJax-Span-458" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-460" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-461" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-462" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-463" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-464" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-466" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-467" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-468" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-469" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-470" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-471" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-472" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-473" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-474" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">(s_0,a_0,s_1,s_0)</script> drawn from teacher's policy <span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-475" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.126em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.383em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-476"><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-479" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.917em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\pi^*</script></li>
</ul>
<h2>Behavorial Cloning</h2>
<p>(Appendix 1)<br>
Behavorial Cloning: Formulate problem as a standard supervised machine learning problem, fixing a policy class (e.g. neural network). Estimate a policy from training examples <span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-480" style="width: 7.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.532em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-481"><span class="mo" id="MathJax-Span-482" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-483" style="font-family: STIXGeneral-Italic;">s</span><span class="mn" id="MathJax-Span-484" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-485" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-486" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mn" id="MathJax-Span-487" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-488" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-489" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-490" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">(</span><span class="mi" id="MathJax-Span-491" style="font-family: STIXGeneral-Italic;">s</span><span class="mn" id="MathJax-Span-492" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-493" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-494" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mn" id="MathJax-Span-495" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-496" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">(s0,a0), (s1,a1)</script>, etc.<br>
Supervised learning assumes iis (s,a) pairs and ignores temporal structure. Errors are independent in time.</p>
<p>Problem: Compunding Errors.<br>
We will compund errors because the distribution of actions taken is different from distribution of training data. i.e. if the teacher data has "go right" in a particular situation, but our supervised learner made an error and went "left", now all the current state distribution is something that we have not seen before and is not the same as the training distrbution. In a paper it was proved that the error at time <span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-497" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-498"><span class="mi" id="MathJax-Span-499" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.743em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">t</script> with probability <span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-500" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-501"><span class="mi" id="MathJax-Span-502" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">\epsilon</script> was (Appendix 1) </p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" style=""><nobr><span class="math" id="MathJax-Span-503" style="width: 22.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.383em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.474em, 1000em, 2.88em, -0.437em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="texatom" id="MathJax-Span-505"><span class="mrow" id="MathJax-Span-506"><span class="mi" id="MathJax-Span-507" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: STIXGeneral-Regular;">[</span><span class="mtext" id="MathJax-Span-509" style="font-family: STIXGeneral-Regular;">Total Errors</span><span class="mo" id="MathJax-Span-510" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-511" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mi" id="MathJax-Span-512" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span><span class="mo" id="MathJax-Span-513" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-514" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-515" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-516" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mi" id="MathJax-Span-517" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-518" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mn" id="MathJax-Span-519" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-520" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-521" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-522" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋯</span><span class="mo" id="MathJax-Span-523" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-524" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-525" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-526" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∝</span><span class="mi" id="MathJax-Span-527" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span><span class="msubsup" id="MathJax-Span-528"><span style="display: inline-block; position: relative; width: 1.218em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-529" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.749em;"><span class="mn" id="MathJax-Span-530" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.31em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">\mathbb{E}[\text{Total Errors}] \le \epsilon(T+(T-1)+\cdots + 1) \propto \epsilon T^2</script><p></p>
<p>This leads to the situation pictured in Appendix 1.</p>
<h3>DAGGER</h3>
<p>Do behavorial cloning (supervised learning), but when you hit a situation that you haven't seen before in the dataset, ask an in-the-loop expert what to do, and add that datapoint to your dataset. Grow dataset constantly using explored states and expert-given actions.</p>
<p><strong>Pseudocode:</strong> (Appendix 1)<br>
Initialize dataset to be empty.<br>
Initialize the current learned policy <span class="MathJax" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-531" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.291em, 1000em, 2.515em, -0.721em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-532"><span class="msubsup" id="MathJax-Span-533"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000em, 4.185em, -0.721em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="munderover" id="MathJax-Span-536"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-537" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.06em; left: 0.172em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-538" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-539" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.108em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">\hat \pi_1</script> to any policy.<br>
Loop until done:</p>
<ul>
<li>Mix the current learned policy with the expert policy seen so far <span class="MathJax" id="MathJax-Element-30-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-540" style="width: 10.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.403em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.629em, 1000em, 2.951em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-541"><span class="msubsup" id="MathJax-Span-542"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-543" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-544" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-545" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-546" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.908em, -0.547em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-547" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.555em;"><span class="mi" id="MathJax-Span-548" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-549"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-550" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-551" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-552" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-553" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mn" id="MathJax-Span-554" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-555" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-556" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.908em, -0.547em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: STIXGeneral-Italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.555em;"><span class="mi" id="MathJax-Span-558" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-559" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-560"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(3.093em, 1000em, 4.185em, -0.721em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-561"><span class="mrow" id="MathJax-Span-562"><span class="munderover" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.06em; left: 0.172em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-565" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-566" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.217em; vertical-align: -0.338em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">\pi_i = \beta_i \pi^* + (1-\beta_i) \hat \pi_i</script> (Important for learning! - Although the prof said that in this case this step should be "toss a weighted coin as to whether the expert should give you the exact action or to follow the currently learned policy".)</li>
<li>Sample T-step trajectories using <span class="MathJax" id="MathJax-Element-61-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1116" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1117"><span class="msubsup" id="MathJax-Span-1118"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1119" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-1120" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">\pi_i</script></li>
<li>For all visited states in sampled trajectories, ask expert for actions they would have taken in those states to form the update dataset <span class="MathJax" id="MathJax-Element-32-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-572" style="width: 7.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.038em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.884em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-573"><span class="msubsup" id="MathJax-Span-574"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-575" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-576" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-577" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-578" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">{</span><span class="mo" id="MathJax-Span-579" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-580" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-581" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-582" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-583" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-584" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-585" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-586" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-587" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-588" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-589" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.098em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">D_i = \{(s, \pi^*(s))\}</script></li>
<li>Aggregate datasets: <span class="MathJax" id="MathJax-Element-33-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-590" style="width: 5.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.236em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.86em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-591"><span class="mi" id="MathJax-Span-592" style="font-family: STIXGeneral-Italic;">D</span><span class="mo" id="MathJax-Span-593" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">←</span><span class="mi" id="MathJax-Span-594" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">D</span><span class="mo" id="MathJax-Span-595" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∪</span><span class="msubsup" id="MathJax-Span-596" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-597" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-598" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.025em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">D \leftarrow D \cup D_i</script></li>
<li>Train classifier <span class="MathJax" id="MathJax-Element-34-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-599" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.544em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-600"><span class="msubsup" id="MathJax-Span-601"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-602" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-603"><span class="mrow" id="MathJax-Span-604"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-606" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-607" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.799em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">\pi_{i+1}</script> on <span class="MathJax" id="MathJax-Element-35-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-608" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-609"><span class="mi" id="MathJax-Span-610" style="font-family: STIXGeneral-Italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">D</script>.</li>
<li>Update policy with expert</li>
</ul>
<p>Everything that you train the dataset on is with an expert label, and you slowly grow the size of that dataset.<br>
DAGGER has good convergence properties. Requires a constantly in-the-loop expert, so its hard to scale up.</p>
<h2>Inverse RL</h2>
<p>Can we recover <span class="MathJax" id="MathJax-Element-40-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-643" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-644"><span class="mi" id="MathJax-Span-645" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">R</script> given demonstrations?<br>
Given: State space <span class="MathJax" id="MathJax-Element-37-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-614" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-615"><span class="mi" id="MathJax-Span-616" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.885em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">S</script>, action space <span class="MathJax" id="MathJax-Element-38-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-617" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: STIXGeneral-Italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.866em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">A</script>, transition model <span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-442" style="width: 4.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.66em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-445" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-447" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-448" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mo" id="MathJax-Span-451" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-452" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-453" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-454" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-455" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.168em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">P(s'|s,a)</script>, and a set of one or more teacher's demonstrations <span class="MathJax" id="MathJax-Element-39-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-620" style="width: 8.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.714em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-621"><span class="mo" id="MathJax-Span-622" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-623"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-624" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-625" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-626" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-627" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-628" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-629" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-630" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-631" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-632" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-633" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-634" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-635" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-636" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-637" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-638" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-639" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-640" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-641" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-642" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">(s_0,a_o,s_1,a_1,...)</script> drawn from the teacher policy <span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-475" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.126em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.383em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-476"><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-479" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.917em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\pi^*</script>.<br>
Goal: Infer the reward function <span class="MathJax" id="MathJax-Element-40-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-643" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-644"><span class="mi" id="MathJax-Span-645" style="font-family: STIXGeneral-Italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.85em; vertical-align: -0.063em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">R</script>.<br>
Note: Compatible reward functions to the action state are not unique.<br>
Note: Can be extended to situations where the transition model is unknown, but requires access to a simulator.</p>
<h3>Linear Feature Reward Inverse RL</h3>
<p><strong>Feature Matching</strong><br>
Feature Matching is one way to do linear feature reward inverse RL. Note that this is not an algo that a lot of people use anymore, most people use deep learning.</p>
<p>We model the reward as a linear function of the features: <span class="MathJax" id="MathJax-Element-41-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-646" style="width: 15.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.682em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.54em, 1000em, 2.88em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-647"><span class="mi" id="MathJax-Span-648" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-649" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-650" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-651" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-652" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-653" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-654" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.732em;"><span class="mi" id="MathJax-Span-655" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-656" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-657" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-658" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-659" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-660" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-661" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-662" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-663" style="font-family: STIXGeneral-Italic;">w</span><span class="mo" id="MathJax-Span-664" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-665" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-666" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="mi" id="MathJax-Span-667" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-668" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-669" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-670" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">→</span></span><span class="msubsup" id="MathJax-Span-671" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.237em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">R(s) = w^Tx(s) \;\;\; w \in R^n, x:\rightarrow R^n</script>.<br>
Goal: Identify the weight vector <span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1121" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">w</script> given a set of demonstrations.<br>
The resulting value function for a policy <span class="MathJax" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-795" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">\pi</script> can be expressed as<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-44-Frame" style=""><nobr><span class="math" id="MathJax-Span-680" style="width: 18.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.061em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-1.963em, 1000em, 5.855em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-681"><span class="mtable" id="MathJax-Span-682" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 16.723em; height: 0px;"><span style="position: absolute; clip: rect(4.125em, 1000em, 10.999em, -0.507em); top: -7.545em; left: 0em;"><span style="display: inline-block; position: relative; width: 7.827em; height: 0px;"><span style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.431em); top: -5.37em; right: 0em;"><span class="mtd" id="MathJax-Span-683"><span class="mrow" id="MathJax-Span-684"><span class="msubsup" id="MathJax-Span-685"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-686" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-687" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-688" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-689" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-690"><span class="mi" id="MathJax-Span-691" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-692" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-693" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">[</span></span><span class="msubsup" id="MathJax-Span-694"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-695" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-697" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-698" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-699"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-700" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-701" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-702" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-703"><span class="mrow" id="MathJax-Span-704"><span class="mo" id="MathJax-Span-705" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-706" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-707" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.182em; right: 0em;"><span class="mtd" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -0.713em; right: 0em;"><span class="mtd" id="MathJax-Span-774"><span class="mrow" id="MathJax-Span-775"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.545em;"></span></span><span style="position: absolute; clip: rect(4.343em, 1000em, 12.161em, -0.209em); top: -8.502em; left: 7.827em;"><span style="display: inline-block; position: relative; width: 8.896em; height: 0px;"><span style="position: absolute; clip: rect(0.761em, 1000em, 3.963em, -0.209em); top: -4.92em; left: 0em;"><span class="mtd" id="MathJax-Span-708"><span class="mrow" id="MathJax-Span-709"><span class="mo" id="MathJax-Span-710" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="texatom" id="MathJax-Span-711"><span class="mrow" id="MathJax-Span-712"><span class="mi" id="MathJax-Span-713" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mo" id="MathJax-Span-714" style="font-family: STIXGeneral-Regular;">[</span><span class="munderover" id="MathJax-Span-715"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-716" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-720" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-721" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.736em, 1000em, 2.477em, -0.457em); top: -3.509em; left: 0.31em;"><span class="mi" id="MathJax-Span-722" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-723" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-724" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-725" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-726"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-727" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-728" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-729" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-730" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-731"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-732" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-733" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-734" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-735"><span class="mrow" id="MathJax-Span-736"><span class="mo" id="MathJax-Span-737" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-738" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-739" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.761em, 1000em, 3.96em, -0.209em); top: -1.718em; left: 0em;"><span class="mtd" id="MathJax-Span-742"><span class="mrow" id="MathJax-Span-743"><span class="mo" id="MathJax-Span-744" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-745"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-746" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-747" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-748"><span class="mrow" id="MathJax-Span-749"><span class="mi" id="MathJax-Span-750" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: STIXGeneral-Regular;">[</span><span class="munderover" id="MathJax-Span-752"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-753" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-757" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-758" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.736em, 1000em, 2.477em, -0.457em); top: -3.509em; left: 0.31em;"><span class="mi" id="MathJax-Span-759" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-760" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-761" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-762" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-763" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-764" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-765"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-766" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-768" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-769"><span class="mrow" id="MathJax-Span-770"><span class="mo" id="MathJax-Span-771" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-772" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-773" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.49em, 1000em, 2.908em, -0.209em); top: 0.751em; left: 0em;"><span class="mtd" id="MathJax-Span-776"><span class="mrow" id="MathJax-Span-777"><span class="mo" id="MathJax-Span-778" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-779"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-782" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-783" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-784" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-785" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.502em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 8.428em; vertical-align: -3.937em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-44">\begin{align} V^\pi = \mathbb{E} \left[ \gamma^t R(s_t) | \pi \right] & = \mathbb{E}[\sum_{t=0}^\infty \gamma^t w^T x(s_t) | \pi] \\ & = w^T \mathbb{E} [\sum_{t=1}^\infty \gamma^t x(s_t) | \pi] \\ & = w^T \mu(\pi) \end{align}</script><p></p>
<p>where <span class="MathJax" id="MathJax-Element-45-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-786" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.872em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-787"><span class="mi" id="MathJax-Span-788" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-789" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-790" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-791" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-792" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-793" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-794" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">\mu(\pi)(s)</script> is defined as the discounted weighted frequency of state features under policy <span class="MathJax" id="MathJax-Element-46-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-795" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">\pi</script> (How much time you spend in differnet states - using featurized states, discounted by when you reach those states. Essentially the stationary distribution of states, weighted by the discount factor, and featurized)</p>
<p>So now instead of thinking about reward functions, we can start thinking about different distributions of states, which in a linear assumption is isomorphic to differnet reward functions. (Appendix 2)</p>
<p>Now, assuming we have the optimal reward function, the value function using <span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-475" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.126em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.383em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-476"><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-478" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-479" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.917em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\pi^*</script> is better than the value for any other policy (that is,<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-47-Frame" style=""><nobr><span class="math" id="MathJax-Span-798" style="width: 26.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.761em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.761em, 1000em, 3.96em, -0.437em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-799"><span class="texatom" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"><span class="mi" id="MathJax-Span-802" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: STIXGeneral-Regular;">[</span><span class="munderover" id="MathJax-Span-804"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-805" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-806"><span class="mrow" id="MathJax-Span-807"><span class="mi" id="MathJax-Span-808" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-809" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-810" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.736em, 1000em, 2.477em, -0.457em); top: -3.509em; left: 0.31em;"><span class="mi" id="MathJax-Span-811" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-812" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-813" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-814" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-815"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-816" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.619em;"><span class="mo" id="MathJax-Span-817" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-818" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-819" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-820" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-821" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-822" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-823"><span class="mrow" id="MathJax-Span-824"><span class="mo" id="MathJax-Span-825" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-826"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-827" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.623em;"><span class="mo" id="MathJax-Span-828" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-829" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-830" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-831" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-832" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mo" id="MathJax-Span-833" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-834" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≥</span><span class="msubsup" id="MathJax-Span-835" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-836" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-837" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-838" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-839" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-840"><span class="mi" id="MathJax-Span-841" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mo" id="MathJax-Span-842" style="font-family: STIXGeneral-Regular;">[</span><span class="munderover" id="MathJax-Span-843"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-844" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-845"><span class="mrow" id="MathJax-Span-846"><span class="mi" id="MathJax-Span-847" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-848" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-849" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.736em, 1000em, 2.477em, -0.457em); top: -3.509em; left: 0.31em;"><span class="mi" id="MathJax-Span-850" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-851" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-852" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-853" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-854"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-855" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.619em;"><span class="mo" id="MathJax-Span-856" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-857" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-859" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-860" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-861" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-862"><span class="mrow" id="MathJax-Span-863"><span class="mo" id="MathJax-Span-864" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-865" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-866" style="font-family: STIXGeneral-Regular;">]</span><span class="mspace" id="MathJax-Span-867" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-868" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-869" style="font-family: STIXGeneral-Regular;">∀</span><span class="mi" id="MathJax-Span-870" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.302em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-47">\mathbb{E} [\sum_{t=1}^\infty \gamma^t R^*(s+t) | \pi^*] = V^* \ge V^\pi =  \mathbb{E} [\sum_{t=1}^\infty \gamma^t R^*(s_t) | \pi] \;\; \forall \pi</script><p></p>
<p>thus if the expert's demonstrations are from the optimal policy to identify <span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1121" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">w</script> it is sufficient to find <span class="MathJax" id="MathJax-Element-49-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-874" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.383em, -0.492em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-875"><span class="msubsup" id="MathJax-Span-876"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-877" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.732em;"><span class="mo" id="MathJax-Span-878" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.917em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">w^*</script> such that (Appendix 2)<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" style=""><nobr><span class="math" id="MathJax-Span-879" style="width: 14.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.288em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.43em, 1000em, 2.908em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-880"><span class="msubsup" id="MathJax-Span-881"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000em, 4.185em, -0.492em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-882"><span class="mrow" id="MathJax-Span-883"><span class="msubsup" id="MathJax-Span-884"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-885" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mo" id="MathJax-Span-886" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.781em; left: 1.201em;"><span class="mi" id="MathJax-Span-887" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-888" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-889" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-890"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-891" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.623em;"><span class="mo" id="MathJax-Span-892" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-893" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-894" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≥</span><span class="msubsup" id="MathJax-Span-895" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.727em; height: 0px;"><span style="position: absolute; clip: rect(3.083em, 1000em, 4.185em, -0.492em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-896"><span class="mrow" id="MathJax-Span-897"><span class="msubsup" id="MathJax-Span-898"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-899" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mo" id="MathJax-Span-900" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.781em; left: 1.201em;"><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-902" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-903" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-904" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-905" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-906" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-907" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-908" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-909" style="font-family: STIXGeneral-Regular;">∀</span><span class="mi" id="MathJax-Span-910" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-911" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≠</span><span class="msubsup" id="MathJax-Span-912" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-913" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.623em;"><span class="mo" id="MathJax-Span-914" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.39em; vertical-align: -0.29em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">{w^*}^T \mu(\pi^*) \ge {w^*}^T \mu(\pi) \;\;\; \forall \pi \ne \pi^*</script><p></p>
<p>Finally, (Abel and Ng 2004), if for some policy its distribution of states matches the distribution of states of the expert, formally if <span class="MathJax" id="MathJax-Element-51-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-915" style="width: 9.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.333em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.908em, -0.44em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-916"><span class="texatom" id="MathJax-Span-917"><span class="mrow" id="MathJax-Span-918"><span class="mo" id="MathJax-Span-919" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mo" id="MathJax-Span-922" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-923" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-924" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-925" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-926" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-927" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-928" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">μ</span><span class="mo" id="MathJax-Span-929" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-930"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-931" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-932" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-933" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-934"><span class="mrow" id="MathJax-Span-935"><span class="mo" id="MathJax-Span-936" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-937"><span style="display: inline-block; position: relative; width: 0.694em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-938"><span class="mrow" id="MathJax-Span-939"><span class="mo" id="MathJax-Span-940" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.225em;"><span class="mn" id="MathJax-Span-941" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-942" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mi" id="MathJax-Span-943" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.125em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">||\mu(\pi) - \mu(\pi^*)||_1 \le \epsilon</script>, then for all <span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1121" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">w</script> with <span class="MathJax" id="MathJax-Element-53-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-947" style="width: 4.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.853em, -0.44em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-948"><span class="texatom" id="MathJax-Span-949"><span class="mrow" id="MathJax-Span-950"><span class="mo" id="MathJax-Span-951" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-952"><span class="mrow" id="MathJax-Span-953"><span class="mo" id="MathJax-Span-954" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-955" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-956"><span class="mrow" id="MathJax-Span-957"><span class="mo" id="MathJax-Span-958" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-959"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-960"><span class="mrow" id="MathJax-Span-961"><span class="mo" id="MathJax-Span-962" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.225em;"><span class="mi" id="MathJax-Span-963" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-964" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mn" id="MathJax-Span-965" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.042em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">||w||_\infty \le 1</script>:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" style=""><nobr><span class="math" id="MathJax-Span-966" style="width: 11.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.966em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.49em, 1000em, 2.908em, -0.44em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-967"><span class="texatom" id="MathJax-Span-968"><span class="mrow" id="MathJax-Span-969"><span class="mo" id="MathJax-Span-970" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-971"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-972" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-973" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-974" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-975" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-976" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-977" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-978" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-979" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-980" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-981" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-982" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-983" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-984"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-985" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.623em;"><span class="mo" id="MathJax-Span-986" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-987" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-988"><span class="mrow" id="MathJax-Span-989"><span class="mo" id="MathJax-Span-990" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mo" id="MathJax-Span-991" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mi" id="MathJax-Span-992" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.323em; vertical-align: -0.29em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">|w^T \mu(\pi) - w^T \mu(\pi^*)| \le \epsilon</script><p></p>
<p>We don't know what the real reward policy, but we found the optimal policy, so that's good enough. Finding such a policy that matches state feature distributions with the teacher policy is called <strong>feature matching</strong>.</p>
<p>There are also non-linear analogs.</p>
<h3>Apprenticeship Learning via Inverse RL</h3>
<p>The above ovservation led to the <strong>Apprenticeship Learning Algorithm</strong>. Note that this is not an algo that a lot of people use anymore, most people use deel learning.</p>
<p>You try to find a reward function (a set of weights) such that the teacher policy looks better than every other policy. Still assumes <span class="MathJax" id="MathJax-Element-55-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-993" style="width: 1.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-994"><span class="mi" id="MathJax-Span-995" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-996" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-997" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-998" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">R(s)</script> is linear in <span class="MathJax" id="MathJax-Element-56-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-999" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1000"><span class="mi" id="MathJax-Span-1001" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">s</script>.</p>
<p>Pseudocode:<br>
Initialize policy <span class="MathJax" id="MathJax-Element-57-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1002" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.525em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1003"><span class="msubsup" id="MathJax-Span-1004"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1005" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-1006" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.778em; vertical-align: -0.24em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">\pi_0</script></p>
<p>Iterate over possible policies <span class="MathJax" id="MathJax-Element-58-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1007" style="width: 4.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.054em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.853em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1008"><span class="msubsup" id="MathJax-Span-1009"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1010" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-1011" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1012" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1013" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1014" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-1015" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1016" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1017" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1018" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1019" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.767em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">\pi_1, \pi_2,... </script>:</p>
<ul>
<li>
<p>Find a reward function <span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1121" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">w</script> such that the teacher policy maximally outperforms all previous policies:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-60-Frame" style=""><nobr><span class="math" id="MathJax-Span-1023" style="width: 23.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.89em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.466em, 1000em, 4.358em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1024"><span class="mtable" id="MathJax-Span-1025" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 20.552em; height: 0px;"><span style="position: absolute; clip: rect(2.642em, 1000em, 6.467em, -0.507em); top: -4.505em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -5.691em; right: 0em;"><span class="mtd" id="MathJax-Span-1026"><span class="mrow" id="MathJax-Span-1027"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.548em; right: 0em;"><span class="mtd" id="MathJax-Span-1038"><span class="mrow" id="MathJax-Span-1039"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.205em; right: 0em;"><span class="mtd" id="MathJax-Span-1091"><span class="mrow" id="MathJax-Span-1092"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.505em;"></span></span><span style="position: absolute; clip: rect(2.802em, 1000em, 7.236em, -0.491em); top: -5.124em; left: 0em;"><span style="display: inline-block; position: relative; width: 20.552em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 3.633em, -0.47em); top: -4.227em; left: 0em;"><span class="mtd" id="MathJax-Span-1028"><span class="mrow" id="MathJax-Span-1029"><span class="mi" id="MathJax-Span-1030" style="font-family: STIXGeneral-Regular;">arg</span><span class="mo" id="MathJax-Span-1031"></span><span class="munderover" id="MathJax-Span-1032" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-1033" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.59em, -0.496em); top: -1.624em; left: 0.619em;"><span class="mi" id="MathJax-Span-1034" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1035" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-1036" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.832em, 1000em, 2.723em, -0.493em); top: -1.624em; left: 0.704em;"><span class="mi" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.49em, 1000em, 2.909em, -0.491em); top: -2.084em; left: 0em;"><span class="mtd" id="MathJax-Span-1040"><span class="mrow" id="MathJax-Span-1041"><span class="mi" id="MathJax-Span-1042" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1043" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-1044" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-1045" style="font-family: STIXGeneral-Regular;">.</span><span class="msubsup" id="MathJax-Span-1046" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1047" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-1048" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1049" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-1050" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1051"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1052" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.623em;"><span class="mo" id="MathJax-Span-1053" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1054" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1055" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≥</span><span class="msubsup" id="MathJax-Span-1056" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1057" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1059" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-1060" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1061" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-1062" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1063" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-1064" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mspace" id="MathJax-Span-1065" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1066" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1067" style="font-family: STIXGeneral-Regular;">∀</span><span class="mi" id="MathJax-Span-1068" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-1069" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="texatom" id="MathJax-Span-1070" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-1071"><span class="msubsup" id="MathJax-Span-1072"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1073" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-1074" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1075" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1076" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1077" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-1078" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1079" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1080" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1081" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1082" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1083" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-1084" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1085" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1086"><span class="mrow" id="MathJax-Span-1087"><span class="mi" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-1089" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1090" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.853em, -0.491em); top: -0.741em; left: 0em;"><span class="mtd" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="mi" id="MathJax-Span-1095" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1096" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-1097" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-1098" style="font-family: STIXGeneral-Regular;">.</span><span class="texatom" id="MathJax-Span-1099" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-1100"><span class="mo" id="MathJax-Span-1101" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-1102"><span class="mrow" id="MathJax-Span-1103"><span class="mo" id="MathJax-Span-1104" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-1105" style="font-family: STIXGeneral-Italic;">w</span><span class="texatom" id="MathJax-Span-1106"><span class="mrow" id="MathJax-Span-1107"><span class="mo" id="MathJax-Span-1108" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-1109"><span style="display: inline-block; position: relative; width: 0.694em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-1110"><span class="mrow" id="MathJax-Span-1111"><span class="mo" id="MathJax-Span-1112" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.225em;"><span class="mn" id="MathJax-Span-1113" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1114" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mn" id="MathJax-Span-1115" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.124em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.105em; vertical-align: -2.275em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-60">\begin{align} & \arg \max_w \max_\gamma \\ & s.t. w^T \mu(\pi^*) \ge w^T \mu(\pi) + \gamma \;\; \forall \pi \in {\pi_0, \pi_1,...,\pi_{i-1}} \\ & s.t. ||w||_2 \le 1 \end{align}</script><p></p>
</li>
<li>
<p>Find optimal control policy <span class="MathJax" id="MathJax-Element-61-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1116" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1117"><span class="msubsup" id="MathJax-Span-1118"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1119" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-1120" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">\pi_i</script> for the <span class="MathJax" id="MathJax-Element-62-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1121" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mi" id="MathJax-Span-1123" style="font-family: STIXGeneral-Italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.634em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">w</script> found in previous step. This allows you to get a new <span class="MathJax" id="MathJax-Element-63-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1124" style="width: 2.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.083em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1125"><span class="mi" id="MathJax-Span-1126" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-1127" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1128"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1129" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1131" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">\mu(\pi_i)</script> from the transition model.</p>
</li>
<li>
<p>Exit if a policy has been found that makes <span class="MathJax" id="MathJax-Element-64-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1132" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1133"><span class="mi" id="MathJax-Span-1134" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-1135" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mi" id="MathJax-Span-1136" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span><span class="texatom" id="MathJax-Span-1137"><span class="mrow" id="MathJax-Span-1138"><span class="mo" id="MathJax-Span-1139" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mn" id="MathJax-Span-1140" style="font-family: STIXGeneral-Regular;">2</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.104em; vertical-align: -0.291em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">\gamma \le \epsilon/2</script>.</p>
</li>
</ul>
<p><strong>Issues with Apprenticeship Learning</strong><br>
If expert policy is suboptimal then the resulting policy is a mexture of somewhat arbitrary policies which have expert in the convex hull. It's a bit tricky how to combine these. In practice: pick the best one of this set and pick the corresponding reward function.</p>
<p><strong>Amiguity</strong><br>
There is an infinite number of reward functions with the same optimal policy. Two papers (Appendix 3)</p>
<ul>
<li>Maximum entrope interse reinforcement leanring (Ziebart et al 2008)
<ul>
<li>Pick a reward function that produces the maximum uncertaincy given the teacher policy (make the least commitment, underfit as much as possible). Hugely influential.</li>
</ul>
</li>
<li>Generative Adversarial Imitation Learning aka GAIL (Ho and Ermon 2016 - extension to feature matching using DNNs), since writing down the distrution of <span class="MathJax" id="MathJax-Element-65-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1141" style="width: 2.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1142"><span class="mi" id="MathJax-Span-1143" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-1144" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1145" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-1146" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">\mu(\pi)</script> is hard given a very high dimensional state space (for example, the space of all images). They use a discriminator that can tell between the expert demonstrations and the trajectories generated by an agent. Lots of extensions to this also.</li>
</ul>
<p>If you want to get the actual reward function, you have to take a Bayesian Approach and specify a prior over reward functions, which you will then update with algos. If its not so important what the actual reward function is, you can just use the methods above.</p>
<p><strong>Summary:</strong><br>
Imitation learning can greatly reduce the amount of data needed to learn a good policy. It is really useful practically in industry, Challenges remain and one exciting area is combining inverse RL / learning from demonstration and online reinforcement learning.</p>
<h2>Appendices:</h2>
<p><strong>Appendix 1: Behavorial Cloning</strong><br>
Two notable success stories:<br>
Pomerleau, NIPS 1989 (ALVINN - very early paper about driving on the road.)<br>
Summut et al 1992 Flight Simulator</p>
<p>For behaviorial cloning, analysis of compounding errors<br>
<span class="MathJax" id="MathJax-Element-66-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1147" style="width: 22.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.383em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.507em, 1000em, 2.88em, -0.437em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1148"><span class="texatom" id="MathJax-Span-1149"><span class="mrow" id="MathJax-Span-1150"><span class="mi" id="MathJax-Span-1151" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mo" id="MathJax-Span-1152" style="font-family: STIXGeneral-Regular;">[</span><span class="mtext" id="MathJax-Span-1153" style="font-family: STIXGeneral-Regular;">Total Errors</span><span class="mo" id="MathJax-Span-1154" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-1155" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≤</span><span class="mi" id="MathJax-Span-1156" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span><span class="mo" id="MathJax-Span-1157" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1158" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1159" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-1160" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mi" id="MathJax-Span-1161" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1162" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mn" id="MathJax-Span-1163" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-1164" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1165" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-1166" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋯</span><span class="mo" id="MathJax-Span-1167" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-1168" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span><span class="mo" id="MathJax-Span-1169" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1170" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∝</span><span class="mi" id="MathJax-Span-1171" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ϵ</span><span class="msubsup" id="MathJax-Span-1172"><span style="display: inline-block; position: relative; width: 1.218em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1173" style="font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.749em;"><span class="mn" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.274em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">\mathbb{E}[\text{Total Errors}] \le \epsilon(T+(T-1)+\cdots + 1) \propto \epsilon T^2</script> done in "A rediction of imitation learning and structure prediction to no-rgret online learning, Ross et al 2011"</p>
</div><div class="cell text-cell"><p><img src="resources/54873033874CB614BAAC448165BA340F.png" alt="Screenshot 2020-04-01 at 1.09.04 PM.png"></p><p>Pseudocode for DAGGER (Expert-in-the-loop Data Aggregation):</p><p><img src="resources/04F0B84267C58764EF3E2C1EB01DC888.png" alt="Screenshot 2020-04-01 at 1.12.16 PM.png" width="638" height="475"><br></p><p><br></p><p><b>Appendix 2: Inverse RL: Feature Mapping and Apprenticeship Learning</b></p><p><img src="resources/5B307846073D380053AFA7CC13C5D1B5.png" alt="Screenshot 2020-04-01 at 1.38.59 PM.png" width="638" height="481"><img src="resources/82E5FF0BE96B19CDC849EAFF8FF5EAF1.png" alt="Screenshot 2020-04-01 at 1.54.25 PM.png" width="651" height="482"><br></p><p><b>Appendix 3:</b></p><p><img src="resources/FD6D9D3480EC0E22B5D3010BAAE532DF.png" alt="Screenshot 2020-04-01 at 2.16.50 PM.png" width="640" height="473"><b><br></b></p>
</div><div class="cell text-cell"></div></div>

    </body>
    </html>
  