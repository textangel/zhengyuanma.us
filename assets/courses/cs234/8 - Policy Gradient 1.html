
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS234 - Lecture 8 - Policy Gradient 1</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><h3>Types of RL:</h3>
<p><strong>Value based RL</strong>: Learn a value function, optimal policy is implicit given value function (from <span class="MathJax" id="MathJax-Element-68-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1175" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1176"><span class="mi" id="MathJax-Span-1177" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">\epsilon</script>-greedy).<br>
<strong>Policy Based RL</strong>: Try to learn optimal policy without using value function. Policy is parameterized.<br>
<strong>Actor-Critic RL</strong>: Learn both value function (critic) and policy (actor)<br>
(appendix 1)</p>
<p><strong>Policy Gradients</strong> - Currently the most commonly used methods in RL right now. Used to encode structure (policy calss) to help constrain and speed reinforcement learning.  In this lecture we directly parameterize the policy</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-69-Frame" style=""><nobr><span class="math" id="MathJax-Span-1178" style="width: 8.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.827em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1179"><span class="msubsup" id="MathJax-Span-1180"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1181" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1182"><span class="mrow" id="MathJax-Span-1183"><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1185" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1186" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1187" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1188" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-1189" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1190" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-1191" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-1192"><span class="mi" id="MathJax-Span-1193" style="font-family: STIXGeneral-Regular;">ℙ</span></span></span><span class="mo" id="MathJax-Span-1194" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-1195" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-1196"><span class="mrow" id="MathJax-Span-1197"><span class="mo" id="MathJax-Span-1198" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-1199" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1200" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1201" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1202" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-69">\pi_{\theta}(s,a) = \mathbb{P}[a|s;\theta]</script><br>
Goal is to find a policy <span class="MathJax" id="MathJax-Element-70-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1203" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1204"><span class="mi" id="MathJax-Span-1205" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">\pi</script> with the highest value function <span class="MathJax" id="MathJax-Element-71-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1206" style="width: 1.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.295em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.344em, 1000em, 2.383em, -0.431em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1207"><span class="msubsup" id="MathJax-Span-1208"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1209" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.903em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">V^\pi</script><br>
Common types of differentiable parameterized policies are Goftmax (discreate action spaces), Gaussian, DNNs.<p></p>
<p>Advantages:</p>
<ul>
<li>Its hard to write down an explicit reward funciton. It's easier just to write down a parameterization of the space of policies rather than a parameterization in the space of state-action value functions.</li>
<li>Better conergence properties.</li>
<li>Much more effective in high-dimensional or continuous action spaces</li>
<li>Can learn stochastic policies.<br>
Disadvantages:</li>
<li>Typically converge to a local rather than global optimum</li>
<li>Evaluating a policy is typically inefficient and high variance.</li>
</ul>
<p><strong>Stochastic Policies</strong>:<br>
In a tabular MDP, the optimal policy is deterministic. However, there are two cases where stochastic policies are preferred.</p>
<ol>
<li>In a multi-agent case, the deterministic policy is easily exploited. The best (Nash Equilibrium) strategy is a uniform random strategy.</li>
<li>When we have <strong>aliasing</strong>: two states which cannot be distinguished. This is an example of a <strong>partially-observable</strong> situation, which is not Markov. Then, you might not want a deterministic policy. Even if you cannot distinguish between the two states, you dont want to to the same policy over and over in those states - you want to have different ways you can get out of the states. (Appendix 2)</li>
</ol>
<h2>Policy Objective Functions</h2>
<p>Goal: Given a policy <span class="MathJax" id="MathJax-Element-72-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1211" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1212"><span class="msubsup" id="MathJax-Span-1213"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1214" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1215"><span class="mrow" id="MathJax-Span-1216"><span class="mi" id="MathJax-Span-1217" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1218" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1219" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1220" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1221" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-1222" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">\pi_{\theta}(s,a)</script> with parameters <span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1603" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">\theta</script>, find the best <span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1603" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">\theta</script>.</p>
<p>We measure the quality of a policy <span class="MathJax" id="MathJax-Element-82-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1360" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1361"><span class="msubsup" id="MathJax-Span-1362"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1363" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1364"><span class="mrow" id="MathJax-Span-1365"><span class="mi" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">\pi_{\theta}</script> as follows:</p>
<ul>
<li>In episodic environments we use the <strong>start value</strong> of the policy:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-76-Frame" style=""><nobr><span class="math" id="MathJax-Span-1236" style="width: 7.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.644em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.649em, 1000em, 2.88em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1237"><span class="msubsup" id="MathJax-Span-1238"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1239" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="mn" id="MathJax-Span-1240" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1241" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1242" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1243" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1244" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1245" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1246" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.805em;"><span class="texatom" id="MathJax-Span-1247"><span class="mrow" id="MathJax-Span-1248"><span class="msubsup" id="MathJax-Span-1249"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-1251"><span class="mrow" id="MathJax-Span-1252"><span class="mi" id="MathJax-Span-1253" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1254" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1255"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1256" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-1257" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1258" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.116em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-76">J_1(\theta) = V^{\pi_{\theta}}(s_1)</script></li>
<li>In continuing environments we can use the <strong>average value</strong>.<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" style=""><nobr><span class="math" id="MathJax-Span-1259" style="width: 12.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.923em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 3.962em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1260"><span class="msubsup" id="MathJax-Span-1261"><span style="display: inline-block; position: relative; width: 1.717em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1262" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="texatom" id="MathJax-Span-1263"><span class="mrow" id="MathJax-Span-1264"><span class="mi" id="MathJax-Span-1265" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1266" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mi" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1268" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1269" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1270" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1271" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-1272" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1273" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1275" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.402em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1276" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.621em;"><span class="texatom" id="MathJax-Span-1277"><span class="mrow" id="MathJax-Span-1278"><span class="msubsup" id="MathJax-Span-1279"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1281" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1282" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1283" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1284" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-1285"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1286" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.805em;"><span class="texatom" id="MathJax-Span-1287"><span class="mrow" id="MathJax-Span-1288"><span class="msubsup" id="MathJax-Span-1289"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1290" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1291" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1292" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1293" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1294" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.605em; vertical-align: -1.46em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-77">J_{avV}(\theta) = \sum_s d^{\pi_\theta}(s) V^{\pi_\theta}(s)</script><br>
where <span class="MathJax" id="MathJax-Element-78-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1295" style="width: 2.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.477em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.652em, 1000em, 2.88em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1296"><span class="msubsup" id="MathJax-Span-1297"><span style="display: inline-block; position: relative; width: 1.402em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1298" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.408em; left: 0.621em;"><span class="texatom" id="MathJax-Span-1299"><span class="mrow" id="MathJax-Span-1300"><span class="msubsup" id="MathJax-Span-1301"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1303" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1304" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1305" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1306" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.112em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">d^{\pi_\theta}(s)</script> is the stationary distribution of the Markov chain for <span class="MathJax" id="MathJax-Element-109-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2167" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2168"><span class="msubsup" id="MathJax-Span-2169"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2170" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">\pi_\theta</script>.</li>
<li>Alternately, in continuing environments we can use the <strong>average reward per timestep</strong>:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-80-Frame" style=""><nobr><span class="math" id="MathJax-Span-1312" style="width: 17.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.653em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 3.962em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1313"><span class="msubsup" id="MathJax-Span-1314"><span style="display: inline-block; position: relative; width: 1.717em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1315" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="texatom" id="MathJax-Span-1316"><span class="mrow" id="MathJax-Span-1317"><span class="mi" id="MathJax-Span-1318" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mi" id="MathJax-Span-1320" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1321" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1322" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1323" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1324" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-1325" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1326" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1327" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1328" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.402em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.716em, -0.492em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1329" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.621em;"><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"><span class="msubsup" id="MathJax-Span-1332"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1333" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1334" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1335" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1336" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1337" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-1338" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1339" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.585em, -0.495em); top: -1.159em; left: 0.479em;"><span class="mi" id="MathJax-Span-1340" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1341" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1342" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1343"><span class="mrow" id="MathJax-Span-1344"><span class="mi" id="MathJax-Span-1345" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1346" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1347" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1348" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1349" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-1350" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1351" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1352" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1353" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-1354" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1355" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-1356" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.605em; vertical-align: -1.46em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-80">J_{avR}(\theta) = \sum_s d^{\pi_\theta}(s)\sum_a \pi_{\theta}(s,a)R(s,a)</script><br>
Today we focus on the episodic setting.</li>
</ul>
<h2>Policy optimization</h2>
<p>Find policy parameters <span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1603" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">\theta</script> that optimize the policy <span class="MathJax" id="MathJax-Element-82-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1360" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-1361"><span class="msubsup" id="MathJax-Span-1362"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1363" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1364"><span class="mrow" id="MathJax-Span-1365"><span class="mi" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">\pi_{\theta}</script><br>
<strong>Gradient free optimization</strong></p>
<ul>
<li>Hill climbing, simplex, genetic algorithms, cross-entropy method, covariarance matrix adaptation.</li>
<li>Often a great simple baseline to try, easy to paralleize, can work with non-differentiable policy parameterizations, but are generally not sample efficient (because it ignores temporal structure). (Example in Appendix 3)<br>
<strong>Gradient-based optimization:</strong></li>
<li>Called <strong>Policy gradient</strong> methods (next section)</li>
<li>Gradient Descnet, Conjugate descent, Quasi-Newton (BGFS)</li>
<li>Often leads to greater data efficiency.</li>
</ul>
<h2>Policy Gradient Methods</h2>
<p>In the below section we assume episodic MDPs.<br>
Define <span class="MathJax" id="MathJax-Element-83-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1367" style="width: 5.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.786em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1368"><span class="mi" id="MathJax-Span-1369" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1370" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1371" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1372" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1373" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1374" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.586em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1375" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-1376"><span class="mrow" id="MathJax-Span-1377"><span class="msubsup" id="MathJax-Span-1378"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1380" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.079em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">V(\theta) = V^{\pi_\theta}</script> to make explicit the dependence of the value on the policy parameters.<br>
Policy gradient methods search for a local maximum in <span class="MathJax" id="MathJax-Element-84-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1381" style="width: 2.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1382"><span class="mi" id="MathJax-Span-1383" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1384" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1385" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1386" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">V(\theta)</script> by apploying gradient ascient w.r.t. parameters <span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1603" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">\theta</script> to to the policy gradient:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-86-Frame" style=""><nobr><span class="math" id="MathJax-Span-1390" style="width: 6.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.25em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1391"><span class="mi" id="MathJax-Span-1392" style="font-family: STIXGeneral-Regular;">Δ</span><span class="mi" id="MathJax-Span-1393" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1394" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-1395" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">α</span><span class="msubsup" id="MathJax-Span-1396"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1397" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-1398"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1401" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1402" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1403" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1404" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-86">\Delta \theta = \alpha \nabla_{\theta} V(\theta)</script><p></p>
<p><strong>Numerical gradient (Finite-Differences Gradient):</strong></p>
<ul>
<li>To evaluate policy gradient of <span class="MathJax" id="MathJax-Element-123-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2430" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2431"><span class="msubsup" id="MathJax-Span-2432"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2433" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2434" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2435" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2436" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2437" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2438" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-2439" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-123">\pi_\theta(s,a)</script></li>
<li>For each simension <span class="MathJax" id="MathJax-Element-88-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1415" style="width: 4.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.941em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.859em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1416"><span class="mi" id="MathJax-Span-1417" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mo" id="MathJax-Span-1418" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="mo" id="MathJax-Span-1419" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">[</span><span class="mn" id="MathJax-Span-1420" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-1421" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1422" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-1423" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.056em; vertical-align: -0.236em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">k \in [1,n]</script> compute <span class="MathJax" id="MathJax-Element-89-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1424" style="width: 9.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.502em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.345em, 1000em, 3.209em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1425"><span class="mfrac" id="MathJax-Span-1426"><span style="display: inline-block; position: relative; width: 1.809em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.603em, -0.478em); top: -2.849em; left: 50%; margin-left: -0.845em;"><span class="mrow" id="MathJax-Span-1427"><span class="mi" id="MathJax-Span-1428" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-1429" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1431" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mo" id="MathJax-Span-1432" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.66em, 1000em, 2.589em, -0.478em); top: -1.914em; left: 50%; margin-left: -0.535em;"><span class="mrow" id="MathJax-Span-1433"><span class="mi" id="MathJax-Span-1434" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-1435"><span style="display: inline-block; position: relative; width: 0.719em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1436" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="mi" id="MathJax-Span-1437" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.009em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.809em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-1438" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span><span class="mfrac" id="MathJax-Span-1439" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 4.85em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.603em, -0.453em); top: -2.849em; left: 50%; margin-left: -2.365em;"><span class="mrow" id="MathJax-Span-1440"><span class="mi" id="MathJax-Span-1441" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mo" id="MathJax-Span-1444" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mi" id="MathJax-Span-1445" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϵ</span><span class="msubsup" id="MathJax-Span-1446"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.477em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1447" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">u</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.394em;"><span class="mi" id="MathJax-Span-1448" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.009em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-1449" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1450" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-1451" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1452" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1453" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mo" id="MathJax-Span-1454" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.486em); top: -1.964em; left: 50%; margin-left: -0.169em;"><span class="mi" id="MathJax-Span-1455" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ϵ</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 4.85em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.82em; vertical-align: -0.625em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">\frac{\partial V(\theta)}{\partial \theta_k} \approx \frac{V(\theta+\epsilon u_k) - V(\theta)}{\epsilon}</script>.<br>
Uses <span class="MathJax" id="MathJax-Element-91-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1459" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1460"><span class="mi" id="MathJax-Span-1461" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">n</script> evlaluations to compute policy gradient in <span class="MathJax" id="MathJax-Element-91-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1459" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1460"><span class="mi" id="MathJax-Span-1461" style="font-family: STIXGeneral-Italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">n</script> dimensions<br>
Simple, noisy, inefficient, but sometimes effective, and works for arbitrary policies. (Although can be very data efficient if the policy space is tightly defined - Example in Appendix 3)</li>
</ul>
<p><strong>Analytical Gradient Methods (Likelihood Ratio):</strong><br>
Most techniques compute the policy gradient analytically.</p>
<p>Denote a state-action trajectory as <span class="MathJax" id="MathJax-Element-92-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1462" style="width: 16.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.977em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1463"><span class="mi" id="MathJax-Span-1464" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1465" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-1466" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-1467"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1468" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-1469" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1470" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1471" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1472" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-1473" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1474" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1475" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1476" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-1477" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1478" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-1479" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1480" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1481" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-1482" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">,</span><span class="msubsup" id="MathJax-Span-1483" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.877em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1484" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-1485"><span class="mrow" id="MathJax-Span-1486"><span class="mi" id="MathJax-Span-1487" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1488" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1490" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1491" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.989em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1492" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-1493"><span class="mrow" id="MathJax-Span-1494"><span class="mi" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1498" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1499" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1500" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-1501"><span class="mrow" id="MathJax-Span-1502"><span class="mi" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1504" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1505" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1506" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">\tau = (s_0,a_0,r_0,...,s_{T-1}, a_{T-1}, r_{T-1})</script>, and use <span class="MathJax" id="MathJax-Element-93-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1507" style="width: 9.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.896em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.415em, 1000em, 3.009em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1508"><span class="mi" id="MathJax-Span-1509" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1510" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1511" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1512" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1513" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-1514" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-1515" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.797em; left: 0.957em;"><span class="mi" id="MathJax-Span-1516" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.487em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-1517"><span class="mrow" id="MathJax-Span-1518"><span class="mi" id="MathJax-Span-1519" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-1520" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-1521" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1522" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-1523" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1524"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1525" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-1526" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1527" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1528" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1529" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-1530" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1531" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.519em; vertical-align: -0.402em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">R(\tau) = \sum_{t=0}^TR(S_t,a_t)</script> to be the sum of rewards for a trajectory <span class="MathJax" id="MathJax-Element-94-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1532" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1533"><span class="mi" id="MathJax-Span-1534" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.612em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">\tau</script>.<br>
Then the policy value is <span class="MathJax" id="MathJax-Element-95-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1535" style="width: 22.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.27em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.15em, 1000em, 4.332em, -0.431em); top: -3.491em; left: 0em;"><span class="mrow" id="MathJax-Span-1536"><span class="mi" id="MathJax-Span-1537" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1538" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1539" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1540" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1541" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-1542" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-1543"><span class="mrow" id="MathJax-Span-1544"><span class="mi" id="MathJax-Span-1545" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-1546"><span class="mrow" id="MathJax-Span-1547"><span class="msubsup" id="MathJax-Span-1548"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1549" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1550" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1551" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-1552" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">[</span></span><span class="munderover" id="MathJax-Span-1553"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-1554" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.465em); top: -2.797em; left: 0.957em;"><span class="mi" id="MathJax-Span-1555" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.487em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-1556"><span class="mrow" id="MathJax-Span-1557"><span class="mi" id="MathJax-Span-1558" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-1559" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-1560" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1561" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-1562" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1563"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1564" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1566" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-1567" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1568" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-1569" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1570" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1571" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1572" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mi" id="MathJax-Span-1573" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1574" style="vertical-align: -0.393em;"><span style="font-family: STIXSizeTwoSym;">]</span></span></span><span class="mo" id="MathJax-Span-1575" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-1576" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.37em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-1577" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="mi" id="MathJax-Span-1578" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1579" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1580" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1581" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1582" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1583" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1584" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1585" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1586" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1587" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1588" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 3.491em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.173em; vertical-align: -0.809em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">V(\theta) = \mathbb{E}_{\pi_\theta} \left[\sum_{t=0}^T R(s_t,a_t) ; \pi \theta \right] = \sum_\tau P(\tau ; \theta) R(\tau)</script> (the expected sum of rewards given this policy), where <span class="MathJax" id="MathJax-Element-96-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1589" style="width: 3.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.703em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1590"><span class="mi" id="MathJax-Span-1591" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1592" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1593" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1594" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-1595" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1596" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">P(\tau, \theta)</script> denotes the probabilities over trajectories when executing policy <span class="MathJax" id="MathJax-Element-97-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1597" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1598"><span class="mi" id="MathJax-Span-1599" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-1600" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1601" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1602" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">\pi(\theta)</script>.<br>
In this new notation, our goal is to find the policy parameters <span class="MathJax" id="MathJax-Element-98-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1603" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">\theta</script> s.t.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-99-Frame" style=""><nobr><span class="math" id="MathJax-Span-1606" style="width: 17.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.991em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 3.96em, -0.47em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1607"><span class="mi" id="MathJax-Span-1608" style="font-family: STIXGeneral-Regular;">arg</span><span class="mo" id="MathJax-Span-1609"></span><span class="munderover" id="MathJax-Span-1610" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-1611" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.66em, 1000em, 2.585em, -0.488em); top: -1.624em; left: 0.676em;"><span class="mi" id="MathJax-Span-1612" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1613" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1614" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1615" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1616" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1617" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-1618" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">arg</span><span class="mo" id="MathJax-Span-1619"></span><span class="munderover" id="MathJax-Span-1620" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-1621" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.66em, 1000em, 2.585em, -0.488em); top: -1.624em; left: 0.676em;"><span class="mi" id="MathJax-Span-1622" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1623" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1624" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.585em, -0.498em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1625" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1626" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1627" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1628" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1629" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1630" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1631" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1632" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1633" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1634" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1635" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.603em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">\arg \max_\theta V(\theta) = \arg \max_\theta \sum_\tau P(\tau ; \theta) R(\tau)</script><p></p>
<p>The gradient is:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-100-Frame" style=""><nobr><span class="math" id="MathJax-Span-1636" style="width: 100%; display: inline-block; min-width: 22.068em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 22.068em;"><span style="position: absolute; clip: rect(9.17em, 1000em, 26.704em, -0.507em); top: -18.187em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1637"><span class="mtable" id="MathJax-Span-1638" style="min-width: 22.068em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 22.068em;"><span style="display: inline-block; position: absolute; width: 16.104em; height: 0px; clip: rect(-9.017em, 1000em, 8.517em, -0.507em); top: 0em; left: 50%; margin-left: -8.052em;"><span style="position: absolute; clip: rect(8.898em, 1000em, 26.048em, -0.507em); top: -17.793em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.444em); top: -10.582em; right: 0em;"><span class="mtd" id="MathJax-Span-1639"><span class="mrow" id="MathJax-Span-1640"><span class="msubsup" id="MathJax-Span-1641"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1642" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1643" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1644" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1645" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1646" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1647" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -10.472em; right: 0em;"><span class="mtd" id="MathJax-Span-1671"><span class="mrow" id="MathJax-Span-1672"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -7.901em; right: 0em;"><span class="mtd" id="MathJax-Span-1692"><span class="mrow" id="MathJax-Span-1693"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -4.952em; right: 0em;"><span class="mtd" id="MathJax-Span-1713"><span class="mrow" id="MathJax-Span-1714"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.002em; right: 0em;"><span class="mtd" id="MathJax-Span-1749"><span class="mrow" id="MathJax-Span-1750"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: 1.693em; right: 0em;"><span class="mtd" id="MathJax-Span-1789"><span class="mrow" id="MathJax-Span-1790"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: 4.089em; right: 0em;"><span class="mtd" id="MathJax-Span-1821"><span class="mrow" id="MathJax-Span-1822"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 17.793em;"></span></span><span style="position: absolute; clip: rect(9.182em, 1000em, 26.591em, -0.209em); top: -18.074em; left: 3.153em;"><span style="display: inline-block; position: relative; width: 12.95em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.964em, -0.209em); top: -10.582em; left: 0em;"><span class="mtd" id="MathJax-Span-1648"><span class="mrow" id="MathJax-Span-1649"><span class="mo" id="MathJax-Span-1650" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-1651"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1652" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1653" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1654"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-1655"><span class="mrow" id="MathJax-Span-1656"><span class="mi" id="MathJax-Span-1657" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-1658"><span class="mrow" id="MathJax-Span-1659"><span class="mi" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-1661" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-1662"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1663" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1664" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1665" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-1666" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1667" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1668" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1669" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1670" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.39em, 1000em, 3.96em, -0.209em); top: -9.008em; left: 0em;"><span class="mtd" id="MathJax-Span-1673"><span class="mrow" id="MathJax-Span-1674"><span class="mo" id="MathJax-Span-1675" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-1676"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1677" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1678" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1679" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1680" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.585em, -0.498em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1681" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1682" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1683" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1684" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1685" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1686" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1687" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1688" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1689" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1690" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1691" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.39em, 1000em, 3.96em, -0.209em); top: -6.437em; left: 0em;"><span class="mtd" id="MathJax-Span-1694"><span class="mrow" id="MathJax-Span-1695"><span class="mo" id="MathJax-Span-1696" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-1697"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1698" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.585em, -0.498em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1700" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1701" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1702" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1703" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1704" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1705" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1706" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1707" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1708" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1709" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1710" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1711" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1712" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.01em, 1000em, 3.96em, -0.209em); top: -3.488em; left: 0em;"><span class="mtd" id="MathJax-Span-1715"><span class="mrow" id="MathJax-Span-1716"><span class="mo" id="MathJax-Span-1717" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-1718"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1719" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.585em, -0.498em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1720" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-1721" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.823em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.507em); top: -3.21em; left: 50%; margin-left: -1.351em;"><span class="mrow" id="MathJax-Span-1722"><span class="mi" id="MathJax-Span-1723" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1724" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1725" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1726" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1727" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1728" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.507em); top: -1.848em; left: 50%; margin-left: -1.351em;"><span class="mrow" id="MathJax-Span-1729"><span class="mi" id="MathJax-Span-1730" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1731" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1732" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1733" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1734" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1735" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.823em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1736" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1737" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1738" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1739" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1740" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1741" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1742" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1743" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1744" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1745" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1746" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1747" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1748" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.01em, 1000em, 5.085em, -0.209em); top: -0.538em; left: 0em;"><span class="mtd" id="MathJax-Span-1751"><span class="mrow" id="MathJax-Span-1752"><span class="mo" id="MathJax-Span-1753" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-1754"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1755" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.585em, -0.498em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1756" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1757" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1758" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1759" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1760" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1761" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1762" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1763" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1764" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1765" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1766" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-1767"><span style="display: inline-block; position: relative; width: 4.505em; height: 0px;"><span style="position: absolute; clip: rect(2.474em, 1000em, 5.83em, -0.507em); top: -3.998em; left: 0.066em;"><span class="munderover" id="MathJax-Span-1768"><span style="display: inline-block; position: relative; width: 4.373em; height: 0px;"><span style="position: absolute; clip: rect(2.474em, 1000em, 5.03em, -0.507em); top: -3.998em; left: 0.007em;"><span class="mfrac" id="MathJax-Span-1769"><span style="display: inline-block; position: relative; width: 4.118em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.444em); top: -3.21em; left: 50%; margin-left: -1.999em;"><span class="mrow" id="MathJax-Span-1770"><span class="msubsup" id="MathJax-Span-1771"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1772" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1773" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1774" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1775" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1776" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1777" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1778" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1779" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.507em); top: -1.848em; left: 50%; margin-left: -1.351em;"><span class="mrow" id="MathJax-Span-1780"><span class="mi" id="MathJax-Span-1781" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1782" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1783" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1784" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1785" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1786" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 4.118em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.183em, 1000em, 3.227em, -0.507em); top: -1.394em; left: 0em;"><span class="mo" id="MathJax-Span-1787" style=""><span style="display: inline-block; position: relative; width: 4.373em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.025em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 3.451em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 1.258em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 0.766em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 2.959em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.585em, -0.507em); top: -0.033em; left: 0em;"><span class="mtext" id="MathJax-Span-1788" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">likelihood ratio</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.39em, 1000em, 3.96em, -0.209em); top: 3.157em; left: 0em;"><span class="mtd" id="MathJax-Span-1791"><span class="mrow" id="MathJax-Span-1792"><span class="mo" id="MathJax-Span-1793" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-1794"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1795" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.585em, -0.498em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-1796" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1797" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1798" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1799" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1800" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1801" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1802" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-1803" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1804" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1805" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1806" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-1807"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1808" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1809" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1810" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-1811"></span><span class="mi" id="MathJax-Span-1812" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1813" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1814" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1815" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1816" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1817" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.964em, -0.209em); top: 5.553em; left: 0em;"><span class="mtd" id="MathJax-Span-1823"><span class="mrow" id="MathJax-Span-1824"><span class="mo" id="MathJax-Span-1825" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-1826"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-1827"><span class="mrow" id="MathJax-Span-1828"><span class="mi" id="MathJax-Span-1829" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-1830"><span class="mrow" id="MathJax-Span-1831"><span class="mi" id="MathJax-Span-1832" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-1833" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-1834"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-1835" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-1836" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1837" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-1838" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-1839" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1840" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1841" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-1842"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1843" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1844" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1845" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-1846"></span><span class="mi" id="MathJax-Span-1847" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1848" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1849" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1850" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1851" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1852" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1853" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 18.074em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(7.241em, 1000em, 8.432em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: 5.553em; right: 0em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-1819"><span class="mtext" id="MathJax-Span-1820" style="font-family: STIXGeneral-Regular;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 18.187em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 19.212em; vertical-align: -9.329em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-100">\begin{align*}   \nabla_\theta V(\theta) & = \nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta} [R(\tau)] \\                       & = \nabla_\theta \sum_\tau P(\tau ; \theta) R(\tau) \\                        & =\sum_\tau \nabla_\theta P(\tau ; \theta) R(\tau) \\                        & =\sum_\tau \frac{P(\tau ; \theta)}{P(\tau ; \theta)} \nabla_\theta P(\tau ; \theta) R(\tau) \\                         & =\sum_\tau P(\tau ; \theta)R(\tau) \underbrace{\frac{\nabla_\theta P(\tau ; \theta) }{P(\tau ; \theta)}}_\text{likelihood ratio}\\                         & =\sum_\tau P(\tau ; \theta)R(\tau) \nabla_\theta \log P(\tau ; \theta) \\                           & = \mathbb{E}_{\tau \sim \pi_\theta} [R(\tau) \nabla_\theta \log P(\tau ; \theta)]  \tag{1}  \end{align*}</script><br>
(See CS231N Lecture 12)<p></p>
<p>Typically, we take <span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2164" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2165"><span class="mi" id="MathJax-Span-2166" style="font-family: STIXGeneral-Italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">m</script> Monte-Carlo sample paths under policy <span class="MathJax" id="MathJax-Element-109-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2167" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2168"><span class="msubsup" id="MathJax-Span-2169"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2170" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">\pi_\theta</script> (notice that the sampling takes out the probability <span class="MathJax" id="MathJax-Element-103-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1862" style="width: 3.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.703em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1863"><span class="mi" id="MathJax-Span-1864" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-1865" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1866" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1867" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1868" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1869" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">P(\tau ; \theta)</script>. This is called <strong>Policy Gradient with Monte Carlo Returns</strong>:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-104-Frame" style=""><nobr><span class="math" id="MathJax-Span-1870" style="width: 20.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.468em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.753em, 1000em, 3.96em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1871"><span class="msubsup" id="MathJax-Span-1872"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1873" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1874" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1875" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-1876" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1877" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1878" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-1879" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-1880" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-1881"><span class="munderover" id="MathJax-Span-1882"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.499em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1883" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.098em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1884" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1885" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-1886" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="mn" id="MathJax-Span-1887" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-1888"><span class="mrow" id="MathJax-Span-1889"><span class="mo" id="MathJax-Span-1890" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-1891" style="font-family: STIXGeneral-Italic;">m</span><span class="mo" id="MathJax-Span-1892" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-1893" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1894" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-1895"><span class="mrow" id="MathJax-Span-1896"><span class="mi" id="MathJax-Span-1897" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-1898" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-1899" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.498em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-1900" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1901" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-1902" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1903"><span style="display: inline-block; position: relative; width: 1.312em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1904" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.505em;"><span class="texatom" id="MathJax-Span-1905"><span class="mrow" id="MathJax-Span-1906"><span class="mo" id="MathJax-Span-1907" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1908" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-1909" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1910" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-1911"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1912" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1913" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1914" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-1915"></span><span class="mi" id="MathJax-Span-1916" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1917" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1918" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1919" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1920" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1921" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.31em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-104">\nabla_\theta V(\theta) = \hat g = (1/m) \sum_{i=1}^m R(\tau^{(i)}) \nabla_\theta \log P(\tau ; \theta)</script><p></p>
<p>The last term </p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-105-Frame" style=""><nobr><span class="math" id="MathJax-Span-1922" style="width: 6.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.631em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-1923"><span class="msubsup" id="MathJax-Span-1924"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1925" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1926" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1927" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-1928"></span><span class="mi" id="MathJax-Span-1929" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1930" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1931" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1932" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1933" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1934" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.125em; vertical-align: -0.304em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-105">\nabla_\theta \log P(\tau ; \theta)</script> seems difficult to compute, but<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-106-Frame" style=""><nobr><span class="math" id="MathJax-Span-1935" style="width: 100%; display: inline-block; min-width: 34.906em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 34.906em;"><span style="position: absolute; clip: rect(6.392em, 1000em, 18.333em, -0.507em); top: -12.613em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-1936"><span class="mtable" id="MathJax-Span-1937" style="min-width: 34.906em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 34.906em;"><span style="display: inline-block; position: absolute; width: 28.941em; height: 0px; clip: rect(-6.221em, 1000em, 5.721em, -0.507em); top: 0em; left: 50%; margin-left: -14.471em;"><span style="position: absolute; clip: rect(4.507em, 1000em, 12.902em, -0.507em); top: -9.065em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.631em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -6.24em; right: 0em;"><span class="mtd" id="MathJax-Span-1938"><span class="mrow" id="MathJax-Span-1939"><span class="msubsup" id="MathJax-Span-1940"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1941" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1942" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1943" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-1944"></span><span class="mi" id="MathJax-Span-1945" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-1946" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-1947" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-1948" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-1949" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-1950" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.733em; right: 0em;"><span class="mtd" id="MathJax-Span-2028"><span class="mrow" id="MathJax-Span-2029"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -0.33em; right: 0em;"><span class="mtd" id="MathJax-Span-2102"><span class="mrow" id="MathJax-Span-2103"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 9.065em;"></span></span><span style="position: absolute; clip: rect(6.392em, 1000em, 18.333em, -0.209em); top: -12.613em; left: 5.631em;"><span style="display: inline-block; position: relative; width: 23.311em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 6.744em, -0.209em); top: -8.436em; left: 0em;"><span class="mtd" id="MathJax-Span-1951"><span class="mrow" id="MathJax-Span-1952"><span class="mo" id="MathJax-Span-1953" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-1954"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1955" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-1956" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-1957" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mrow" id="MathJax-Span-1958" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-1959" style="vertical-align: 2.346em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.124em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.518em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.72em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.922em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1960"><span style="display: inline-block; position: relative; width: 5.349em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 4.839em, -0.507em); top: -3.998em; left: 1.511em;"><span class="munderover" id="MathJax-Span-1961"><span style="display: inline-block; position: relative; width: 2.328em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0.094em;"><span class="mrow" id="MathJax-Span-1962"><span class="mi" id="MathJax-Span-1963" style="font-family: STIXGeneral-Italic;">μ</span><span class="mo" id="MathJax-Span-1964" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1965"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1966" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-1967" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1968" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.528em, 1000em, 2.131em, -0.507em); top: -1.289em; left: 0em;"><span class="mo" id="MathJax-Span-1969" style=""><span style="font-family: STIXSizeFourSym;">⏟</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.585em, -0.507em); top: -0.961em; left: 0em;"><span class="mtext" id="MathJax-Span-1970" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">initial state distrib</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1971" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.629em, -0.457em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-1972" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∏</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.158em; left: 0.141em;"><span class="texatom" id="MathJax-Span-1973"><span class="mrow" id="MathJax-Span-1974"><span class="mi" id="MathJax-Span-1975" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-1976" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-1977" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0.028em;"><span class="texatom" id="MathJax-Span-1978"><span class="mrow" id="MathJax-Span-1979"><span class="mi" id="MathJax-Span-1980" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-1981" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-1982" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1983" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 5.144em, -0.507em); top: -3.998em; left: 0em;"><span class="munderover" id="MathJax-Span-1984"><span style="display: inline-block; position: relative; width: 3.505em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0.007em;"><span class="mrow" id="MathJax-Span-1985"><span class="msubsup" id="MathJax-Span-1986"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1987" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-1988" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1989" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-1990"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1991" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1993"><span class="mrow" id="MathJax-Span-1994"><span class="mo" id="MathJax-Span-1995" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-1996"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-1997" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-1998" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-1999" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(2.183em, 1000em, 3.227em, -0.507em); top: -2.08em; left: 0em;"><span class="mo" id="MathJax-Span-2000" style=""><span style="display: inline-block; position: relative; width: 3.505em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.025em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 2.583em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.823em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.732em, -0.507em); top: -0.719em; left: 0.823em;"><span class="mtext" id="MathJax-Span-2001" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">policy</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2002"><span style="display: inline-block; position: relative; width: 5.251em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 5.146em, -0.507em); top: -3.998em; left: 0em;"><span class="munderover" id="MathJax-Span-2003"><span style="display: inline-block; position: relative; width: 5.251em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.882em, -0.507em); top: -2.534em; left: 0.007em;"><span class="mrow" id="MathJax-Span-2004"><span class="mi" id="MathJax-Span-2005" style="font-family: STIXGeneral-Italic;">P</span><span class="mo" id="MathJax-Span-2006" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2007"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2008" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-2009"><span class="mrow" id="MathJax-Span-2010"><span class="mi" id="MathJax-Span-2011" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2012" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2013" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2014"><span class="mrow" id="MathJax-Span-2015"><span class="mo" id="MathJax-Span-2016" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2017"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2018" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2019" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2020" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2021" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2022" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2023" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2024" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(2.183em, 1000em, 3.227em, -0.507em); top: -2.078em; left: 0em;"><span class="mo" id="MathJax-Span-2025" style=""><span style="display: inline-block; position: relative; width: 5.251em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.025em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 4.329em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 1.697em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 0.748em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 1.223em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 3.381em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 3.855em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.732em, -0.507em); top: -0.717em; left: 0.205em;"><span class="mtext" id="MathJax-Span-2026" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">dynamics model</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2027" style="vertical-align: 2.346em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -0.124em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.518em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.72em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -0.922em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.73em;"></span></span><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.209em); top: -3.846em; left: 0em;"><span class="mtd" id="MathJax-Span-2030"><span class="mrow" id="MathJax-Span-2031"><span class="mo" id="MathJax-Span-2032" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-2033"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2034" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2035" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2036" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2037" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="mi" id="MathJax-Span-2038" style="font-family: STIXGeneral-Regular;">log</span><span class="mo" id="MathJax-Span-2039"></span><span class="mi" id="MathJax-Span-2040" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">μ</span><span class="mo" id="MathJax-Span-2041" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2042"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2043" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-2044" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2045" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2046" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-2047" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2048" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2049"><span class="mrow" id="MathJax-Span-2050"><span class="mi" id="MathJax-Span-2051" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2052" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2053" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2054"><span class="mrow" id="MathJax-Span-2055"><span class="mi" id="MathJax-Span-2056" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2057" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2058" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2059" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2060"></span><span class="msubsup" id="MathJax-Span-2061" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2062" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2063" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2064" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2065"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2066" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2067" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2068"><span class="mrow" id="MathJax-Span-2069"><span class="mo" id="MathJax-Span-2070" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2071"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2072" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2073" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2074" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2075" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-2076" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">log</span><span class="mo" id="MathJax-Span-2077"></span><span class="mi" id="MathJax-Span-2078" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-2079" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2080"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2081" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-2082"><span class="mrow" id="MathJax-Span-2083"><span class="mi" id="MathJax-Span-2084" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2085" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-2086" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2087"><span class="mrow" id="MathJax-Span-2088"><span class="mo" id="MathJax-Span-2089" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2090"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2091" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2092" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2093" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-2094" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2095" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2096" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2097" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2098" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span><span style="position: absolute; clip: rect(0.587em, 1000em, 4.587em, -0.209em); top: 1.134em; left: 0em;"><span class="mtd" id="MathJax-Span-2104"><span class="mrow" id="MathJax-Span-2105"><span class="mo" id="MathJax-Span-2106" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-2107"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2108" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2109"><span class="mrow" id="MathJax-Span-2110"><span class="mi" id="MathJax-Span-2111" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2112" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2113" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2114"><span class="mrow" id="MathJax-Span-2115"><span class="mi" id="MathJax-Span-2116" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2117" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2118" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2119" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 8.615em; height: 0px;"><span style="position: absolute; clip: rect(3.146em, 1000em, 5.185em, -0.507em); top: -3.998em; left: 1.09em;"><span class="munderover" id="MathJax-Span-2120"><span style="display: inline-block; position: relative; width: 6.434em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -2.534em; left: 0.008em;"><span class="mrow" id="MathJax-Span-2121"><span class="msubsup" id="MathJax-Span-2122"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2123" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2125" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2126"></span><span class="msubsup" id="MathJax-Span-2127" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2128" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2129" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2130" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2131"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2132" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2133" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2134"><span class="mrow" id="MathJax-Span-2135"><span class="mo" id="MathJax-Span-2136" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2137"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2138" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2139" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2140" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(2.183em, 1000em, 3.227em, -0.507em); top: -2.039em; left: 0em;"><span class="mo" id="MathJax-Span-2141" style=""><span style="display: inline-block; position: relative; width: 6.434em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.025em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 5.512em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 2.288em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 0.778em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 1.281em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 1.785em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 4.001em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 4.505em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 5.008em;"><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.732em, -0.507em); top: -0.678em; left: 0em;"><span class="mtext" id="MathJax-Span-2142" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">no dynamics model required!</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 12.613em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(2.822em, 1000em, 4.013em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: 1.134em; right: 0em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-2100"><span class="mtext" id="MathJax-Span-2101" style="font-family: STIXGeneral-Regular;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 12.613em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 13.005em; vertical-align: -6.225em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-106">\begin{align} \nabla_\theta \log P(\tau ; \theta) & = \nabla_\theta \log \left[ \underbrace{\mu(s_0)}_\text{initial state distrib} \prod_{t=0}^{T-1} \underbrace{\pi_\theta(a_t|s_t)}_\text{policy} \underbrace{P(s_{t+1}|s_t,a_t)}_\text{dynamics model} \right] \\                                     & = \nabla_\theta \left[ \log \mu(s_0) + \sum_{t=0}^{T-1} \log \pi_\theta(a_t|s_t) + \log P(s_{t+1}|s_t,a_t)  \right] \\                                     & =  \sum_{t=0}^{T-1} \underbrace{\nabla_\theta \log \pi_\theta(a_t|s_t)}_\text{no dynamics model required!}  \tag{2}  \end{align}</script><br>
The term <span class="MathJax" id="MathJax-Element-107-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2143" style="width: 7.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.419em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2144"><span class="msubsup" id="MathJax-Span-2145"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2146" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2147" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2148" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2149"></span><span class="msubsup" id="MathJax-Span-2150" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2151" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2153" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2154"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2155" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2156" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2157"><span class="mrow" id="MathJax-Span-2158"><span class="mo" id="MathJax-Span-2159" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2160"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2161" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2162" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2163" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.125em; vertical-align: -0.304em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">\nabla_\theta \log \pi_\theta(a_t|s_t)</script> in the sum is often called the <strong>score function</strong>. Note that it is summed per step.<p></p>
<p>Putting this together, in summary, we approximate with empirical estimate for <span class="MathJax" id="MathJax-Element-108-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2164" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2165"><span class="mi" id="MathJax-Span-2166" style="font-family: STIXGeneral-Italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.625em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">m</script> sample paths under policy <span class="MathJax" id="MathJax-Element-109-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2167" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2168"><span class="msubsup" id="MathJax-Span-2169"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2170" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">\pi_\theta</script> using the score function<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-110-Frame" style=""><nobr><span class="math" id="MathJax-Span-2172" style="width: 100%; display: inline-block; min-width: 26.123em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 26.123em;"><span style="position: absolute; clip: rect(3.722em, 1000em, 10.305em, -0.507em); top: -7.264em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2173"><span class="mtable" id="MathJax-Span-2174" style="min-width: 26.123em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 26.123em;"><span style="display: inline-block; position: absolute; width: 20.158em; height: 0px; clip: rect(-3.541em, 1000em, 3.041em, -0.507em); top: 0em; left: 50%; margin-left: -10.079em;"><span style="position: absolute; clip: rect(2.46em, 1000em, 6.849em, -0.507em); top: -5.068em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.153em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.444em); top: -4.294em; right: 0em;"><span class="mtd" id="MathJax-Span-2175"><span class="mrow" id="MathJax-Span-2176"><span class="msubsup" id="MathJax-Span-2177"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2178" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2179" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2180" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-2181" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2182" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2183" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.385em; right: 0em;"><span class="mtd" id="MathJax-Span-2232"><span class="mrow" id="MathJax-Span-2233"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.068em;"></span></span><span style="position: absolute; clip: rect(3.722em, 1000em, 10.305em, -0.209em); top: -7.264em; left: 3.153em;"><span style="display: inline-block; position: relative; width: 17.005em; height: 0px;"><span style="position: absolute; clip: rect(0.753em, 1000em, 3.96em, -0.209em); top: -4.294em; left: 0em;"><span class="mtd" id="MathJax-Span-2184"><span class="mrow" id="MathJax-Span-2185"><span class="mo" id="MathJax-Span-2186" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="texatom" id="MathJax-Span-2187"><span class="mrow" id="MathJax-Span-2188"><span class="munderover" id="MathJax-Span-2189"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.499em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2190" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.098em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2191" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-2192" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-2193" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="mn" id="MathJax-Span-2194" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-2195"><span class="mrow" id="MathJax-Span-2196"><span class="mo" id="MathJax-Span-2197" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-2198" style="font-family: STIXGeneral-Italic;">m</span><span class="mo" id="MathJax-Span-2199" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2200" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2201" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2202"><span class="mrow" id="MathJax-Span-2203"><span class="mi" id="MathJax-Span-2204" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2205" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2206" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.498em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-2207" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2208" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-2209" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2210"><span style="display: inline-block; position: relative; width: 1.312em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2211" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.505em;"><span class="texatom" id="MathJax-Span-2212"><span class="mrow" id="MathJax-Span-2213"><span class="mo" id="MathJax-Span-2214" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2215" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2216" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2217" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-2218"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2219" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2220" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2221" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2222"></span><span class="mi" id="MathJax-Span-2223" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-2224" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2225" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2226" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2227" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2228" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.587em, 1000em, 3.963em, -0.209em); top: -0.921em; left: 0em;"><span class="mtd" id="MathJax-Span-2234"><span class="mrow" id="MathJax-Span-2235"><span class="mo" id="MathJax-Span-2236" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="mo" id="MathJax-Span-2237" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-2238" style="font-family: STIXGeneral-Regular;">1</span><span class="texatom" id="MathJax-Span-2239"><span class="mrow" id="MathJax-Span-2240"><span class="mo" id="MathJax-Span-2241" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-2242" style="font-family: STIXGeneral-Italic;">m</span><span class="mo" id="MathJax-Span-2243" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2244" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2245" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2246"><span class="mrow" id="MathJax-Span-2247"><span class="mi" id="MathJax-Span-2248" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2249" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2250" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.498em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-2251" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2252" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-2253" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2254"><span style="display: inline-block; position: relative; width: 1.312em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2255" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.505em;"><span class="texatom" id="MathJax-Span-2256"><span class="mrow" id="MathJax-Span-2257"><span class="mo" id="MathJax-Span-2258" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2259" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2260" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2261" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2262" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2263" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2264"><span class="mrow" id="MathJax-Span-2265"><span class="mi" id="MathJax-Span-2266" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2267" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2268" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2269"><span class="mrow" id="MathJax-Span-2270"><span class="mi" id="MathJax-Span-2271" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2272" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2273" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2274" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2275" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2276" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2277" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2278"></span><span class="msubsup" id="MathJax-Span-2279" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2280" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2281" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2282" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2283"><span style="display: inline-block; position: relative; width: 1.37em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2284" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.563em;"><span class="texatom" id="MathJax-Span-2285"><span class="mrow" id="MathJax-Span-2286"><span class="mo" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2289" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.563em;"><span class="mi" id="MathJax-Span-2290" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2291"><span class="mrow" id="MathJax-Span-2292"><span class="mo" id="MathJax-Span-2293" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2294"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2295" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.45em;"><span class="texatom" id="MathJax-Span-2296"><span class="mrow" id="MathJax-Span-2297"><span class="mo" id="MathJax-Span-2298" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2299" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2300" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.45em;"><span class="mi" id="MathJax-Span-2301" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2302" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.264em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(0.768em, 1000em, 1.959em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -0.921em; right: 0em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-2230"><span class="mtext" id="MathJax-Span-2231" style="font-family: STIXGeneral-Regular;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.264em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 7.057em; vertical-align: -3.251em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-110">\begin{align} \nabla_\theta V(\theta) & = \hat g = (1/m) \sum_{i=1}^m R(\tau^{(i)}) \nabla_\theta \log P(\tau ; \theta) \\                         & = (1/m) \sum_{i=1}^m R(\tau^{(i)}) \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t^{(i)}|s_t^{(i)}) \tag{3} \end{align}</script><br>
That is, sample M Monte Carlo trajectories, compute the average over those trajectories, the total reward of each trajectory <span class="MathJax" id="MathJax-Element-111-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2303" style="width: 2.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.646em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.524em, 1000em, 2.88em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2304"><span class="mi" id="MathJax-Span-2305" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-2306" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2307"><span style="display: inline-block; position: relative; width: 1.312em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2308" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.505em;"><span class="texatom" id="MathJax-Span-2309"><span class="mrow" id="MathJax-Span-2310"><span class="mo" id="MathJax-Span-2311" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2312" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2313" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2314" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.255em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">R(\tau^{(i)})</script> times the accumulated log-likelihood gradient of each action seen during that trajectory.<p></p>
<p>Intuition of Policy Gradient: Consider generic form of <span class="MathJax" id="MathJax-Element-112-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2315" style="width: 9.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.277em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.524em, 1000em, 2.921em, -0.52em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2316"><span class="mi" id="MathJax-Span-2317" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-2318" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2319"><span style="display: inline-block; position: relative; width: 1.312em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2320" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.505em;"><span class="texatom" id="MathJax-Span-2321"><span class="mrow" id="MathJax-Span-2322"><span class="mo" id="MathJax-Span-2323" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2324" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2325" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2326" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-2327"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2328" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2329" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2330" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2331"></span><span class="mi" id="MathJax-Span-2332" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-2333" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2334" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2335" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2336" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2337" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.3em; vertical-align: -0.304em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">R(\tau^{(i)}) \nabla_\theta \log P(\tau ; \theta)</script>, that is,  <span class="MathJax" id="MathJax-Element-113-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2338" style="width: 10.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.685em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.616em, 1000em, 2.952em, -0.795em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2339"><span class="msubsup" id="MathJax-Span-2340"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000em, 4.373em, -0.795em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-2341"><span class="mrow" id="MathJax-Span-2342"><span class="munderover" id="MathJax-Span-2343"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.499em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2344" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.098em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2345" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.507em;"><span class="mi" id="MathJax-Span-2346" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2347" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-2348" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-2349" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2350"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2351" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-2352" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2353" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-2354"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2355" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2357" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2358"></span><span class="mi" id="MathJax-Span-2359" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-2360" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2361" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2362" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2363" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2364" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.233em; vertical-align: -0.339em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">\hat g_i = f(x_i) \nabla_\theta \log P(\tau ; \theta)</script>. <span class="MathJax" id="MathJax-Element-118-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2392" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2393"><span class="mi" id="MathJax-Span-2394" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-2395" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2396" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2397" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.107em; vertical-align: -0.292em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">f(x)</script> measures how good the same <span class="MathJax" id="MathJax-Element-115-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2371" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2372"><span class="mi" id="MathJax-Span-2373" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">x</script> is, so moving in the direction <span class="MathJax" id="MathJax-Element-116-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2374" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.278em, 1000em, 2.614em, -0.795em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2375"><span class="msubsup" id="MathJax-Span-2376"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000em, 4.373em, -0.795em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-2377"><span class="mrow" id="MathJax-Span-2378"><span class="munderover" id="MathJax-Span-2379"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.499em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2380" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.098em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2381" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">̂&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.507em;"><span class="mi" id="MathJax-Span-2382" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.233em; vertical-align: -0.339em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">\hat g_i</script> pushes up the log-probability of the actions seen in policy <span class="MathJax" id="MathJax-Element-117-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2383" style="width: 1.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.186em, 1000em, 2.376em, -0.495em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2384"><span class="msubsup" id="MathJax-Span-2385"><span style="display: inline-block; position: relative; width: 1.312em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2386" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.505em;"><span class="texatom" id="MathJax-Span-2387"><span class="mrow" id="MathJax-Span-2388"><span class="mo" id="MathJax-Span-2389" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2390" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2391" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.071em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">\tau^{(i)}</script>, in proportion to how good it is; this is valid even if <span class="MathJax" id="MathJax-Element-118-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2392" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2393"><span class="mi" id="MathJax-Span-2394" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-2395" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2396" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2397" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.107em; vertical-align: -0.292em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">f(x)</script> is discontinuous, and unknown, or if sample space containing x is discrete.</p>
<p><strong>Policy Gradient Theorem</strong>: The policy gradient theorem slightly generalizes the likelihood ratio approach for the non-episodic setting and for any policy objective function <span class="MathJax" id="MathJax-Element-124-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2440" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2441"><span class="mi" id="MathJax-Span-2442" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">J</script> (could be <span class="MathJax" id="MathJax-Element-120-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2401" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.957em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.515em, -0.513em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2402"><span class="msubsup" id="MathJax-Span-2403"><span style="display: inline-block; position: relative; width: 0.929em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2404" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="mn" id="MathJax-Span-2405" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.016em; vertical-align: -0.229em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-120">J_1</script> (episodic reward), <span class="MathJax" id="MathJax-Element-121-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2406" style="width: 1.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.528em, -0.513em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2407"><span class="msubsup" id="MathJax-Span-2408"><span style="display: inline-block; position: relative; width: 1.717em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2409" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="texatom" id="MathJax-Span-2410"><span class="mrow" id="MathJax-Span-2411"><span class="mi" id="MathJax-Span-2412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2413" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mi" id="MathJax-Span-2414" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">R</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.03em; vertical-align: -0.243em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-121">J_{avR}</script> (average reward per time step, or <span class="MathJax" id="MathJax-Element-122-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2415" style="width: 3.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.491em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.133em, 1000em, 2.904em, -0.507em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2416"><span class="mfrac" id="MathJax-Span-2417"><span style="display: inline-block; position: relative; width: 1.302em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.662em, 1000em, 2.477em, -0.428em); top: -2.724em; left: 50%; margin-left: -0.197em;"><span class="mn" id="MathJax-Span-2418" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.623em, -0.428em); top: -1.915em; left: 50%; margin-left: -0.591em;"><span class="mrow" id="MathJax-Span-2419"><span class="mn" id="MathJax-Span-2420" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-2421" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-2422" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.302em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2423" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.717em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2424" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.46em;"><span class="texatom" id="MathJax-Span-2425"><span class="mrow" id="MathJax-Span-2426"><span class="mi" id="MathJax-Span-2427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-2428" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">v</span><span class="mi" id="MathJax-Span-2429" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.715em; vertical-align: -0.661em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-122">\frac{1}{1-\gamma}J_{avV}</script> (average value)).<br>
For any differntiable policy <span class="MathJax" id="MathJax-Element-123-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2430" style="width: 3.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.041em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2431"><span class="msubsup" id="MathJax-Span-2432"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2433" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2434" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2435" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2436" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2437" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2438" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-2439" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-123">\pi_\theta(s,a)</script> and any policy objective function <span class="MathJax" id="MathJax-Element-124-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2440" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2441"><span class="mi" id="MathJax-Span-2442" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-124">J</script>, the policy gradient is<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-125-Frame" style=""><nobr><span class="math" id="MathJax-Span-2443" style="width: 17.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.878em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.649em, 1000em, 2.964em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2444"><span class="msubsup" id="MathJax-Span-2445"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2446" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2447" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2448" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-2449" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2450" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2451" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2452" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-2453" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2454"><span class="mrow" id="MathJax-Span-2455"><span class="mi" id="MathJax-Span-2456" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2457"><span class="mrow" id="MathJax-Span-2458"><span class="msubsup" id="MathJax-Span-2459"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2460" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2461" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2462" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-2463"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2464" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2465" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2466" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2467"></span><span class="msubsup" id="MathJax-Span-2468" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2469" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2470" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2471" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2472" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2473" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2474" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-2475" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-2476"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2477" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.732em;"><span class="texatom" id="MathJax-Span-2478"><span class="mrow" id="MathJax-Span-2479"><span class="msubsup" id="MathJax-Span-2480"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2481" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2482" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2483" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2484" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-2485" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-2486" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-2487" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2488" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.21em; vertical-align: -0.353em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-125">\nabla_\theta J(\theta) = \mathbb{E}_{\pi_\theta}[\nabla_\theta \log \pi_\theta (s,a) Q^{\pi_\theta}(s,a)]</script><p></p>
<p>This is an unbiased but very noisy estimate of the policy gradient. This is vaguely analogous to the Monte Carlo estimates - we run our policy and we get the estimated sum of rewards, and upgate our gradient accordingly, so the estimator is unbiased but very noisy. Adding some fixes will reduce the variance make it practical: 1. Temporal structure, 2. Baseline.</p>
<h2>Temporal Structure</h2>
<p><strong>Intuition</strong><br>
According to Eqn (1) above, and making the substitution from (2),<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-126-Frame" style=""><nobr><span class="math" id="MathJax-Span-2489" style="width: 100%; display: inline-block; min-width: 32.828em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(5.701em, 1000em, 12.673em, -0.507em); top: -7.658em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2490"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.098em, 1000em, 5.51em, -0.444em); top: -4.054em; left: 50%; margin-left: -14.772em;"><span class="msubsup" id="MathJax-Span-2491"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2492" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2493" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2494" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-2495" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2496" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2497" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2498" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-2499" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2500"><span class="mrow" id="MathJax-Span-2501"><span class="mi" id="MathJax-Span-2502" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2503"><span class="mrow" id="MathJax-Span-2504"><span class="mi" id="MathJax-Span-2505" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-2506" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-2507"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2508" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2509" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2510" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2511" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-2512" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2513" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2514" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-2515"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2516" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2517" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2518" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2519"></span><span class="mi" id="MathJax-Span-2520" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-2521" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2522" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2523" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-2524" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2525" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2526" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2527" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-2528" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2529"><span class="mrow" id="MathJax-Span-2530"><span class="mi" id="MathJax-Span-2531" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2532"><span class="mrow" id="MathJax-Span-2533"><span class="mi" id="MathJax-Span-2534" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-2535" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-2536"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2537" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2538" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2539" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2540" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="mi" id="MathJax-Span-2541" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-2542" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2543" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2544" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2545" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2546" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2547"><span class="mrow" id="MathJax-Span-2548"><span class="mi" id="MathJax-Span-2549" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2550" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2551" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2552"><span class="mrow" id="MathJax-Span-2553"><span class="mi" id="MathJax-Span-2554" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2555" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2556" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2557" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2558" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2559" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2560" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2561"></span><span class="msubsup" id="MathJax-Span-2562" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2563" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2564" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2565" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2566"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2567" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2568" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2569"><span class="mrow" id="MathJax-Span-2570"><span class="mo" id="MathJax-Span-2571" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2572"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2573" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2574" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2575" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2576" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span><span style="display: inline-block; width: 0px; height: 4.054em;"></span></span><span style="position: absolute; clip: rect(2.098em, 1000em, 5.51em, -0.507em); top: -0.495em; left: 50%; margin-left: -9.292em;"><span class="mspace" id="MathJax-Span-2577" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2578" style="font-family: STIXGeneral-Regular;">=</span><span class="msubsup" id="MathJax-Span-2579" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2580"><span class="mrow" id="MathJax-Span-2581"><span class="mi" id="MathJax-Span-2582" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2583"><span class="mrow" id="MathJax-Span-2584"><span class="mi" id="MathJax-Span-2585" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-2586" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-2587"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2588" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2589" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2590" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2591" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="mrow" id="MathJax-Span-2592"><span class="mo" id="MathJax-Span-2593" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">(</span></span><span class="munderover" id="MathJax-Span-2594"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2595" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2596"><span class="mrow" id="MathJax-Span-2597"><span class="mi" id="MathJax-Span-2598" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2599" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2600" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2601"><span class="mrow" id="MathJax-Span-2602"><span class="mi" id="MathJax-Span-2603" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2604" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2605" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2606" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2607" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-2608" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2609" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">)</span></span></span><span class="mrow" id="MathJax-Span-2610" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2611" style="vertical-align: -0.778em; padding-left: 0.188em;"><span style="font-family: STIXSizeFourSym;">(</span></span><span class="munderover" id="MathJax-Span-2612"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2613" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2614"><span class="mrow" id="MathJax-Span-2615"><span class="mi" id="MathJax-Span-2616" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2617" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2618" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2619"><span class="mrow" id="MathJax-Span-2620"><span class="mi" id="MathJax-Span-2621" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2622" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2623" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2624" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2625" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2626" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2627" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2628"></span><span class="msubsup" id="MathJax-Span-2629" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2630" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-2631" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2632" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2633"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2634" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2635" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2636"><span class="mrow" id="MathJax-Span-2637"><span class="mo" id="MathJax-Span-2638" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2639"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2640" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2641" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2642" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2643" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">)</span></span></span><span class="mo" id="MathJax-Span-2644" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span><span style="display: inline-block; width: 0px; height: 4.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.658em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 7.489em; vertical-align: -5.443em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-126">\nabla_\theta V(\theta) = \mathbb{E}_{\tau \sim \pi_\theta} [R(\tau) \nabla_\theta \log P(\tau ; \theta)] = \mathbb{E}_{\tau \sim \pi_\theta} \left[ R(\tau) \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \right]  \\ = \mathbb{E}_{\tau \sim \pi_\theta} \left[ \left( \sum_{t=1}^{T-1} r_t \right) \left( \sum_{t=0}^{T-1} \nabla_\theta \log \pi_\theta(a_t|s_t) \right)  \right]</script><p></p>
<p>Our goal now is to stabilize the update equation in (3) by noting that a lot of the terms in (3) are superflous, because any actions the policy picks only affects rewards in later parts of the episode, and has no effect on rewards in previous time steps.</p>
<p><strong>Formalism</strong><br>
To make this explicit, we build the above equation each timestep at a time. Using the same derivation as above, the gradient estimate for a simgle time-step reward <span class="MathJax" id="MathJax-Element-127-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2645" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.462em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2646"><span class="msubsup" id="MathJax-Span-2647"><span style="display: inline-block; position: relative; width: 1.06em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2648" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.427em;"><span class="texatom" id="MathJax-Span-2649"><span class="mrow" id="MathJax-Span-2650"><span class="msup" id="MathJax-Span-2651"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2652" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-2653" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-127">r_{t'}</script>, is below (making explicit that it only depends on the likelihood ratio of the probability over trajectories up until time <span class="MathJax" id="MathJax-Element-128-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2654" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.265em, 1000em, 2.376em, -0.469em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2655"><span class="msup" id="MathJax-Span-2656"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2657" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.393em;"><span class="mo" id="MathJax-Span-2658" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.983em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-128">t'</script>):<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-129-Frame" style=""><nobr><span class="math" id="MathJax-Span-2659" style="width: 17.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.991em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.215em, 1000em, 5.731em, -0.444em); top: -4.223em; left: 0em;"><span class="mrow" id="MathJax-Span-2660"><span class="msubsup" id="MathJax-Span-2661"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2662" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2663" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2664"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2665"><span class="mrow" id="MathJax-Span-2666"><span class="mi" id="MathJax-Span-2667" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2668"><span class="mrow" id="MathJax-Span-2669"><span class="msubsup" id="MathJax-Span-2670"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2671" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2672" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2673" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-2674"><span style="display: inline-block; position: relative; width: 1.06em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2675" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.427em;"><span class="texatom" id="MathJax-Span-2676"><span class="mrow" id="MathJax-Span-2677"><span class="msup" id="MathJax-Span-2678"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2679" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-2680" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2681" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-2682" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mrow" id="MathJax-Span-2683" style="padding-left: 0.313em;"><span class="mo" id="MathJax-Span-2684" style="vertical-align: 1.839em; padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.138em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.59em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.864em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2685"><span style="display: inline-block; position: relative; width: 0.864em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2686" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.74em, 1000em, 2.458em, -0.476em); top: -2.633em; left: 0.507em;"><span class="mo" id="MathJax-Span-2687" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.427em;"><span class="mi" id="MathJax-Span-2688" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2689" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2690" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2691"><span class="mrow" id="MathJax-Span-2692"><span class="mi" id="MathJax-Span-2693" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2694" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2695" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000em, 4.174em, -0.48em); top: -5.198em; left: 0.397em;"><span class="texatom" id="MathJax-Span-2696"><span class="mrow" id="MathJax-Span-2697"><span class="msup" id="MathJax-Span-2698"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-2700" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2701" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2702" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2703" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2704" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2705"></span><span class="msubsup" id="MathJax-Span-2706" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2707" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2708"><span class="mrow" id="MathJax-Span-2709"><span class="mi" id="MathJax-Span-2710" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2711" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2712"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2713" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2714" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2715"><span class="mrow" id="MathJax-Span-2716"><span class="mo" id="MathJax-Span-2717" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2718"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2719" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2720" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2721" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2722" style="vertical-align: 1.839em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.138em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.59em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.864em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.223em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.653em; vertical-align: -1.549em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-129">\nabla_\theta \mathbb{E}_{\pi_\theta}[r_{t'}] = \left[r_t' \sum_{t=0}^{t'}\nabla_\theta \log \pi_{\theta} (a_t|s_t) \right]</script><br>
Since <span class="MathJax" id="MathJax-Element-130-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2723" style="width: 4.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.885em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.061em, 1000em, 2.695em, -0.449em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2724"><span class="munderover" id="MathJax-Span-2725"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-2726" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.477em, -0.465em); top: -2.797em; left: 0.957em;"><span class="texatom" id="MathJax-Span-2727"><span class="mrow" id="MathJax-Span-2728"><span class="mi" id="MathJax-Span-2729" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2730" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2731" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.485em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-2732"><span class="mrow" id="MathJax-Span-2733"><span class="msup" id="MathJax-Span-2734"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2735" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-2736" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-2737" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-2738" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2739" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.314em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2740" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.507em;"><span class="texatom" id="MathJax-Span-2741"><span class="mrow" id="MathJax-Span-2742"><span class="mo" id="MathJax-Span-2743" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2744" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2745" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(3.342em, 1000em, 4.174em, -0.48em); top: -3.675em; left: 0.427em;"><span class="texatom" id="MathJax-Span-2746"><span class="mrow" id="MathJax-Span-2747"><span class="msup" id="MathJax-Span-2748"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2749" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-2750" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.564em; vertical-align: -0.429em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-130">\sum_{t' = t}^{T-1} r_{t'}^{(i)}</script> is the return <span class="MathJax" id="MathJax-Element-131-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-2751" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.079em, 1000em, 2.594em, -0.455em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-2752"><span class="msubsup" id="MathJax-Span-2753"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2754" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-2755"><span class="mrow" id="MathJax-Span-2756"><span class="mo" id="MathJax-Span-2757" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2758" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-2759" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-2760" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.431em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-131">G_t^{(i)}</script>, we sum this up over all times steps for a trajectory to get<p></p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-132-Frame" style=""><nobr><span class="math" id="MathJax-Span-2761" style="width: 100%; display: inline-block; min-width: 30.909em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 30.909em;"><span style="position: absolute; clip: rect(5.594em, 1000em, 15.978em, -0.507em); top: -11.036em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2762"><span class="mtable" id="MathJax-Span-2763" style="min-width: 30.909em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 30.909em;"><span style="display: inline-block; position: absolute; width: 24.944em; height: 0px; clip: rect(-5.442em, 1000em, 4.942em, -0.507em); top: 0em; left: 50%; margin-left: -12.472em;"><span style="position: absolute; clip: rect(4.334em, 1000em, 12.27em, -0.507em); top: -8.615em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.417em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.964em, -0.444em); top: -5.968em; right: 0em;"><span class="mtd" id="MathJax-Span-2767"><span class="mrow" id="MathJax-Span-2768"><span class="msubsup" id="MathJax-Span-2769"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2770" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2771" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2772" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-2773" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2774" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2775" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2776" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-2777" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2778" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2779" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2780"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2781"><span class="mrow" id="MathJax-Span-2782"><span class="mi" id="MathJax-Span-2783" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2784"><span class="mrow" id="MathJax-Span-2785"><span class="mi" id="MathJax-Span-2786" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-2787" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-2788"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2789" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2790" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2791" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-2792" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-2793" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2794" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-2795" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2796" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.946em; right: 0em;"><span class="mtd" id="MathJax-Span-2866"><span class="mrow" id="MathJax-Span-2867"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -0.512em; right: 0em;"><span class="mtd" id="MathJax-Span-2937"><span class="mrow" id="MathJax-Span-2938"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.615em;"></span></span><span style="position: absolute; clip: rect(5.594em, 1000em, 15.978em, -0.209em); top: -11.036em; left: 10.417em;"><span style="display: inline-block; position: relative; width: 14.527em; height: 0px;"><span style="position: absolute; clip: rect(2.215em, 1000em, 5.731em, -0.209em); top: -7.657em; left: 0em;"><span class="mtd" id="MathJax-Span-2797"><span class="mrow" id="MathJax-Span-2798"><span class="mo" id="MathJax-Span-2799" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-2800"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2801"><span class="mrow" id="MathJax-Span-2802"><span class="mi" id="MathJax-Span-2803" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2804"><span class="mrow" id="MathJax-Span-2805"><span class="msubsup" id="MathJax-Span-2806"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2807" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2808" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2809" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2810" style="vertical-align: 1.839em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.138em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.59em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.864em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2811"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0.056em;"><span class="mo" id="MathJax-Span-2812" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.587em, -0.48em); top: -1.107em; left: 0em;"><span class="texatom" id="MathJax-Span-2813"><span class="mrow" id="MathJax-Span-2814"><span class="msup" id="MathJax-Span-2815"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2816" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-2817" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-2818" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2819" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0.056em;"><span class="texatom" id="MathJax-Span-2820"><span class="mrow" id="MathJax-Span-2821"><span class="mi" id="MathJax-Span-2822" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2823" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2824" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2825" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.864em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2826" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.74em, 1000em, 2.458em, -0.476em); top: -2.633em; left: 0.507em;"><span class="mo" id="MathJax-Span-2827" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.427em;"><span class="mi" id="MathJax-Span-2828" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2829" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2830" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2831"><span class="mrow" id="MathJax-Span-2832"><span class="mi" id="MathJax-Span-2833" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2834" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2835" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(3.19em, 1000em, 4.174em, -0.48em); top: -5.198em; left: 0.397em;"><span class="texatom" id="MathJax-Span-2836"><span class="mrow" id="MathJax-Span-2837"><span class="msup" id="MathJax-Span-2838"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2839" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-2840" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2841" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2842" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2843" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2844" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2845"></span><span class="msubsup" id="MathJax-Span-2846" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2847" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2848"><span class="mrow" id="MathJax-Span-2849"><span class="mi" id="MathJax-Span-2850" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2851" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2852"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2853" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2854" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2855"><span class="mrow" id="MathJax-Span-2856"><span class="mo" id="MathJax-Span-2857" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2858"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2859" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2860" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2861" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2862" style="vertical-align: 1.839em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.138em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.59em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.864em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.223em;"></span></span><span style="position: absolute; clip: rect(2.245em, 1000em, 5.701em, -0.209em); top: -4.171em; left: 0em;"><span class="mtd" id="MathJax-Span-2868"><span class="mrow" id="MathJax-Span-2869"><span class="mo" id="MathJax-Span-2870" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-2871"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2872"><span class="mrow" id="MathJax-Span-2873"><span class="mi" id="MathJax-Span-2874" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2875"><span class="mrow" id="MathJax-Span-2876"><span class="msubsup" id="MathJax-Span-2877"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2878" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2879" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2880" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2881" style="vertical-align: 1.809em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.197em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.609em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.903em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2882"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2883" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2884"><span class="mrow" id="MathJax-Span-2885"><span class="mi" id="MathJax-Span-2886" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2887" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2888" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2889"><span class="mrow" id="MathJax-Span-2890"><span class="mi" id="MathJax-Span-2891" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2892" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2893" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2894" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2895" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2896" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2897" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2898"></span><span class="msubsup" id="MathJax-Span-2899" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2900" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2901"><span class="mrow" id="MathJax-Span-2902"><span class="mi" id="MathJax-Span-2903" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2904" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2905"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2906" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2907" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2908"><span class="mrow" id="MathJax-Span-2909"><span class="mo" id="MathJax-Span-2910" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2911"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2912" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2913" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2914" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-2915" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2916" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.585em, -0.48em); top: -1.107em; left: 0.028em;"><span class="texatom" id="MathJax-Span-2917"><span class="mrow" id="MathJax-Span-2918"><span class="msup" id="MathJax-Span-2919"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2920" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-2921" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-2922" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-2923" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2924"><span class="mrow" id="MathJax-Span-2925"><span class="mi" id="MathJax-Span-2926" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2927" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2928" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2929" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.864em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2930" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.74em, 1000em, 2.458em, -0.476em); top: -2.633em; left: 0.507em;"><span class="mo" id="MathJax-Span-2931" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.427em;"><span class="mi" id="MathJax-Span-2932" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2933" style="vertical-align: 1.809em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.197em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.609em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.903em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.223em;"></span></span><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.209em); top: -0.624em; left: 0em;"><span class="mtd" id="MathJax-Span-2939"><span class="mrow" id="MathJax-Span-2940"><span class="mo" id="MathJax-Span-2941" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-2942"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-2943"><span class="mrow" id="MathJax-Span-2944"><span class="mi" id="MathJax-Span-2945" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-2946"><span class="mrow" id="MathJax-Span-2947"><span class="msubsup" id="MathJax-Span-2948"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-2949" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-2950" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-2951" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-2952" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="msubsup" id="MathJax-Span-2953"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2954" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-2955" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-2956" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-2957" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-2958"><span class="mrow" id="MathJax-Span-2959"><span class="mi" id="MathJax-Span-2960" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-2961" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-2962" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-2963"><span class="mrow" id="MathJax-Span-2964"><span class="mi" id="MathJax-Span-2965" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2966" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-2967" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-2968" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2969" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2970" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2971" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-2972"></span><span class="msubsup" id="MathJax-Span-2973" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2974" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2975"><span class="mrow" id="MathJax-Span-2976"><span class="mi" id="MathJax-Span-2977" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2978" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-2979"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2980" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-2981" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-2982"><span class="mrow" id="MathJax-Span-2983"><span class="mo" id="MathJax-Span-2984" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-2985"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2986" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-2987" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-2988" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2989" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.036em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(-4.279em, 1000em, 3.832em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -5.968em; right: 0em;"><span class="mtd" id="mjx-eqn-4"><span class="mrow" id="MathJax-Span-2765"><span class="mtext" id="MathJax-Span-2766" style="font-family: STIXGeneral-Regular;">(4)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.88em, -0.507em); top: -2.482em; right: 0em;"><span class="mtd" id="mjx-eqn-5"><span class="mrow" id="MathJax-Span-2864"><span class="mtext" id="MathJax-Span-2865" style="font-family: STIXGeneral-Regular;">(5)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.681em, 1000em, 2.88em, -0.507em); top: 0.952em; right: 0em;"><span class="mtd" id="mjx-eqn-6"><span class="mrow" id="MathJax-Span-2935"><span class="mtext" id="MathJax-Span-2936" style="font-family: STIXGeneral-Regular;">(6)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 11.036em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 11.277em; vertical-align: -5.361em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-132">\begin{align} \nabla_\theta V(\theta) = \nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta} [R(\tau)]                       & =  \mathbb{E}_{\pi_\theta} \left[ \sum_{t' = 0}^{T-1} r_t' \sum_{t=0}^{t'}\nabla_\theta \log \pi_{\theta} (a_t|s_t) \right]  \tag{4} \\                        & = \mathbb{E}_{\pi_\theta} \left[ \sum_{t=0}^{T-1}\nabla_\theta \log \pi_{\theta} (a_t|s_t) \sum_{t' = t}^{T-1} r_t' \right] \tag{5} \\                        & = \mathbb{E}_{\pi_\theta} \left[ G_t \sum_{t=0}^{T-1}\nabla_\theta \log \pi_{\theta} (a_t|s_t) \right] \tag{6} \end{align}</script><br>
Note the deivation example in Appendix 4.<p></p>
<p>Our final expression that is used in the policy gradient algorithm is thus as follows:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-133-Frame" style=""><nobr><span class="math" id="MathJax-Span-2990" style="width: 27.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.831em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.587em, 1000em, 3.963em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2991"><span class="msubsup" id="MathJax-Span-2992"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-2993" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-2994" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-2995" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-2996" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-2997" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-2998" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-2999" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-3000" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3001" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3002" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3003"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-3004"><span class="mrow" id="MathJax-Span-3005"><span class="mi" id="MathJax-Span-3006" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-3007"><span class="mrow" id="MathJax-Span-3008"><span class="mi" id="MathJax-Span-3009" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-3010" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="msubsup" id="MathJax-Span-3011"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3012" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-3013" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3014" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-3015" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-3016" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3017" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-3018" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3019" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-3020" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span><span class="mfrac" id="MathJax-Span-3021" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.852em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-3022" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.495em); top: -1.848em; left: 50%; margin-left: -0.366em;"><span class="mi" id="MathJax-Span-3023" style="font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 0.852em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3024" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3025" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3026"><span class="mrow" id="MathJax-Span-3027"><span class="mi" id="MathJax-Span-3028" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3029" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3030" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.498em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-3031" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-3032" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-3033" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-3034"><span class="mrow" id="MathJax-Span-3035"><span class="mi" id="MathJax-Span-3036" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-3037" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-3038" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-3039"><span class="mrow" id="MathJax-Span-3040"><span class="mi" id="MathJax-Span-3041" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-3042" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-3043" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3044" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3045" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-3046"><span class="mrow" id="MathJax-Span-3047"><span class="mo" id="MathJax-Span-3048" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3049" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-3050" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-3051" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3052" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋅</span><span class="msubsup" id="MathJax-Span-3053" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3054" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3055" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3056" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3057"></span><span class="msubsup" id="MathJax-Span-3058" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3059" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-3060"><span class="mrow" id="MathJax-Span-3061"><span class="mi" id="MathJax-Span-3062" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3063" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3064"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3065" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-3066" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3067"><span class="mrow" id="MathJax-Span-3068"><span class="mo" id="MathJax-Span-3069" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3070"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3071" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-3072" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3073" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.497em; vertical-align: -1.461em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-133">\nabla_\theta V(\theta) = \nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta} [R(\tau)]   \approx \frac{1}{m} \sum_{i=1}^m \sum_{t=0}^{T-1} G_t^{(i)} \cdot \nabla_\theta \log \pi_{\theta} (a_t|s_t)</script><p></p>
<p>We multiply the above value by our learning rate <span class="MathJax" id="MathJax-Element-134-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-3074" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-3075"><span class="mi" id="MathJax-Span-3076" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-134">\alpha</script> to get the next update. The interpretation is, we still do Monte Carlo averaging and then iterate over timesteps, but instead of using the total reward at the end of each trajectory we only use the future rewards (attributable to some action) to update that action's log-likelihood gradient.</p>
</div><div class="cell text-cell"><div><b>Appendix 1: Types of RL</b><br></div><div><br><div><img src="resources/FC83E1EECE27796C06EBF61A858E48C6.png" alt="Screenshot 2020-04-01 at 7.49.46 PM.png" width="643" height="476"></div></div><div><br></div><div>Appendix 2: Alias Gridworld Example</div><div><img src="resources/A4889F9624280EF2BD975663BD5DF52E.png" alt="Screenshot 2020-04-01 at 7.58.42 PM.png" width="647" height="483"><br></div><div><img src="resources/F096DD74515219271EC47FBC5C0C428A.png" alt="Screenshot 2020-04-01 at 7.59.01 PM.png" width="644" height="479">&nbsp;<br></div><div><img src="resources/E046990373CEC13911241C0B871C1532.png" alt="Screenshot 2020-04-01 at 7.59.23 PM.png" width="638" height="483"><br></div><div><br></div><div><b>Appendix 3: Examples of RL Applications</b></div><div><br></div><div>Exoskeleton optimization - used non gradient method&nbsp;</div><div><img src="resources/AA97F85865D033D6360082E48758F94F.png" alt="Screenshot 2020-04-01 at 8.09.14 PM.png" width="646" height="479"><br></div><div><br></div><div><b>RoboCup</b></div><div>By 2050, have a robotic soccer teams that can win the world cup.</div><div><br></div><div>Robocup uses these AIBO robots (below pic), goal was to learn a fast way for AIBOs to e=walk. Want the AIBOs to really quickly optimize their gait with very little data.</div><div><img src="resources/C35D17F5B9022EE697C4ADB12051819E.png" alt="Screenshot 2020-04-01 at 8.55.07 PM.png" width="627" height="476"></div><div><img src="resources/8BC6E0E4191BE1C5633928B14DD96F8C.png" alt="Screenshot 2020-04-01 at 8.59.17 PM.png" width="644" height="475"></div><div>Stone used finite differcing to compute these gradients.&nbsp;<img src="resources/8092D582A6E4353F5E2AC30E2D458700.png" alt="Screenshot 2020-04-01 at 9.00.17 PM.png" width="646" height="480"></div><div><img src="resources/66F85F360DAA28DA0739AA210FF4A7DE.png" alt="Screenshot 2020-04-01 at 9.00.52 PM.png" width="641" height="480"><br></div><div><br></div><div><img src="resources/FE50D63DFC2460AC9BB34EE32A5D3054.png" alt="Screenshot 2020-04-01 at 8.57.34 PM.png" width="477" height="424"></div><div></div></div><div class="cell markdown-cell"><h2>Appendix 4: Derivation Example for Temporal Structure</h2>
<p>Example<br>
The above steps may not be obvious, so here is a quick example. Save we haev a trajectory that is three time steps long. Then (4) becomes<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-135-Frame" style=""><nobr><span class="math" id="MathJax-Span-3077" style="width: 34.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.194em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.109em, 1000em, 4.001em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3078"><span class="mtable" id="MathJax-Span-3079" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 30.856em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1000em, 6.035em, -0.507em); top: -4.448em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.25em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.964em, -0.444em); top: -3.87em; right: 0em;"><span class="mtd" id="MathJax-Span-3080"><span class="mrow" id="MathJax-Span-3081"><span class="msubsup" id="MathJax-Span-3082"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3083" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3084" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3085" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-3086" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3087" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-3088" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3089" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-3090" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-3091"><span class="mrow" id="MathJax-Span-3092"><span class="mi" id="MathJax-Span-3093" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-3094"><span class="mrow" id="MathJax-Span-3095"><span class="msubsup" id="MathJax-Span-3096"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3097" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-3098" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3099" style="font-family: STIXGeneral-Regular;">[</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.935em; right: 0em;"><span class="mtd" id="MathJax-Span-3125"><span class="mrow" id="MathJax-Span-3126"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.579em; right: 0em;"><span class="mtd" id="MathJax-Span-3174"><span class="mrow" id="MathJax-Span-3175"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.448em;"></span></span><span style="position: absolute; clip: rect(2.485em, 1000em, 6.479em, -0.462em); top: -4.673em; left: 6.25em;"><span style="display: inline-block; position: relative; width: 24.606em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.462em); top: -3.87em; left: 0em;"><span class="mtd" id="MathJax-Span-3100"><span class="mrow" id="MathJax-Span-3101"><span class="msubsup" id="MathJax-Span-3102"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3103" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3104" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-3105"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3106" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3107" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3108" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3109"></span><span class="msubsup" id="MathJax-Span-3110" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3111" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3112" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3113" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3114"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3115" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3116" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3117"><span class="mrow" id="MathJax-Span-3118"><span class="mo" id="MathJax-Span-3119" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3120"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3121" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3122" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3123" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3124" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.462em); top: -2.471em; left: 0em;"><span class="mtd" id="MathJax-Span-3127"><span class="mrow" id="MathJax-Span-3128"><span class="msubsup" id="MathJax-Span-3129"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3130" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3132" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3133"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3134" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3135" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3136" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3137"></span><span class="msubsup" id="MathJax-Span-3138" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3139" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3140" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3141" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3142"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3143" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3144" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3145"><span class="mrow" id="MathJax-Span-3146"><span class="mo" id="MathJax-Span-3147" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3148"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3149" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3150" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3151" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3152" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3153" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3154" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3155" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3156" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3157"></span><span class="msubsup" id="MathJax-Span-3158" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3159" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3160" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3161" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3162"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3163" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3164" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3165"><span class="mrow" id="MathJax-Span-3166"><span class="mo" id="MathJax-Span-3167" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3168"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3169" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3170" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3171" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3172" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3173" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.462em); top: -1.116em; left: 0em;"><span class="mtd" id="MathJax-Span-3176"><span class="mrow" id="MathJax-Span-3177"><span class="msubsup" id="MathJax-Span-3178"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3179" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3180" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3181" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3182"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3183" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3184" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3185" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3186"></span><span class="msubsup" id="MathJax-Span-3187" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3188" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3189" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3190" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3191"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3192" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3193" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3194"><span class="mrow" id="MathJax-Span-3195"><span class="mo" id="MathJax-Span-3196" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3197"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3198" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3199" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3200" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3201" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3202" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3203" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3204" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3205" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3206"></span><span class="msubsup" id="MathJax-Span-3207" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3208" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3209" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3210" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3211"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3212" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3213" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3214"><span class="mrow" id="MathJax-Span-3215"><span class="mo" id="MathJax-Span-3216" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3217"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3218" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3219" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3220" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3221" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3222" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3223" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3224" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3225" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3226"></span><span class="msubsup" id="MathJax-Span-3227" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3228" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3229" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3230" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3231"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3232" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3233" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3234"><span class="mrow" id="MathJax-Span-3235"><span class="mo" id="MathJax-Span-3236" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3237"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3238" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3239" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3240" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3241" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3242" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.673em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.313em; vertical-align: -1.879em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">\begin{align} \nabla_\theta V(\theta)=\mathbb{E}_{\pi_\theta}[& r_0 \nabla_\theta \log \pi_\theta (a_0 | s_0) + \\                   & r_1 ( \nabla_\theta \log \pi_\theta (a_0 | s_0) + \nabla_\theta \log \pi_\theta (a_1 | s_1)) + \\                   & r_2 ( \nabla_\theta \log \pi_\theta (a_0 | s_0) + \nabla_\theta \log \pi_\theta (a_1 | s_1) + \nabla_\theta \log \pi_\theta (a_2 | s_2))] \end{align}</script><br>
which rearranges to<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-136-Frame" style=""><nobr><span class="math" id="MathJax-Span-3243" style="width: 22.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.045em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.109em, 1000em, 4.001em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-3244"><span class="mtable" id="MathJax-Span-3245" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 19.707em; height: 0px;"><span style="position: absolute; clip: rect(2.265em, 1000em, 6.035em, -0.507em); top: -4.448em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.25em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.964em, -0.444em); top: -3.87em; right: 0em;"><span class="mtd" id="MathJax-Span-3246"><span class="mrow" id="MathJax-Span-3247"><span class="msubsup" id="MathJax-Span-3248"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3249" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3251" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-3252" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-3253" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-3254" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3255" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-3256" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.457em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-3257"><span class="mrow" id="MathJax-Span-3258"><span class="mi" id="MathJax-Span-3259" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.676em;"><span class="texatom" id="MathJax-Span-3260"><span class="mrow" id="MathJax-Span-3261"><span class="msubsup" id="MathJax-Span-3262"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-3263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-3264" style="font-size: 50%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3265" style="font-family: STIXGeneral-Regular;">[</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.935em; right: 0em;"><span class="mtd" id="MathJax-Span-3301"><span class="mrow" id="MathJax-Span-3302"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.579em; right: 0em;"><span class="mtd" id="MathJax-Span-3334"><span class="mrow" id="MathJax-Span-3335"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.448em;"></span></span><span style="position: absolute; clip: rect(2.485em, 1000em, 6.479em, -0.444em); top: -4.673em; left: 6.25em;"><span style="display: inline-block; position: relative; width: 13.457em; height: 0px;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -3.87em; left: 0em;"><span class="mtd" id="MathJax-Span-3266"><span class="mrow" id="MathJax-Span-3267"><span class="msubsup" id="MathJax-Span-3268"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3269" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3270" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3271" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3272"></span><span class="msubsup" id="MathJax-Span-3273" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3274" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3275" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3276" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3277"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3278" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3279" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3280"><span class="mrow" id="MathJax-Span-3281"><span class="mo" id="MathJax-Span-3282" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3283"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3284" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3285" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3286" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3287" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3288"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3289" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3290" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3291" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3292" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3293" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3294" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3295" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3296" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3297" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3298" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3299" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3300" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -2.471em; left: 0em;"><span class="mtd" id="MathJax-Span-3303"><span class="mrow" id="MathJax-Span-3304"><span class="msubsup" id="MathJax-Span-3305"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3306" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3307" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3308" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3309"></span><span class="msubsup" id="MathJax-Span-3310" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3311" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3312" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3313" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3314"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3315" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3316" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3317"><span class="mrow" id="MathJax-Span-3318"><span class="mo" id="MathJax-Span-3319" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3320"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3321" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3322" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3323" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3324" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3325"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3326" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3327" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3328" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-3329" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3330" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3331" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3332" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3333" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.444em); top: -1.116em; left: 0em;"><span class="mtd" id="MathJax-Span-3336"><span class="mrow" id="MathJax-Span-3337"><span class="msubsup" id="MathJax-Span-3338"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3339" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-3340" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-3341" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-3342"></span><span class="msubsup" id="MathJax-Span-3343" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3344" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-3345" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3346" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3347"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3348" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-3349" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-3350"><span class="mrow" id="MathJax-Span-3351"><span class="mo" id="MathJax-Span-3352" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-3353"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3354" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-3355" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3356" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3357" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-3358"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-3359" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-3360" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-3361" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-3362" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.673em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.313em; vertical-align: -1.879em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-136">\begin{align} \nabla_\theta V(\theta) = \mathbb{E}_{\pi_\theta} [                    & \nabla_\theta \log \pi_\theta (a_0 | s_0)(r_0 + r_1 + r_2) + \\                   & \nabla_\theta \log \pi_\theta (a_1 | s_1)(r_1 + r_2) + \\                   & \nabla_\theta \log \pi_\theta (a_2 | s_2)(r_2) ] \end{align}</script><br>
which equals equation (5).<p></p>
</div></div>

    </body>
    </html>
  