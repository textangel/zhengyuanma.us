
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS234 - Lecture 4 - Model Free Control</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p>Backgammon, Go, Robot Locomution, Helicoper flight, Robocup soccer, Autonomous driving, Customer Ad selection, Patient Management<br>
Def: <strong>On-policy learning</strong>: Get direct experience from the world and learn to estimate and evaluate a policy from experience obtained from following that policy<br>
Def: <strong>Off-policy learning</strong>: Learn to estimate and evaluate a policy using experience gathered from following a different policy. (i.e. Q-learning)<br>
Example: Say you have two episodes <span class="MathJax" id="MathJax-Element-458-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12609" style="width: 6.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.912em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12610"><span class="mo" id="MathJax-Span-12611" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12612"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12613" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-12614" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12615" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12616" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12617" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-12618" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12619" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12620" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12621" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-12622" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12623" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12624" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12625" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-12626" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12627" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-458">(s_1,a_1,s_1,a_1)</script> and <span class="MathJax" id="MathJax-Element-459-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12628" style="width: 6.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.912em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12629"><span class="mo" id="MathJax-Span-12630" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12631"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12632" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-12633" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12634" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12635" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12636" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-12637" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12638" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12639" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12640" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-12641" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12642" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12643" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12644" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-12645" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12646" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-459">(s_1,a_2,s_1,a_2)</script>, and you wanted to learn something about <span class="MathJax" id="MathJax-Element-460-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12647" style="width: 6.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.912em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12648"><span class="mo" id="MathJax-Span-12649" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12650"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12651" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-12652" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12653" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12654" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12655" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-12656" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12657" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12658" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12659" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-12660" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12661" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-12662" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12663" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-12664" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12665" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-460">(s_1,a_1,s_1,a_2)</script>.</p>
<h2>Relations to Previous Material</h2>
<p>The basic model-free control problem is almost exactly the same as the policy evaluation problem - we use model-free policy evaluation to evaluate the value of all policies, then we pick a new policy which is the argmax of the estimated values, or an exploration policy with <span class="MathJax" id="MathJax-Element-461-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12666" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.196em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.714em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12667"><span class="mn" id="MathJax-Span-12668" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-12669" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-12670" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.888em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-461">1-\epsilon</script>. The exploration part is the only difference between model-free control and basic model based control.</p>
<p>Monte Carlo Control is exactly the same as Monte-Carlo policy evaluation (Lecture 3) with <span class="MathJax" id="MathJax-Element-462-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12671" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12672"><span class="mi" id="MathJax-Span-12673" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">\epsilon</script> greedy. SARSA is exactly the same as TD-learning policy evaluation with <span class="MathJax" id="MathJax-Element-462-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12671" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12672"><span class="mi" id="MathJax-Span-12673" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">\epsilon</script> greedy. Q-learning is a slight modification of SARSA that uses the max expectation of future rewards over actions chosen in the Q-step instaed of the expecation of future rewards. The general framework for control remains: 1. You do policy evaluation. 2. You do policy improvement (through <span class="MathJax" id="MathJax-Element-462-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12671" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12672"><span class="mi" id="MathJax-Span-12673" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">\epsilon</script> greedy).</p>
<h1>Monte Carlo Control</h1>
<h2>Model-Free Generalized Policy Iteration</h2>
<ol>
<li>Initialize policy <span class="MathJax" id="MathJax-Element-463-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12674" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12675"><span class="mi" id="MathJax-Span-12676" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-463">\pi</script></li>
<li>Repeat:
<ul>
<li>Policy evaluation: Compute <span class="MathJax" id="MathJax-Element-464-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12677" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.547em, -0.448em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-12678"><span class="msubsup" id="MathJax-Span-12679"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12680" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mi" id="MathJax-Span-12681" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.099em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-464">Q^\pi</script> from an estimate</li>
<li>Policy improvement: Update <span class="MathJax" id="MathJax-Element-463-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12674" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12675"><span class="mi" id="MathJax-Span-12676" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-463">\pi</script><br>
For the policy evaluation step, we can use Monte Carlo for on policy Q evaluation (Appendix 1).</li>
</ul>
</li>
</ol>
<h2>Exploration</h2>
<p>Use an <span class="MathJax" id="MathJax-Element-462-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12671" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12672"><span class="mi" id="MathJax-Span-12673" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">\epsilon</script> greedy policy: with prob <span class="MathJax" id="MathJax-Element-461-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12666" style="width: 2.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.196em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.714em, -0.396em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12667"><span class="mn" id="MathJax-Span-12668" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-12669" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-12670" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.888em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-461">1-\epsilon</script> take the current best action, else with prob <span class="MathJax" id="MathJax-Element-462-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12671" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.477em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12672"><span class="mi" id="MathJax-Span-12673" style="font-family: STIXGeneral-Italic;">ϵ</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">\epsilon</script> take any of the other actions at random. (Proof that epsilon-greedy monotonically improves Q function in Appendix 2).</p>
<h2>Full Monte Carlo Online Control Algorithm</h2>
<p>Use Model-Free Policy Iteration with Monte Carlo with epsilon-exploration. Note: Can change to every visit instead of first visit. GLIE Monte Carlo control converges to the optimal state-action value <span class="MathJax" id="MathJax-Element-465-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12682" style="width: 8.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.545em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.639em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12683"><span class="mi" id="MathJax-Span-12684" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-12685" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-12686" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-12687" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-12688" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-12689" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-12690" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="msubsup" id="MathJax-Span-12691" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12692" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-12693" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12694" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-12695" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-12696" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-12697" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-12698" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.133em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-465">Q(s,a) \rightarrow Q^*(s,a)</script></p>
</div><div class="cell text-cell"><img src="resources/0CAAFD239AEDB336650D3265459D6590.png" alt="Screenshot 2020-03-29 at 7.28.48 PM.png" width="616" height="459"></div><div class="cell markdown-cell"><h2>Temporal Differnece Control Methods</h2>
<p>Recall TD methods:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-466-Frame" style=""><nobr><span class="math" id="MathJax-Span-12699" style="width: 21.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.707em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.649em, 1000em, 2.909em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12700"><span class="msubsup" id="MathJax-Span-12701"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12702" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-12703" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12704" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12705"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12706" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-12707" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12708" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-12709" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-12710" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12711" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-12712" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12713" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12714"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12715" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-12716" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12717" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-12718" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-12719" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mo" id="MathJax-Span-12720" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-12721" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-12722"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12723" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-12724" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12725" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-12726" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-12727"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12728" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-12729" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12730" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12731"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12732" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-12733"><span class="mrow" id="MathJax-Span-12734"><span class="mi" id="MathJax-Span-12735" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-12736" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-12737" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12738" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-12739" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-12740" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-12741" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12742" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-12743" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12744" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-12745"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12746" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-12747" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12748" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-12749" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.148em; vertical-align: -0.291em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-466">V^\pi(s_t) = V^\pi(s_t) + \alpha ([r_t + \gamma V^\pi(s_{t+1})] - V^\pi(s_t))</script><br>
We can do the same as Monte Carlo Online control, but use TD methods to do policy evaluation step, but SARSA is generally faster (because it fully takes advantage of temporal difference and updates the Q-function and the policy with every step in every episode).<p></p>
<h3>SARSA</h3>
<p>Now the Q policy we are generating will be over different samples and will correspond to different policies over time.<br>
We don't have to wait to the end of the episode to update our Q function,<br>
We don't have to wait to the end of the episode to change how we act in the world.<br>
We need <span class="MathJax" id="MathJax-Element-467-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12750" style="width: 6.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.518em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.88em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-12751"><span class="mo" id="MathJax-Span-12752" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-12753" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-12754" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-12755" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-12756" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-12757" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-12758" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-12759" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12760" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-12761" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12762" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-12763" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-12764" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.563em;"><span class="mo" id="MathJax-Span-12765" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-12766" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.168em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-467">(s,a,r,s',a')</script> to update.</p>
<p>SARSA can be a little better than Q-learning early on, but often not. Generally just use Q-learning.<br>
Convergence Properties of SARSA in Appendix 3.</p>
</div><div class="cell text-cell"><img src="resources/2A6112B53259132159D80B5E03AC66C3.png" alt="Screenshot 2020-03-29 at 7.37.16 PM.png" width="596" height="445"><div><br></div></div><div class="cell markdown-cell"><h3>Q-learning (Off-Policy)</h3>
<p>Generally use this instead of SARSA.<br>
Q takes the argmax action as the sampled action every time. Thus it is now <strong>off-policy learning</strong>.<br>
Why are we picking that particular action for next step when we can just pick the max instead?</p>
</div><div class="cell text-cell"><img src="resources/1D3568D29D89EA68E066954E9094BB7F.png" alt="Screenshot 2020-03-29 at 7.44.09 PM.png" width="640" height="484"><div><img src="resources/3E3455130DB13310A864D368DD002697.png" alt="Screenshot 2020-03-29 at 7.47.07 PM.png" width="641" height="481"><br></div><div>Q-learning updates can take a bit longer to propagate than Monte Carlo, because you only update your reward for the state that you’re currently in. You don’t backpropagate the reward information to states that you previously visited, which happens in Monte Carlo.</div></div><div class="cell markdown-cell"><h2>Maximization Bias and Double Q-Learning</h2>
</div><div class="cell text-cell"><img src="resources/8C14468A75A5AA9E7344D566A9FFB55E.png" alt="Screenshot 2020-03-29 at 7.52.06 PM.png" width="597" height="448"><div>Double Q-learning was developed to help deal with the maximization bias. Instead of having one Q function, we make two independent estimators of Q and we use of them for decision making and the other to try to estimate the value. This makes the estimator unbiased.</div><div>(Note: I understand the maximization bias, but if you use two functions, dont you still get maximization bias, but slower?)</div><div>(Bias = you tend to choose more things that tend to look good before).</div><div><br><div><img src="resources/8833A01634DE02BEE316A928530B17CA.png" alt="Screenshot 2020-03-29 at 7.53.15 PM.png" width="642" height="482"><br></div></div><div><img src="resources/6161BDE87C4544D920D68F75E580FBD6.png" alt="Screenshot 2020-03-29 at 7.55.18 PM.png" width="598" height="451"><br></div><div><br></div><div>Double Q-learnign spends a lot less time doing bad actions than Q-learning!</div><div><img src="resources/2A41352FE0A4BE04F2725371F2DFEBAA.png" alt="Screenshot 2020-03-29 at 7.55.37 PM.png" width="595" height="444"><br></div><div><br></div><div style="font-size: 16px;"><b>Summary:</b></div><div><img src="resources/26996A9B4B419CE34F66E8B7D461A98F.png" alt="Screenshot 2020-03-29 at 7.56.12 PM.png" width="596" height="442">''<b><br></b></div></div><div class="cell text-cell"><div><b style="font-size: 17px;">Appendix 1: Monte Carlo for On Policy Q evaluation</b><br></div><div>Basically esactly the same as monte Carlo for value evaluation, except that instead of considering every s, we consider every possible s,a.</div><div><img src="resources/6C869EADA930840A7583831C79C5A8FB.png" alt="Screenshot 2020-03-29 at 7.07.02 PM.png" width="835" height="629"><br></div><div><br></div><div style="font-size: 17px;"><b>Appendix 2: Proof that epsilon greedy monotonically improves Q function:</b></div><div><img src="resources/0325AC070E100DFB4E0E504F43902780.png" alt="Screenshot 2020-03-29 at 7.24.54 PM.png" width="841" height="633"></div><div><br></div><div>Under GLIE conditions, you will be guarenteed to converge to the optimal policy for Monte Carlo and TD methods.</div><div><img src="resources/6B3D5697E8DCFB6CF61B8DE13BA61657.png" alt="Screenshot 2020-03-29 at 7.26.48 PM.png" width="612" height="460"><br></div><div><br></div><div><span style="font-size: 18px;"><b>Appendix 3: Convergence Properties of SARSA and Q-learning</b></span><br></div><div><img src="resources/5281C975188780428536925A8A1EC874.png" alt="Screenshot 2020-03-29 at 7.41.07 PM.png" width="643" height="485"><br></div><div><img src="resources/5446F29C75870D30FA170B17D7CC9FFF.png" alt="Screenshot 2020-03-29 at 7.50.10 PM.png" width="638" height="477"><br></div><div>The conditions needed to ensure that Q-learning with e-greedy converges to optimal Q - need to visit s,a infiintely often for each s,a. (basically GLIE without the greedy in the limit requirement). If you want to policy to converge to the optimal you need the full GLIE (all states and actions visited infintely many times and greedy in limit of exploration).</div><div><br></div></div></div>

    </body>
    </html>
  