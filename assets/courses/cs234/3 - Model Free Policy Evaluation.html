
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS234 - Lecture 3 - Model Free Policy Evaluation</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p>Def: <strong>Policy Evaluation</strong> is computing the value of all states given a particular policy <span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">\pi</script>. Policy evaluation can be wither <strong>model-based</strong> (requires the transition and reward probabilities) or <strong>model-free</strong> (does not require information about transitions and rewards)</p>
<p>Recall from Lecture 2: <strong>Model-Based Dynamic Programming Iterative Method for Policy Evaluation</strong><br>
For <span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.895em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">k</script> = 1... until convergence; For all states s:</p>
<ul>
<li><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7" style="width: 23.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.115em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 3.018em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="msubsup" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-11" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.485em, -0.497em); top: -2.013em; left: 0.655em;"><span class="mi" id="MathJax-Span-12" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-13" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-14" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-16" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-17" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-18" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-21" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-23" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-24" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-25" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-26" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-27" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-28" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-29" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="munderover" id="MathJax-Span-30" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.552em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="msup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.338em;"><span class="mo" id="MathJax-Span-36" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-37" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∈</span><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-39" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.507em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: STIXGeneral-Italic;">P</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.619em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-42" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-45" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-46"><span class="mrow" id="MathJax-Span-47"><span class="mo" id="MathJax-Span-48" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-50" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-51" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-52" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-53" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-54" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-55" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 1.969em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-57" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-58" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.485em, -0.497em); top: -2.013em; left: 0.655em;"><span class="texatom" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-62" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-63" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-66" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-67" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.321em; vertical-align: -0.413em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">V_k^\pi(s) = R^\pi(s,\pi(s)) + \gamma \sum_{s' \in S} P^\pi(s'|s, \pi(s))V^\pi_{k-1}(s')</script></li>
</ul>
<p>In Dynamic Programming, we use <span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-69" style="width: 3.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.491em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 3.006em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 1.969em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.485em, -0.497em); top: -2.013em; left: 0.655em;"><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mo" id="MathJax-Span-77" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-78" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-81" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-82" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.308em; vertical-align: -0.399em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">V^\pi_{k-1}(s')</script> as an estimate for the actual value of the reward at state <span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-84" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.265em, 1000em, 2.378em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-85"><span class="msup" id="MathJax-Span-86"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-87" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-88" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.986em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">s'</script>. This estimation is called <strong>bootstrapping</strong> (Appendix 1).</p>
<p>Cons:</p>
<ul>
<li>Requires assumption that state is Markov.</li>
<li>This is model-based: requires an explicit model of the reward function.</li>
</ul>
<h1>Model Free Policy Evaluation</h1>
<p>Def: <strong>Episode</strong>: A complete sample of a policy on the MDP until termination.<br>
Def: Below, let <span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-89" style="width: 18.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.441em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.463em, 1000em, 3.007em, -0.455em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-90"><span class="msubsup" id="MathJax-Span-91"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-93"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-98" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-99" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.836em, 1000em, 2.477em, -0.457em); top: -2.797em; left: 0.957em;"><span class="mi" id="MathJax-Span-101" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∞</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.485em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="msup" id="MathJax-Span-104"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-106" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-107" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-108" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-109" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.879em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-110" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.509em;"><span class="texatom" id="MathJax-Span-111"><span class="mrow" id="MathJax-Span-112"><span class="msup" id="MathJax-Span-113"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-115" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-117" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-118"><span style="display: inline-block; position: relative; width: 1.06em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.427em;"><span class="texatom" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="msup" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-124" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-126" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.122em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-134" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-135"><span style="display: inline-block; position: relative; width: 2.023em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-136" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-137"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-140" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-141" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-142" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-143" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-144" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-145" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">⋯</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.464em; vertical-align: -0.4em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">G_{i,t} = \sum_{t' = t}^\infty \gamma^{t'-t}r_{t'} = r_{i,t} + \gamma r_{i,t+1} + \cdots </script> be the expected reward for episode <span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-146" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.711em, 1000em, 2.714em, -0.458em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.863em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">i</script> starting at time <span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-149" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.743em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">t</script>.</p>
<h2>Monte Carlo Policy Evaluation</h2>
<p>Simulate the policy many times and average rewards recieved. Several variants exist (Appendix 2).<br>
This is performed once per episode. The value of every state is updated once the episode is completely sampled through.<br>
The most common variant for the update used is <strong>incremental every-visit MC</strong>, which performs the incremental update <span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-152" style="width: 14.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.401em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.952em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-155" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-158" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-159" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-160" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-161" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-162" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-164" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-165" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-166" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-167" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mo" id="MathJax-Span-169" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-171" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="mi" id="MathJax-Span-174" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-175" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-177" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-178" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-180" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-181" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-182" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-183" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.16em; vertical-align: -0.34em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">V^\pi(s) = V^\pi(s) + \alpha (G_{i,t} - V^\pi(s))</script> for each sampled episode. <span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-149" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.743em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">t</script> in <span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-185" style="width: 1.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.361em, 1000em, 2.615em, -0.455em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="msubsup" id="MathJax-Span-187"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-192" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.141em; vertical-align: -0.34em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">G_{i,t}</script> refers to the time when a particular state was seen according to some update rule in the episode, but the updates occur after the episode has already been run through.<br>
<span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-194" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-195"><span class="mi" id="MathJax-Span-196" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\alpha</script> is chosen <span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-197" style="width: 4.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.604em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.443em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-198"><span class="mo" id="MathJax-Span-199" style="font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-200" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mo" id="MathJax-Span-203" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-204" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-205" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-207" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\ge 1/N(s)</script> where <span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-208" style="width: 2.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.858em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.527em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral-Italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-211" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-213" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">N(s)</script> is the number of unique states visited so far. Other variants are <strong>first-visit MC</strong> and <strong>every-visit MC</strong> (Appendix 2).</p>
<p>(Note: We can apply the same Monte Carlo update, but to learn the state-action value function (aka Q function) instaed of the V function. In this case the update is<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" style=""><nobr><span class="math" id="MathJax-Span-214" style="width: 19.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.849em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.649em, 1000em, 2.952em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-217" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-219" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-220"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-221" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-223" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-224" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-228" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-229" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-230" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-232" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-234" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-236" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-237" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-239" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-240" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-241" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-242" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mo" id="MathJax-Span-243" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-245" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-246"><span class="mrow" id="MathJax-Span-247"><span class="mi" id="MathJax-Span-248" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-249" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-251" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-252" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-253" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-254" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-255" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-259" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-260" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-261" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-262" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-263" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.196em; vertical-align: -0.34em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">Q^\pi(s_t,a_t) = Q^\pi(s_t,a_t) + \alpha (G_{i,t} - Q^\pi(s_t,a_t)</script> This is the policy evaluation step used in Monte Carlo Control.)<p></p>
<p>Pros: Does not assume state is Markov.</p>
<p>Cons:</p>
<ul>
<li>Requires episodic settings (processes must terminate). In particular cannot handle settings with self-loops.</li>
<li>Generally a very high variance estimator, and reducing variance can require a lot of data.</li>
<li>Slow to update: Only one update every episode.</li>
</ul>
<h2>Temporal Difference (TD) learning</h2>
<p>This is the most popular method of the three. It is a combination of Monte Carlo and Dynamic Programming Methods. We sample episodes, but instead of updating at the termination of each episode, for every time step <span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-264" style="width: 6.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.025em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.882em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-265"><span class="mo" id="MathJax-Span-266" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-269" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-271" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-273" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-274" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-275" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-276" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-277" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-278" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-279" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-280" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-281"><span class="mrow" id="MathJax-Span-282"><span class="mi" id="MathJax-Span-283" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-284" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-286" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">(s_t,a_t,r_t,s_{t+1})</script> we observe in every episode we perform the bootstrapped update<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" style=""><nobr><span class="math" id="MathJax-Span-287" style="width: 21.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.707em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.649em, 1000em, 2.909em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="msubsup" id="MathJax-Span-289"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-290" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-291" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-292" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-293"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-294" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-295" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-296" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-298" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-299" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-302"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-303" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-304" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-305" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-306" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-307" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mo" id="MathJax-Span-308" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-309" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-310"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-311" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-313" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-314" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-318" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-320" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-321"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-324" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-325" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-326" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-327" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-328" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-329" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-331" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-332" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-334" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-335" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-336" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-337" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.148em; vertical-align: -0.291em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">V^\pi(s_t) = V^\pi(s_t) + \alpha ([r_t + \gamma V^\pi(s_{t+1})] - V^\pi(s_t))</script><p></p>
<p>Pros: Updates are applied much faster, after every action instaed of every episode, so generally much lower variance than Monte-Carlo Methods. Since we also bootstrap, TD can be used in episodic or infinite-horizon cases.</p>
<p>However, TD updates can take a bit longer to propagate than Monte Carlo, because you only update your reward for the state that you’re currently in. You don’t backpropagate the reward information to states that you previously visited, which happens in Monte Carlo.</p>
<p>(Note: We can apply the same TD update, but to learn the state-action value function (aka Q function) instaed of the V function. In this case we need to observe  <span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-338" style="width: 8.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.658em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.959em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-339"><span class="mo" id="MathJax-Span-340" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-341"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-342" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-343" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-344" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-345" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-346" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-347" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-348" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-349" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-350" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-352" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-353" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.45em;"><span class="texatom" id="MathJax-Span-355"><span class="mrow" id="MathJax-Span-356"><span class="msubsup" id="MathJax-Span-357"><span style="display: inline-block; position: relative; width: 0.547em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.212em;"><span class="mn" id="MathJax-Span-359" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-360" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-361" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-362" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-366" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-367" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-368" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.16em; vertical-align: -0.347em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">(s_t,a_t,r_t,s_{t_1}, a_{t+1})</script>, and the update is<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" style=""><nobr><span class="math" id="MathJax-Span-369" style="width: 28.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.649em, 1000em, 2.909em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="msubsup" id="MathJax-Span-371"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-372" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-374" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-375"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-376" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-377" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-378" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-379" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-380" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-382" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-383" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-384" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-385" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-386" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-387" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-388"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-389" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-390" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-391" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-392" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-393" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-394" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-395" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-396" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-397" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mo" id="MathJax-Span-398" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-399" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-401" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-403" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-404" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-405"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-407" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-409"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="mi" id="MathJax-Span-413" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-414" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-415" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-416" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-417" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-422" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-424" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-425" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-426" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-427" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-428" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-430" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-431"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-432" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-434" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-435" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-439" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.148em; vertical-align: -0.291em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">Q^\pi(s_t,a_t) = Q^\pi(s_t,a_t) + \alpha ([r_t + \gamma Q^\pi(s_{t+1},a_{t+1})] - Q^\pi(s_t,a_t))</script> This is the policy evaluation step used in SARSA.)<p></p>
</div><div class="cell markdown-cell"><p><img src="resources/80F9C4ACDE25FE29A3002EB7052B2F77.png" alt="Screenshot 2020-03-29 at 5.19.49 PM.png"></p>
<p><img src="resources/ECC99F9E89FB51787A6F20D109EFD8D9.png" alt="D0219E351F2C53A159E24444FEDDCED6.png"><img src="resources/CAD6F4593B3733569A98E5D818A1A751.png" alt="Screenshot 2020-03-29 at 5.28.14 PM.png"></p>
<p>TD[0] is bootstrapping after the first reward, TD[1] is boostrapping after the second reward, etc.</p>
<p><img src="resources/F960B6B2CDD767388AC20D2C268A6DC8.png" alt="Screenshot 2020-03-29 at 5.33.59 PM.png"></p>
<p><strong>Summary of the Three Methods:</strong></p>
<p>(See Appendix 3 for a case where MC/TD give different results)</p>
<p><img src="resources/2C4647864B515C9D6FCC24EC4F98EAD6.png" alt="Screenshot 2020-03-29 at 5.38.13 PM.png"></p>
<p>Rationale: DP and TD use bootstrapping. This handles onn-episodic domains, but is a biased estimate of value and requires the Markov Assumption.</p>
<p>DP is model-based learning (needs transition model), whereas MC/TD is model-free and requires no models. All three have convergence guarentees.</p>
<p><strong>Tradeoffs:</strong></p>
<p>If the world is not Markovian, you don’t want to make the Markov assumption and get wrong results, so Monte Carlo is better.</p>
<p>If the world is Markov, TD is a lot faster.</p>
<p><img src="resources/2B479980A4E3B8658397BC5CFFA39CF5.png" alt="Screenshot 2020-03-29 at 5.39.50 PM.png"></p>
<p><img src="resources/93A40A2A3E390F2E4BF994C249966D2F.png" alt="Screenshot 2020-03-29 at 5.43.31 PM.png"></p>
<p>(TD[0] converges to DP policy V^\pi for the MDP with the maximum likelihood estimates for teh dynamics and the reward model)</p>
<p><img src="resources/2A407A2AA543263442C8782C0350D0C7.png" alt="Screenshot 2020-03-29 at 6.11.05 PM.png"></p>
<p><strong>Appendix 1: Policy Evaluation - Dynamic Programming</strong></p>
<p>Note that in the Dynamic Programming method we are bootstrapping the future expected rewards by using <span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><span class="math" id="MathJax-Span-440" style=""><span class="noError" id="MathJax-Span-441" style="display: inline-block;">V\_{k-1}^\\pi</span></span></span><script type="math/tex" id="MathJax-Element-20">V\_{k-1}^\\pi</script> as a stand-in for the sum of future rewards. In policy evaluation, this is precise (not an estimate) because we are in the model-based case, but in the model-free case generally using this substitution would be a biased estimate.<img src="resources/E7598067BAFF7E84BEC5102B948827CD.png" alt="Screenshot 2020-03-29 at 4.38.07 PM.png"></p>
<p>**<br>
**</p>
<p><strong>Appendix 2: Variants of Monte Carlo Policy Evaluation</strong></p>
<p><img src="resources/22E6BAEF8FDBA9AB3C9FAF1288696870.png" alt="Screenshot 2020-03-29 at 4.51.11 PM.png"></p>
<p>No bias becuase the state information you use is iid.</p>
<p><img src="resources/12F03A01B6DBB3B019DB050DAE09142D.png" alt="Screenshot 2020-03-29 at 4.52.12 PM.png"></p>
<p><img src="resources/377F8360ED47B712B2FF11D37D3154B0.png" alt="Screenshot 2020-03-29 at 4.53.45 PM.png"></p>
<p>(Equivalent Formulation to Every-visit Monte Carlo)</p>
<p>If you go to a state multiple times in every episode, your returns are correlated so it’s no longer iid. But its still consistent and has a lot lower variance.</p>
<p><img src="resources/D937C8F9B57D21A2736AA670B8A3DCA4.png" alt="Screenshot 2020-03-29 at 4.54.56 PM.png"></p>
<p><img src="resources/230953C2490FB6C9098039108C7B0244.png" alt="Screenshot 2020-03-29 at 5.09.17 PM.png"></p>
<p><strong>Appendix 3: Different between the three methods for model-free policy evaluation:</strong></p>
<p><img src="resources/58955319D8391FAE1B1A0F0202D3B69C.png" alt="Screenshot 2020-03-29 at 5.43.24 PM.png"></p>
<p>The above supposes the online case- being able to sample the above observations many many times, and perfomring updates each time.</p>
<p>V(A) = 0 in ML estimation, but V(B) = 3/4 in TD estimation.</p>
<p><strong>Appendix 4: Stats Recap</strong></p>
<p><img src="resources/CEDDC70FE93EB63C43ADB260A7CD1038.png" alt="Screenshot 2020-03-29 at 4.48.42 PM.png"></p>
<p>Mean Squred Error is Bias^2 + Variance</p>
</div></div>
    </body>
    </html>
  