
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
    
      <div id="titlearea">
        <h2>CS234 - Lecture 9 - Policy Gradient 2</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p>Desired Properties of a Policy Gradient RL Algorithm</p>
<ul>
<li>Obtain large monotonic improvements with each timestep. =&gt; Make it more efficient and less noisy.</li>
<li>Note that DQN is not monotonically improving</li>
</ul>
<h2>Baselines:</h2>
<p>The Policy Gradient Update without Baseline<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-269-Frame" style=""><nobr><span class="math" id="MathJax-Span-7549" style="width: 28.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.444em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-7550"><span class="msubsup" id="MathJax-Span-7551"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7552" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7553" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7554" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-7555" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7556" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-7557" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7558" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7559" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7560" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7561" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7562"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-7563"><span class="mrow" id="MathJax-Span-7564"><span class="mi" id="MathJax-Span-7565" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-7566"><span class="mrow" id="MathJax-Span-7567"><span class="mi" id="MathJax-Span-7568" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÑ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-7569" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="msubsup" id="MathJax-Span-7570"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7571" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-7572" style="font-size: 50%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7573" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-7574" style="font-family: STIXGeneral-Italic;">R</span><span class="mo" id="MathJax-Span-7575" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7576" style="font-family: STIXGeneral-Italic;">œÑ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-7577" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7578" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-7579" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7580" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-7581"><span class="mrow" id="MathJax-Span-7582"><span class="mi" id="MathJax-Span-7583" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-7584"><span class="mrow" id="MathJax-Span-7585"><span class="mi" id="MathJax-Span-7586" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÑ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-7587" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="msubsup" id="MathJax-Span-7588"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7589" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-7590" style="font-size: 50%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-7591" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-7592" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="munderover" id="MathJax-Span-7593"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7594" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7595"><span class="mrow" id="MathJax-Span-7596"><span class="mi" id="MathJax-Span-7597" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7598" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7599" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-7600"><span class="mrow" id="MathJax-Span-7601"><span class="mi" id="MathJax-Span-7602" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7603" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7604" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7605" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7606" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-7607"><span class="mrow" id="MathJax-Span-7608"><span class="mo" id="MathJax-Span-7609" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7610" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7611" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-7612" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7613" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãÖ</span><span class="msubsup" id="MathJax-Span-7614" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7615" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7616" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7617" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-7618"></span><span class="msubsup" id="MathJax-Span-7619" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7620" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-7621"><span class="mrow" id="MathJax-Span-7622"><span class="mi" id="MathJax-Span-7623" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7624" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7625"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7626" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7627" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7628"><span class="mrow" id="MathJax-Span-7629"><span class="mo" id="MathJax-Span-7630" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7631"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7632" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7633" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7634" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7635" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-269">\nabla_\theta V(\theta) = \nabla_\theta \mathbb{E}_{\tau \sim \pi_\theta} [R(\tau)]   = \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} G_t^{(i)} \cdot \nabla_\theta \log \pi_{\theta} (a_t|s_t) \right]</script><br>
using <span class="MathJax" id="MathJax-Element-270-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7636" style="width: 7.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.757em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.399em, 1000em, 3.033em, -0.455em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7637"><span class="msubsup" id="MathJax-Span-7638"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7639" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-7640"><span class="mrow" id="MathJax-Span-7641"><span class="mo" id="MathJax-Span-7642" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7643" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7644" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-7645" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7646" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-7647" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7648" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.477em, -0.465em); top: -2.797em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7649"><span class="mrow" id="MathJax-Span-7650"><span class="mi" id="MathJax-Span-7651" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7652" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7653" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.485em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7654"><span class="mrow" id="MathJax-Span-7655"><span class="msup" id="MathJax-Span-7656"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7657" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-7658" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-7659" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-7660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7661" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.314em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7662" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7663"><span class="mrow" id="MathJax-Span-7664"><span class="mo" id="MathJax-Span-7665" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7666" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7667" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(3.342em, 1000em, 4.174em, -0.48em); top: -3.675em; left: 0.427em;"><span class="texatom" id="MathJax-Span-7668"><span class="mrow" id="MathJax-Span-7669"><span class="msup" id="MathJax-Span-7670"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7671" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-7672" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.564em; vertical-align: -0.429em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-270">G_t^{(i)} = \sum_{t' = t}^{T-1} r_{t'}^{(i)}</script> is quite noisy. One way to reduce the variance is to use a baseline, which is using <span class="MathJax" id="MathJax-Element-271-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7673" style="width: 11.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.91em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.399em, 1000em, 3.033em, -0.455em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7674"><span class="msubsup" id="MathJax-Span-7675"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7676" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-7677"><span class="mrow" id="MathJax-Span-7678"><span class="mo" id="MathJax-Span-7679" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7680" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7681" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-7682" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7683" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-7684" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7685" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.477em, -0.465em); top: -2.797em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7686"><span class="mrow" id="MathJax-Span-7687"><span class="mi" id="MathJax-Span-7688" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7689" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7690" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.485em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7691"><span class="mrow" id="MathJax-Span-7692"><span class="msup" id="MathJax-Span-7693"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7694" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-7695" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-7696" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-7697" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7698" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.314em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7699" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7700"><span class="mrow" id="MathJax-Span-7701"><span class="mo" id="MathJax-Span-7702" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7703" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7704" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(3.342em, 1000em, 4.174em, -0.48em); top: -3.675em; left: 0.427em;"><span class="texatom" id="MathJax-Span-7705"><span class="mrow" id="MathJax-Span-7706"><span class="msup" id="MathJax-Span-7707"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7708" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-7709" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7710" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-7711" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span><span class="mo" id="MathJax-Span-7712" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7713"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7714" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7715" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7716" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.564em; vertical-align: -0.429em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-271">G_t^{(i)} = \sum_{t' = t}^{T-1} r_{t'}^{(i)} - b(s_t)</script>, substracting off a baseline which only depends on the current state being evaluated. The most common and optimal baseline is the value function as the baseline (<span class="MathJax" id="MathJax-Element-272-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7717" style="width: 14.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.288em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.882em, -0.484em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7718"><span class="mi" id="MathJax-Span-7719" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-7720" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7721"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7722" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7723" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7724" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7725" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-7726" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-7727"><span class="mi" id="MathJax-Span-7728" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span class="mo" id="MathJax-Span-7729" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-7730"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7731" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7732" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7733" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-7734" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.629em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7735" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-7736"><span class="mrow" id="MathJax-Span-7737"><span class="mi" id="MathJax-Span-7738" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7739" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7740" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7741" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-7742" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãØ</span><span class="mo" id="MathJax-Span-7743" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-7744" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.854em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7745" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-7746"><span class="mrow" id="MathJax-Span-7747"><span class="mi" id="MathJax-Span-7748" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7749" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7750" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7751" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.082em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-272">b(s_t) = \mathbb{E}[r_t + r_{t+1} + \cdots + r_{T-1}]</script>).<p></p>
<p>The interpretation of the update is now, increase the logprob of action <span class="MathJax" id="MathJax-Element-273-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7752" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.49em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7753"><span class="msubsup" id="MathJax-Span-7754"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7755" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7756" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">a_t</script> proportionally to how much returns <span class="MathJax" id="MathJax-Element-274-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7757" style="width: 4.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.885em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.061em, 1000em, 2.695em, -0.449em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7758"><span class="munderover" id="MathJax-Span-7759"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7760" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.477em, -0.465em); top: -2.797em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7761"><span class="mrow" id="MathJax-Span-7762"><span class="mi" id="MathJax-Span-7763" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7764" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7765" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.601em, 1000em, 2.485em, -0.48em); top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7766"><span class="mrow" id="MathJax-Span-7767"><span class="msup" id="MathJax-Span-7768"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7769" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.279em;"><span class="mo" id="MathJax-Span-7770" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-7771" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-7772" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7773" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.314em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7774" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7775"><span class="mrow" id="MathJax-Span-7776"><span class="mo" id="MathJax-Span-7777" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7778" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7779" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(3.342em, 1000em, 4.174em, -0.48em); top: -3.675em; left: 0.427em;"><span class="texatom" id="MathJax-Span-7780"><span class="mrow" id="MathJax-Span-7781"><span class="msup" id="MathJax-Span-7782"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7783" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.279em;"><span class="mo" id="MathJax-Span-7784" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.564em; vertical-align: -0.429em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">\sum_{t' = t}^{T-1} r_{t'}^{(i)}</script> are better than expected.</p>
<p>Note: Changing the logprob is equivalent to the update multiplicatively scaling the weight instead of arithmetically adding to it.</p>
<h2>The Vanilla Policy Gradient Update</h2>
</div><div class="cell text-cell"><img src="resources/03BC2D3FFBA0ACB025C54231BE0FC2F7.png" alt="Screenshot 2020-04-03 at 2.11.26 PM.png" width="551" height="385"><div></div></div><div class="cell markdown-cell"><p><strong>Vanilla Policy Gradient Algorithm</strong><br>
You start with an initial policy parameters and an initial estimate of the baseline.<br>
For each iteration,</p>
<ul>
<li>Collect trajectories by executing th ecurrent policy</li>
<li>Compute the return <span class="MathJax" id="MathJax-Element-275-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7785" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.172em, 1000em, 2.62em, -0.455em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7786"><span class="msubsup" id="MathJax-Span-7787"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7788" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.702em; left: 0.732em;"><span class="mi" id="MathJax-Span-7789" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.732em;"><span class="mi" id="MathJax-Span-7790" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.358em; vertical-align: -0.346em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-275">G_t^i</script> and the advantage estimate <span class="MathJax" id="MathJax-Element-276-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7791" style="width: 7.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.419em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.507em, 1000em, 2.958em, -0.558em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7792"><span class="msubsup" id="MathJax-Span-7793"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7794" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.704em; left: 0.619em;"><span class="mi" id="MathJax-Span-7795" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-7796" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7797" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7798" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7799" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.702em; left: 0.732em;"><span class="mi" id="MathJax-Span-7800" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.732em;"><span class="mi" id="MathJax-Span-7801" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7802" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-7803" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">b</span><span class="mo" id="MathJax-Span-7804" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7805"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7806" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7807" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7808" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.36em; vertical-align: -0.346em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-276">A_t^i = G_t^i - b(s_t)</script></li>
<li>You have to refit the baseline by minimizing <span class="MathJax" id="MathJax-Element-277-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7809" style="width: 9.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.39em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.484em, 1000em, 3.007em, -0.449em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7810"><span class="munderover" id="MathJax-Span-7811"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7812" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="mi" id="MathJax-Span-7813" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7814" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7815" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="mi" id="MathJax-Span-7816" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7817" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7818"><span class="mo" id="MathJax-Span-7819" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="texatom" id="MathJax-Span-7820"><span class="mrow" id="MathJax-Span-7821"><span class="mo" id="MathJax-Span-7822" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-7823" style="font-family: STIXGeneral-Italic;">b</span><span class="mo" id="MathJax-Span-7824" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7825"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7826" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7827" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7828" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7829" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="msubsup" id="MathJax-Span-7830" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7831" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.485em, -0.472em); top: -2.702em; left: 0.732em;"><span class="mi" id="MathJax-Span-7832" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.732em;"><span class="mi" id="MathJax-Span-7833" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7834"><span class="mrow" id="MathJax-Span-7835"><span class="mo" id="MathJax-Span-7836" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7837"><span style="display: inline-block; position: relative; width: 0.694em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.44em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-7838"><span class="mrow" id="MathJax-Span-7839"><span class="mo" id="MathJax-Span-7840" style="font-family: STIXGeneral-Regular;">|</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.225em;"><span class="mn" id="MathJax-Span-7841" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.44em; vertical-align: -0.4em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-277">\sum_i \sum_t || b(s_t) - G_t ^i|| ^2 </script> in the vanilla case or some other loss in other cases.</li>
<li>Update the policy using a gradient estimate <span class="MathJax" id="MathJax-Element-278-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7842" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.278em, 1000em, 2.571em, -0.795em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7843"><span class="texatom" id="MathJax-Span-7844"><span class="mrow" id="MathJax-Span-7845"><span class="munderover" id="MathJax-Span-7846"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.499em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7847" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.073em; left: 0.098em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7848" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.185em; vertical-align: -0.291em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-278">\hat g</script> as per the equation</li>
</ul>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-279-Frame" style=""><nobr><span class="math" id="MathJax-Span-7849" style="width: 20.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.468em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.444em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-7850"><span class="msubsup" id="MathJax-Span-7851"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7852" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7853" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7854" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-7855" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7856" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-7857" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7858" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7859" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.271em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-7860"><span class="mrow" id="MathJax-Span-7861"><span class="mi" id="MathJax-Span-7862" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-7863"><span class="mrow" id="MathJax-Span-7864"><span class="mi" id="MathJax-Span-7865" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÑ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-7866" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="msubsup" id="MathJax-Span-7867"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7868" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-7869" style="font-size: 50%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-7870" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-7871" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="munderover" id="MathJax-Span-7872"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7873" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7874"><span class="mrow" id="MathJax-Span-7875"><span class="mi" id="MathJax-Span-7876" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7877" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7878" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-7879"><span class="mrow" id="MathJax-Span-7880"><span class="mi" id="MathJax-Span-7881" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7882" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7883" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7884" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7885" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.619em;"><span class="texatom" id="MathJax-Span-7886"><span class="mrow" id="MathJax-Span-7887"><span class="mo" id="MathJax-Span-7888" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7889" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7890" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.619em;"><span class="mi" id="MathJax-Span-7891" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7892" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãÖ</span><span class="msubsup" id="MathJax-Span-7893" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7894" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7895" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7896" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-7897"></span><span class="msubsup" id="MathJax-Span-7898" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7899" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-7900"><span class="mrow" id="MathJax-Span-7901"><span class="mi" id="MathJax-Span-7902" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7903" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7904"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7905" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7906" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7907"><span class="mrow" id="MathJax-Span-7908"><span class="mo" id="MathJax-Span-7909" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7910"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7911" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7912" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7913" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7914" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-279">\nabla_\theta V(\theta) = \mathbb{E}_{\tau \sim \pi_\theta} \left[ \sum_{t=0}^{T-1} A_t^{(i)} \cdot \nabla_\theta \log \pi_{\theta} (a_t|s_t) \right]</script><p></p>
<p>Most of the time its best to use on-policy data for the baseline, but sometimes estimating the baseline using off-policy data also works.</p>
<h2>Actor-Critic:</h2>
<p>Actor-Critic is now the mainstream RL algorithm in business settings when it is applicable, because it is more stable than other methods.</p>
<p>Recall our Original Monte Carlo update equation for value iteration was:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-280-Frame" style=""><nobr><span class="math" id="MathJax-Span-7915" style="width: 19.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.568em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.587em, 1000em, 3.963em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7916"><span class="msubsup" id="MathJax-Span-7917"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7918" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7919" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7920" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-7921" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7922" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-7923" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7924" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-7925" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.852em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-7926" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.924em, 1000em, 2.712em, -0.495em); top: -1.848em; left: 50%; margin-left: -0.366em;"><span class="mi" id="MathJax-Span-7927" style="font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 0.852em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7928" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7929" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.585em, -0.472em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7930"><span class="mrow" id="MathJax-Span-7931"><span class="mi" id="MathJax-Span-7932" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7933" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7934" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.728em, 1000em, 2.484em, -0.498em); top: -3.509em; left: 0.394em;"><span class="mi" id="MathJax-Span-7935" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-7936" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7937" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7938"><span class="mrow" id="MathJax-Span-7939"><span class="mi" id="MathJax-Span-7940" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7941" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-7942" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.562em, 1000em, 2.477em, -0.465em); top: -3.509em; left: 0em;"><span class="texatom" id="MathJax-Span-7943"><span class="mrow" id="MathJax-Span-7944"><span class="mi" id="MathJax-Span-7945" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7946" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mn" id="MathJax-Span-7947" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7948" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7949" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-7950"><span class="mrow" id="MathJax-Span-7951"><span class="mo" id="MathJax-Span-7952" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7953" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7954" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-7955" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7956" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãÖ</span><span class="msubsup" id="MathJax-Span-7957" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7958" style="font-family: STIXGeneral-Regular;">‚àá</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="mi" id="MathJax-Span-7959" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7960" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-7961"></span><span class="msubsup" id="MathJax-Span-7962" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7963" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-7964"><span class="mrow" id="MathJax-Span-7965"><span class="mi" id="MathJax-Span-7966" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7967" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7968"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7969" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7970" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7971"><span class="mrow" id="MathJax-Span-7972"><span class="mo" id="MathJax-Span-7973" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7974"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7975" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7976" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7977" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.497em; vertical-align: -1.461em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-280">\nabla_\theta V(\theta)   = \frac{1}{m} \sum_{i=1}^m \sum_{t=0}^{T-1} G_t^{(i)} \cdot \nabla_\theta \log \pi_{\theta} (a_t|s_t)</script><br>
<span class="MathJax" id="MathJax-Element-281-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7978" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.079em, 1000em, 2.594em, -0.455em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7979"><span class="msubsup" id="MathJax-Span-7980"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7981" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-7982"><span class="mrow" id="MathJax-Span-7983"><span class="mo" id="MathJax-Span-7984" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7985" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7986" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-7987" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.431em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-281">G_t^{(i)}</script> is an estimation of the value function <span class="MathJax" id="MathJax-Element-282-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7988" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.59em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.487em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7989"><span class="msubsup" id="MathJax-Span-7990"><span style="display: inline-block; position: relative; width: 1.119em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7991" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.361em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7992"><span class="mrow" id="MathJax-Span-7993"><span class="msubsup" id="MathJax-Span-7994"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7995" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-7996" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7997" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7998"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7999" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8000" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8001" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-282">v^{\pi_i}(s_t)</script> at <span class="MathJax" id="MathJax-Element-283-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8002" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8003"><span class="msubsup" id="MathJax-Span-8004"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8005" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8006" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-283">s_t</script> from a single trajectory. It is biased but has high variance.<br>
Just as we saw in TD vs MC, we can reduce the variance by introducing bias using function approximation and bootstrapping.<br>
We call a function to compute the value of <span class="MathJax" id="MathJax-Element-284-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8007" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8008"><span class="mi" id="MathJax-Span-8009" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.87em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-284">V</script> or <span class="MathJax" id="MathJax-Element-285-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8010" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8011"><span class="mi" id="MathJax-Span-8012" style="font-family: STIXGeneral-Italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-285">Q</script> of a policy a <strong>critic</strong>. We could potentially change our target <span class="MathJax" id="MathJax-Element-281-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7978" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.079em, 1000em, 2.594em, -0.455em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7979"><span class="msubsup" id="MathJax-Span-7980"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.455em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7981" style="font-family: STIXGeneral-Italic;">G</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.778em; left: 0.732em;"><span class="texatom" id="MathJax-Span-7982"><span class="mrow" id="MathJax-Span-7983"><span class="mo" id="MathJax-Span-7984" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7985" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7986" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.087em; left: 0.732em;"><span class="mi" id="MathJax-Span-7987" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.431em; vertical-align: -0.317em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-281">G_t^{(i)}</script> to the critic estimate to learn the appropriate update.<br>
<strong>Actor-Critic methods</strong> maintian an explicit representation of policy and the value function, and update both.<br>
Most popular actor critic algorithm is A3c Mninh et al 2016.<p></p>
<h3>N-Step Estimators</h3>
<p>In Actor-Critic, we do not have to make a hard choice between bootstrapping and using a pure monte-carlo estimate. N-step estimators are interpolations between Monte Carlo and TD-learning estimators.<br>
Define<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-286-Frame" style=""><nobr><span class="math" id="MathJax-Span-8013" style="width: 15.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.077em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.692em, 1000em, 4.584em, -0.572em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8014"><span class="mtable" id="MathJax-Span-8015" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 13.701em; height: 0px;"><span style="position: absolute; clip: rect(3.024em, 1000em, 8.299em, -0.739em); top: -5.912em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.663em, 1000em, 4.422em, -0.739em); top: -5.551em; right: 0em;"><span class="mtd" id="MathJax-Span-8016"><span class="mrow" id="MathJax-Span-8017"><span class="msubsup" id="MathJax-Span-8018"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.868em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8019"><span class="mrow" id="MathJax-Span-8020"><span class="munderover" id="MathJax-Span-8021"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8022" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8023" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.996em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8024"><span class="mrow" id="MathJax-Span-8025"><span class="mo" id="MathJax-Span-8026" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8027" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8028" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8029" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.663em, 1000em, 4.422em, -0.739em); top: -3.793em; right: 0em;"><span class="mtd" id="MathJax-Span-8048"><span class="mrow" id="MathJax-Span-8049"><span class="msubsup" id="MathJax-Span-8050"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.868em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8051"><span class="mrow" id="MathJax-Span-8052"><span class="munderover" id="MathJax-Span-8053"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8054" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8055" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.996em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8056"><span class="mrow" id="MathJax-Span-8057"><span class="mo" id="MathJax-Span-8058" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8059" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8060" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8061" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.663em, 1000em, 4.422em, -0.739em); top: -2.035em; right: 0em;"><span class="mtd" id="MathJax-Span-8092"><span class="mrow" id="MathJax-Span-8093"><span class="msubsup" id="MathJax-Span-8094"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.868em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8095"><span class="mrow" id="MathJax-Span-8096"><span class="munderover" id="MathJax-Span-8097"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.52em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8098" style="font-family: STIXGeneral-Italic;">R</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8099" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -2.996em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8100"><span class="mrow" id="MathJax-Span-8101"><span class="mo" id="MathJax-Span-8102" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8103" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8104" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8105" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.912em;"></span></span><span style="position: absolute; clip: rect(3.063em, 1000em, 7.85em, -0.209em); top: -5.462em; left: 1.595em;"><span style="display: inline-block; position: relative; width: 12.106em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.209em); top: -4.087em; left: 0em;"><span class="mtd" id="MathJax-Span-8030"><span class="mrow" id="MathJax-Span-8031"><span class="mo" id="MathJax-Span-8032" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8033"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8034" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8035" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8036" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8037" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-8038" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8039" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8040"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8041" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8042"><span class="mrow" id="MathJax-Span-8043"><span class="mi" id="MathJax-Span-8044" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8045" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8046" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8047" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.474em, 1000em, 2.909em, -0.209em); top: -2.329em; left: 0em;"><span class="mtd" id="MathJax-Span-8062"><span class="mrow" id="MathJax-Span-8063"><span class="mo" id="MathJax-Span-8064" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8065"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8066" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8067" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8068" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8069" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-8070"><span style="display: inline-block; position: relative; width: 1.629em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8071" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-8072"><span class="mrow" id="MathJax-Span-8073"><span class="mi" id="MathJax-Span-8074" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8075" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8076" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8077" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-8078" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8079" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mn" id="MathJax-Span-8080" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8081" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8082" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8083"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8084" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8085"><span class="mrow" id="MathJax-Span-8086"><span class="mi" id="MathJax-Span-8087" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8088" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8089" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8090" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8091" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">‚ãØ</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.474em, 1000em, 2.959em, -0.209em); top: -0.571em; left: 0em;"><span class="mtd" id="MathJax-Span-8106"><span class="mrow" id="MathJax-Span-8107"><span class="mo" id="MathJax-Span-8108" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8109"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8110" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8111" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8112" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8113" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-8114" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8115" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8116"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8117" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8118"><span class="mrow" id="MathJax-Span-8119"><span class="mi" id="MathJax-Span-8120" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8121" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8122" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8123" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8124" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-8125" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8126" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mn" id="MathJax-Span-8127" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8128"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8129" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.427em;"><span class="texatom" id="MathJax-Span-8130"><span class="mrow" id="MathJax-Span-8131"><span class="msubsup" id="MathJax-Span-8132"><span style="display: inline-block; position: relative; width: 0.547em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8133" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.212em;"><span class="mn" id="MathJax-Span-8134" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8135" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-8136" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãØ</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.462em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.607em; vertical-align: -2.526em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-286">\begin{align}   \hat R_t^{(1)} & = r_t + \gamma V(s_{t+1}) \\    \hat R_t^{(1)} & = r_t + \gamma r_{t+1} + \gamma^2 V(s_{t+2}) \cdots \\     \hat R_t^{(1)} & = r_t + \gamma V(s_{t+1}) + \gamma^2 r_{t_2} + \cdots \end{align}</script><br>
and, subtracting baselines from above,<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-287-Frame" style=""><nobr><span class="math" id="MathJax-Span-8137" style="width: 19.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.399em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.715em, 1000em, 4.607em, -0.572em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8138"><span class="mtable" id="MathJax-Span-8139" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 17.023em; height: 0px;"><span style="position: absolute; clip: rect(3.058em, 1000em, 8.378em, -0.739em); top: -5.968em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.648em, 1000em, 4.422em, -0.739em); top: -5.559em; right: 0em;"><span class="mtd" id="MathJax-Span-8140"><span class="mrow" id="MathJax-Span-8141"><span class="msubsup" id="MathJax-Span-8142"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.853em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8143"><span class="mrow" id="MathJax-Span-8144"><span class="munderover" id="MathJax-Span-8145"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8146" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.3em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8147" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -3.011em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8148"><span class="mrow" id="MathJax-Span-8149"><span class="mo" id="MathJax-Span-8150" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8151" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8152" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8153" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.648em, 1000em, 4.422em, -0.739em); top: -3.785em; right: 0em;"><span class="mtd" id="MathJax-Span-8179"><span class="mrow" id="MathJax-Span-8180"><span class="msubsup" id="MathJax-Span-8181"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.853em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8182"><span class="mrow" id="MathJax-Span-8183"><span class="munderover" id="MathJax-Span-8184"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8185" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.3em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8186" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -3.011em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8187"><span class="mrow" id="MathJax-Span-8188"><span class="mo" id="MathJax-Span-8189" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8190" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8191" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8192" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.648em, 1000em, 4.422em, -0.739em); top: -2.012em; right: 0em;"><span class="mtd" id="MathJax-Span-8230"><span class="mrow" id="MathJax-Span-8231"><span class="msubsup" id="MathJax-Span-8232"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.853em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8233"><span class="mrow" id="MathJax-Span-8234"><span class="munderover" id="MathJax-Span-8235"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8236" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.3em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8237" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -3.011em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8238"><span class="mrow" id="MathJax-Span-8239"><span class="mo" id="MathJax-Span-8240" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8241" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8242" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8243" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.968em;"></span></span><span style="position: absolute; clip: rect(3.056em, 1000em, 7.872em, -0.209em); top: -5.462em; left: 1.595em;"><span style="display: inline-block; position: relative; width: 15.428em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.209em); top: -4.095em; left: 0em;"><span class="mtd" id="MathJax-Span-8154"><span class="mrow" id="MathJax-Span-8155"><span class="mo" id="MathJax-Span-8156" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8157"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8158" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8159" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8160" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8161" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-8162" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8163" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8164"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8165" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8166"><span class="mrow" id="MathJax-Span-8167"><span class="mi" id="MathJax-Span-8168" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8169" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8170" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8171" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8172" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-8173" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8174" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8175"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8176" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8177" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8178" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.474em, 1000em, 2.909em, -0.209em); top: -2.321em; left: 0em;"><span class="mtd" id="MathJax-Span-8193"><span class="mrow" id="MathJax-Span-8194"><span class="mo" id="MathJax-Span-8195" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8196"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8197" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8198" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8199" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8200" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-8201"><span style="display: inline-block; position: relative; width: 1.629em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8202" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="texatom" id="MathJax-Span-8203"><span class="mrow" id="MathJax-Span-8204"><span class="mi" id="MathJax-Span-8205" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8206" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8207" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8208" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-8209" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8210" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mn" id="MathJax-Span-8211" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8212" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8213" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8214"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8215" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8216"><span class="mrow" id="MathJax-Span-8217"><span class="mi" id="MathJax-Span-8218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8219" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8220" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8221" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8222" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">‚ãØ</span><span class="mo" id="MathJax-Span-8223" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-8224" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8225" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8226"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8227" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8228" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8229" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.474em, 1000em, 2.959em, -0.209em); top: -0.548em; left: 0em;"><span class="mtd" id="MathJax-Span-8244"><span class="mrow" id="MathJax-Span-8245"><span class="mo" id="MathJax-Span-8246" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8247"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8248" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8249" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8250" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8251" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mi" id="MathJax-Span-8252" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8253" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8254"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8255" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8256"><span class="mrow" id="MathJax-Span-8257"><span class="mi" id="MathJax-Span-8258" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8259" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8260" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8261" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8262" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-8263" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.978em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8264" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mn" id="MathJax-Span-8265" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8266"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8267" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.427em;"><span class="texatom" id="MathJax-Span-8268"><span class="mrow" id="MathJax-Span-8269"><span class="msubsup" id="MathJax-Span-8270"><span style="display: inline-block; position: relative; width: 0.547em; height: 0px;"><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8271" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.212em;"><span class="mn" id="MathJax-Span-8272" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8273" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-8274" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãØ</span><span class="mo" id="MathJax-Span-8275" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-8276" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8277" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8278"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8279" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8280" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8281" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.462em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 5.656em; vertical-align: -2.551em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-287">\begin{align}   \hat A_t^{(1)} & = r_t + \gamma V(s_{t+1}) - V(s_t)\\    \hat A_t^{(1)} & = r_t + \gamma r_{t+1} + \gamma^2 V(s_{t+2}) \cdots - V(s_t)\\     \hat A_t^{(1)} & = r_t + \gamma V(s_{t+1}) + \gamma^2 r_{t_2} + \cdots - V(s_t) \end{align}</script><p></p>
<p><span class="MathJax" id="MathJax-Element-288-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8282" style="width: 1.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.633em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.846em, 1000em, 2.62em, -0.739em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8283"><span class="msubsup" id="MathJax-Span-8284"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(2.853em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8285"><span class="mrow" id="MathJax-Span-8286"><span class="munderover" id="MathJax-Span-8287"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8288" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.3em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8289" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -3.011em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8290"><span class="mrow" id="MathJax-Span-8291"><span class="mo" id="MathJax-Span-8292" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8293" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8294" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8295" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.719em; vertical-align: -0.346em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-288">\hat A_t^{(1)}</script> is the TD learnign return and has low variance and high bias. <span class="MathJax" id="MathJax-Element-289-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8296" style="width: 2.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.846em, 1000em, 2.62em, -0.739em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8297"><span class="msubsup" id="MathJax-Span-8298"><span style="display: inline-block; position: relative; width: 1.877em; height: 0px;"><span style="position: absolute; clip: rect(2.853em, 1000em, 4.167em, -0.739em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-8299"><span class="mrow" id="MathJax-Span-8300"><span class="munderover" id="MathJax-Span-8301"><span style="display: inline-block; position: relative; width: 0.619em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8302" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.3em; left: 0.154em;"><span style="height: 0em; vertical-align: 0em; width: 0.386em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8303" style="font-family: STIXGeneral-Regular; margin-left: -0.386em;">ÃÇ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.473em); top: -3.011em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8304"><span class="mrow" id="MathJax-Span-8305"><span class="mo" id="MathJax-Span-8306" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8307" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àû</span><span class="mo" id="MathJax-Span-8308" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.754em, 1000em, 2.485em, -0.48em); top: -2.061em; left: 0.619em;"><span class="mi" id="MathJax-Span-8309" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.719em; vertical-align: -0.346em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-289">\hat A_t^{(\infty)}</script> is the Monte Carlo return and has high variance but low bias. Using intermediate <span class="MathJax" id="MathJax-Element-290-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8310" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.714em, -0.493em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8311"><span class="mi" id="MathJax-Span-8312" style="font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.895em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-290">k</script>, say 20, can give an intermediate amount of bias and variance. Note that the TD learning case makes a strong Markovian domain, but requires less data. THe Monte Carlo case makes no Markovian assumptions but requires more data.</p>
<p><strong>Actor-critic should be the default method of RL that you use.</strong></p>
<h2>Policy Gradient and Step Sizes</h2>
<p>We would like to ensure <strong>monotonic improvement</strong> in expectation: that our updated policy <span class="MathJax" id="MathJax-Element-291-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8313" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.265em, 1000em, 2.383em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8314"><span class="msup" id="MathJax-Span-8315"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8316" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-8317" style="font-size: 70.7%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.991em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-291">\pi'</script> has value greater than or equal to the prior policy <span class="MathJax" id="MathJax-Element-292-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8318" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8319"><span class="mi" id="MathJax-Span-8320" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-292">\pi</script>: <span class="MathJax" id="MathJax-Element-293-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8321" style="width: 4.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.223em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.446em, 1000em, 2.806em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8322"><span class="msubsup" id="MathJax-Span-8323"><span style="display: inline-block; position: relative; width: 1.609em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8324" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-8325"><span class="mrow" id="MathJax-Span-8326"><span class="msup" id="MathJax-Span-8327"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8328" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.451em;"><span class="mo" id="MathJax-Span-8329" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8330" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-8331" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8332" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="texatom" id="MathJax-Span-8333"><span class="mrow" id="MathJax-Span-8334"><span class="mi" id="MathJax-Span-8335" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.26em; vertical-align: -0.177em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-293">V^{\pi'} \ge V^{\pi}</script> (in expectation). To do that we need to estimate the advantage of the new policy.</p>
<p>Step size is particularly imporant in RL because if you step into a bad policy subspace, you will affect future policies and may never get out of it.</p>
<h3>Conservative Policy Iteration</h3>
<p>Express value of the new policy in terms of the advantage over the original policy:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-294-Frame" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 100%; display: inline-block; min-width: 21.505em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 21.505em;"><span style="position: absolute; clip: rect(2.098em, 1000em, 5.51em, -0.507em); top: -4.054em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-8337"><span class="mtable" id="MathJax-Span-8338" style="min-width: 21.505em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.505em;"><span style="display: inline-block; position: absolute; width: 15.541em; height: 0px; clip: rect(-1.956em, 1000em, 1.456em, -0.431em); top: 0em; left: 50%; margin-left: -7.77em;"><span style="position: absolute; clip: rect(2.098em, 1000em, 5.51em, -0.431em); top: -4.054em; left: 0em;"><span style="display: inline-block; position: relative; width: 15.541em; height: 0px;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.431em); top: -4.11em; left: 50%; margin-left: -7.77em;"><span class="mtd" id="MathJax-Span-8342"><span class="mrow" id="MathJax-Span-8343"><span class="mi" id="MathJax-Span-8344" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8345" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-8346"><span class="mrow" id="MathJax-Span-8347"><span class="munderover" id="MathJax-Span-8348"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8349" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.122em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8350" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-8351" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8352" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-8353" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8354" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8355" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8356" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8357" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-8358" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8359"><span class="mrow" id="MathJax-Span-8360"><span class="mi" id="MathJax-Span-8361" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8362"><span class="mrow" id="MathJax-Span-8363"><span class="mi" id="MathJax-Span-8364" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mi" id="MathJax-Span-8365" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8366" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8367" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="munderover" id="MathJax-Span-8368"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8369" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-8370"><span class="mrow" id="MathJax-Span-8371"><span class="mi" id="MathJax-Span-8372" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8373" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-8374" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.736em, 1000em, 2.477em, -0.457em); top: -3.509em; left: 0.31em;"><span class="mi" id="MathJax-Span-8375" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àû</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8376" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8377" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-8378" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8379"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8380" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-8381" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8382" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8383"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8384" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8385" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8386" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8387" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8388" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8389" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8390" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8391" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.054em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(-0.845em, 1000em, 0.346em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -2.534em; right: 0em;"><span class="mtd" id="mjx-eqn-1_1"><span class="mrow" id="MathJax-Span-8340"><span class="mtext" id="MathJax-Span-8341" style="font-family: STIXGeneral-Regular;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.054em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-294">V(\tilde \theta) = V(\theta) + \mathbb{E}_{\pi\theta} \left[\sum_{t=0}^\infty \gamma^t A_\pi (s_t,a_t) \right] \tag{1}</script><br>
<div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-295-Frame" style=""><nobr><span class="math" id="MathJax-Span-8392" style="width: 100%; display: inline-block; min-width: 21.787em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 21.787em;"><span style="position: absolute; clip: rect(2.266em, 1000em, 5.229em, -0.507em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-8393"><span class="mtable" id="MathJax-Span-8394" style="min-width: 21.787em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 21.787em;"><span style="display: inline-block; position: absolute; width: 15.822em; height: 0px; clip: rect(-1.731em, 1000em, 1.231em, -0.459em); top: 0em; left: 50%; margin-left: -7.911em;"><span style="position: absolute; clip: rect(2.266em, 1000em, 5.229em, -0.459em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 15.822em; height: 0px;"><span style="position: absolute; clip: rect(1.39em, 1000em, 4.352em, -0.459em); top: -3.121em; left: 50%; margin-left: -7.911em;"><span class="mtd" id="MathJax-Span-8398"><span class="mrow" id="MathJax-Span-8399"><span class="mo" id="MathJax-Span-8400" style="font-family: STIXGeneral-Regular;">=</span><span class="mi" id="MathJax-Span-8401" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8402" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8403" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8404" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8405" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-8406" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8407" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-8408" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-8409" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.266em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 4.887em, -0.507em); top: -3.998em; left: 0.469em;"><span class="munderover" id="MathJax-Span-8410"><span style="display: inline-block; position: relative; width: 2.328em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.956em, -0.54em); top: -2.534em; left: 0.094em;"><span class="mrow" id="MathJax-Span-8411"><span class="msubsup" id="MathJax-Span-8412"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8413" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.757em; left: 0.563em;"><span class="texatom" id="MathJax-Span-8414"><span class="mrow" id="MathJax-Span-8415"><span class="texatom" id="MathJax-Span-8416"><span class="mrow" id="MathJax-Span-8417"><span class="munderover" id="MathJax-Span-8418"><span style="display: inline-block; position: relative; width: 0.394em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8419" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.065em; left: 0.12em;"><span style="height: 0em; vertical-align: 0em; width: 0.279em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8420" style="font-size: 70.7%; font-family: STIXGeneral-Regular; margin-left: -0.279em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.507em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8421" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8422" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8423" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.528em, 1000em, 2.131em, -0.507em); top: -1.241em; left: 0em;"><span class="mo" id="MathJax-Span-8424" style=""><span style="font-family: STIXSizeFourSym;">‚èü</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.732em, -0.507em); top: -0.913em; left: 0em;"><span class="mtext" id="MathJax-Span-8425" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">new policy</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-8426" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8427" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.585em, -0.495em); top: -1.159em; left: 0.479em;"><span class="mi" id="MathJax-Span-8428" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8429" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-8430"><span class="munderover" id="MathJax-Span-8431"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8432" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.035em; left: 0.162em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8433" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-8434" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8435" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8436"><span class="mrow" id="MathJax-Span-8437"><span class="mo" id="MathJax-Span-8438" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8439" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8440" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8441"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8442" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-8443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8444" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8445" style="font-family: STIXGeneral-Italic;">s</span><span class="texatom" id="MathJax-Span-8446"><span class="mrow" id="MathJax-Span-8447"><span class="mo" id="MathJax-Span-8448" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8449" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-8450" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(-1.432em, 1000em, -0.241em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -3.121em; right: 0em;"><span class="mtd" id="mjx-eqn-2_1"><span class="mrow" id="MathJax-Span-8396"><span class="mtext" id="MathJax-Span-8397" style="font-family: STIXGeneral-Regular;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.038em; vertical-align: -1.242em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-295"> = V(\theta) + \sum_s \underbrace{\mu_{\tilde \pi}(s)}_\text{new policy} \sum_a \tilde \pi (a|s) A_\pi (s|a) \tag{2}</script><br>
where <span class="MathJax" id="MathJax-Element-296-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8451" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.14em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.956em, -0.54em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8452"><span class="msubsup" id="MathJax-Span-8453"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8454" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.757em; left: 0.563em;"><span class="texatom" id="MathJax-Span-8455"><span class="mrow" id="MathJax-Span-8456"><span class="texatom" id="MathJax-Span-8457"><span class="mrow" id="MathJax-Span-8458"><span class="munderover" id="MathJax-Span-8459"><span style="display: inline-block; position: relative; width: 0.394em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8460" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.065em; left: 0.12em;"><span style="height: 0em; vertical-align: 0em; width: 0.279em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8461" style="font-size: 70.7%; font-family: STIXGeneral-Regular; margin-left: -0.279em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.507em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8462" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8463" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8464" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.156em; vertical-align: -0.343em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-296">\mu_{\tilde \pi}(s)</script> is the discounted weighted frequency of state <span class="MathJax" id="MathJax-Element-297-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8465" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8466"><span class="mi" id="MathJax-Span-8467" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-297">s</script> under polict <span class="MathJax" id="MathJax-Element-298-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8468" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.352em, 1000em, 2.383em, -0.739em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8469"><span class="texatom" id="MathJax-Span-8470"><span class="mrow" id="MathJax-Span-8471"><span class="munderover" id="MathJax-Span-8472"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8473" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.035em; left: 0.162em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8474" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-298">\tilde \pi</script> (similar to imitaiton learning). (1) -&gt; (2) is changing from averaging over timesteps to averaging over states using the new stationary distrbution. The right-hand sum in (2) refers to the advantage in each policy for some action, multiplied by the probability we take that action, starting from some state which is determined by our new policy <span class="MathJax" id="MathJax-Element-298-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8468" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.352em, 1000em, 2.383em, -0.739em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8469"><span class="texatom" id="MathJax-Span-8470"><span class="mrow" id="MathJax-Span-8471"><span class="munderover" id="MathJax-Span-8472"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8473" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.035em; left: 0.162em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8474" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.894em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-298">\tilde \pi</script>. In this case advantage is defined in terms of <span class="MathJax" id="MathJax-Element-285-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8010" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8011"><span class="mi" id="MathJax-Span-8012" style="font-family: STIXGeneral-Italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-285">Q</script>-values.<br>
However we can't compute the above because we don't know <span class="MathJax" id="MathJax-Element-299-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8475" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.618em, -0.54em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8476"><span class="msubsup" id="MathJax-Span-8477"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8478" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.757em; left: 0.563em;"><span class="texatom" id="MathJax-Span-8479"><span class="mrow" id="MathJax-Span-8480"><span class="texatom" id="MathJax-Span-8481"><span class="mrow" id="MathJax-Span-8482"><span class="munderover" id="MathJax-Span-8483"><span style="display: inline-block; position: relative; width: 0.394em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8484" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.065em; left: 0.12em;"><span style="height: 0em; vertical-align: 0em; width: 0.279em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8485" style="font-size: 70.7%; font-family: STIXGeneral-Regular; margin-left: -0.279em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.507em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.881em; vertical-align: -0.343em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-299">\mu_{\tilde \pi}</script>, the state distribution over hte new policy. We only have data from our old policy.<p></p>
<p>We make the <strong>local approximation assumption</strong>, that <span class="MathJax" id="MathJax-Element-300-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8486" style="width: 3.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.435em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.89em, 1000em, 2.956em, -0.54em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8487"><span class="msubsup" id="MathJax-Span-8488"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8489" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.563em;"><span class="texatom" id="MathJax-Span-8490"><span class="mrow" id="MathJax-Span-8491"><span class="mi" id="MathJax-Span-8492" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8493" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚âà</span><span class="msubsup" id="MathJax-Span-8494" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8495" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.757em; left: 0.563em;"><span class="texatom" id="MathJax-Span-8496"><span class="mrow" id="MathJax-Span-8497"><span class="texatom" id="MathJax-Span-8498"><span class="mrow" id="MathJax-Span-8499"><span class="munderover" id="MathJax-Span-8500"><span style="display: inline-block; position: relative; width: 0.394em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8501" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.065em; left: 0.12em;"><span style="height: 0em; vertical-align: 0em; width: 0.279em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8502" style="font-size: 70.7%; font-family: STIXGeneral-Regular; margin-left: -0.279em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.507em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.933em; vertical-align: -0.343em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-300">\mu_{\pi} \approx \mu_{\tilde \pi}</script>, that is, we can use the state distribution from our old policy to estimate the state distribution of the new policy. Now we have:</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-301-Frame" style=""><nobr><span class="math" id="MathJax-Span-8503" style="width: 100%; display: inline-block; min-width: 27.643em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%; min-width: 27.643em;"><span style="position: absolute; clip: rect(2.266em, 1000em, 5.229em, -0.507em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-8504"><span class="mtable" id="MathJax-Span-8505" style="min-width: 27.643em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 27.643em;"><span style="display: inline-block; position: absolute; width: 21.678em; height: 0px; clip: rect(-1.731em, 1000em, 1.231em, -0.431em); top: 0em; left: 50%; margin-left: -10.839em;"><span style="position: absolute; clip: rect(2.266em, 1000em, 5.229em, -0.431em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 21.678em; height: 0px;"><span style="position: absolute; clip: rect(1.39em, 1000em, 4.352em, -0.431em); top: -3.121em; left: 50%; margin-left: -10.839em;"><span class="mtd" id="MathJax-Span-8509"><span class="mrow" id="MathJax-Span-8510"><span class="mi" id="MathJax-Span-8511" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8512" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-8513"><span class="mrow" id="MathJax-Span-8514"><span class="munderover" id="MathJax-Span-8515"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8516" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.122em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8517" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-8518" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8519" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚âà</span><span class="msubsup" id="MathJax-Span-8520" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.086em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8521" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.616em;"><span class="texatom" id="MathJax-Span-8522"><span class="mrow" id="MathJax-Span-8523"><span class="mi" id="MathJax-Span-8524" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8525" style="font-family: STIXGeneral-Regular;">(</span><span class="texatom" id="MathJax-Span-8526"><span class="mrow" id="MathJax-Span-8527"><span class="munderover" id="MathJax-Span-8528"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8529" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.035em; left: 0.162em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8530" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-8531" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8532" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-8533" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8534" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8535" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8536" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8537" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-8538" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8539" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-8540" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-8541" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.984em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 4.887em, -0.507em); top: -3.998em; left: 0.328em;"><span class="munderover" id="MathJax-Span-8542"><span style="display: inline-block; position: relative; width: 2.328em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.956em, -0.54em); top: -2.534em; left: 0.094em;"><span class="mrow" id="MathJax-Span-8543"><span class="msubsup" id="MathJax-Span-8544"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8545" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.563em;"><span class="texatom" id="MathJax-Span-8546"><span class="mrow" id="MathJax-Span-8547"><span class="mi" id="MathJax-Span-8548" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8549" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8550" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8551" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.528em, 1000em, 2.131em, -0.507em); top: -1.241em; left: 0em;"><span class="mo" id="MathJax-Span-8552" style=""><span style="font-family: STIXSizeFourSym;">‚èü</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.732em, -0.507em); top: -0.913em; left: 0em;"><span class="mtext" id="MathJax-Span-8553" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">old policy</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="munderover" id="MathJax-Span-8554" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8555" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.585em, -0.495em); top: -1.159em; left: 0.479em;"><span class="mi" id="MathJax-Span-8556" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8557" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-8558"><span class="munderover" id="MathJax-Span-8559"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8560" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.035em; left: 0.162em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8561" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">ÃÉ&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-8562" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8563" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8564"><span class="mrow" id="MathJax-Span-8565"><span class="mo" id="MathJax-Span-8566" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8567" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8568" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8569"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8570" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="mi" id="MathJax-Span-8571" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8572" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8573" style="font-family: STIXGeneral-Italic;">s</span><span class="texatom" id="MathJax-Span-8574"><span class="mrow" id="MathJax-Span-8575"><span class="mo" id="MathJax-Span-8576" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8577" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-8578" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.182em; height: 0px; clip: rect(-1.432em, 1000em, -0.241em, -0.507em); top: 0em; right: 0em; margin-left: 0.9em; margin-right: 0.9em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.507em); top: -3.121em; right: 0em;"><span class="mtd" id="mjx-eqn-2_2"><span class="mrow" id="MathJax-Span-8507"><span class="mtext" id="MathJax-Span-8508" style="font-family: STIXGeneral-Regular;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.038em; vertical-align: -1.242em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-301">V(\tilde \theta) \approx L_{\pi}(\tilde \pi) := V(\theta) + \sum_s \underbrace{\mu_{\pi}(s)}_\text{old policy} \sum_a \tilde \pi (a|s) A_\pi (s|a) \tag{2}</script><br>
Note that <span class="MathJax" id="MathJax-Element-302-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8579" style="width: 10.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.009em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8580"><span class="msubsup" id="MathJax-Span-8581"><span style="display: inline-block; position: relative; width: 1.086em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8582" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.616em;"><span class="mi" id="MathJax-Span-8583" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8584" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8585" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-8586" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8587" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-8588" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8589" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8590" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-8591" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8592" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-8593" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-8594" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8595" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8596" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-302">L_\pi(\pi) = V(\pi) := V(\theta)</script> is just the original value function.<p></p>
<p><strong>Lower Bounds, mixture policy case</strong><br>
Consider a mixture policy which is an interpolation between the old policy and a differnet policy<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-303-Frame" style=""><nobr><span class="math" id="MathJax-Span-8597" style="width: 17.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.709em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.552em, 1000em, 2.88em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8598"><span class="msubsup" id="MathJax-Span-8599"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8600" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8601"><span class="mrow" id="MathJax-Span-8602"><span class="mi" id="MathJax-Span-8603" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-8604" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-8605" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8606" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8607" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8608"><span class="mrow" id="MathJax-Span-8609"><span class="mo" id="MathJax-Span-8610" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8611" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8612" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8613" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-8614" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="mn" id="MathJax-Span-8615" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8616" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-8617" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ±</span><span class="mo" id="MathJax-Span-8618" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8619"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8620" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8621"><span class="mrow" id="MathJax-Span-8622"><span class="mi" id="MathJax-Span-8623" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-8624" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-8625" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8626" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8627" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8628"><span class="mrow" id="MathJax-Span-8629"><span class="mo" id="MathJax-Span-8630" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8631" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8632" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8633" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8634" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ±</span><span class="msup" id="MathJax-Span-8635"><span style="display: inline-block; position: relative; width: 0.979em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8636" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.623em;"><span class="mo" id="MathJax-Span-8637" style="font-size: 70.7%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8638" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8639" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8640"><span class="mrow" id="MathJax-Span-8641"><span class="mo" id="MathJax-Span-8642" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8643" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8644" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.223em; vertical-align: -0.259em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-303">\pi_{new}(a|s) = (1-\alpha) \pi_{old}(a|s) + \alpha \pi' (a|s)</script><br>
In this case, we can guarentee a lower bound on the value of the new <span class="MathJax" id="MathJax-Element-304-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8645" style="width: 2.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.802em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.528em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8646"><span class="msubsup" id="MathJax-Span-8647"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8648" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8649"><span class="mrow" id="MathJax-Span-8650"><span class="mi" id="MathJax-Span-8651" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-8652" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-8653" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.781em; vertical-align: -0.243em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-304">\pi_{new}</script> (we will call <span class="MathJax" id="MathJax-Element-305-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8654" style="width: 5.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.842em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.882em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8655"><span class="msubsup" id="MathJax-Span-8656"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8657" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8658"><span class="mrow" id="MathJax-Span-8659"><span class="mi" id="MathJax-Span-8660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8661" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8662" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8663" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8664" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8665" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8666"><span class="mrow" id="MathJax-Span-8667"><span class="mi" id="MathJax-Span-8668" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-8669" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-8670" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.799em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-305">\pi_{i+1} = \pi_{new}</script> and <span class="MathJax" id="MathJax-Element-306-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8671" style="width: 4.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.716em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.862em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8672"><span class="msubsup" id="MathJax-Span-8673"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8674" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-8675" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8676" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8677" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8678" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8679"><span class="mrow" id="MathJax-Span-8680"><span class="mi" id="MathJax-Span-8681" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-8682" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-8683" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.777em; vertical-align: -0.239em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-306">\pi_i = \pi_{old}</script> for simplicity):<p></p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-307-Frame" style=""><nobr><span class="math" id="MathJax-Span-8684" style="width: 31.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.716em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.621em, 1000em, 4.39em, -0.431em); top: -3.153em; left: 0em;"><span class="mrow" id="MathJax-Span-8685"><span class="msubsup" id="MathJax-Span-8686"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8687" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.805em;"><span class="texatom" id="MathJax-Span-8688"><span class="mrow" id="MathJax-Span-8689"><span class="msubsup" id="MathJax-Span-8690"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8691" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-8692"><span class="mrow" id="MathJax-Span-8693"><span class="mi" id="MathJax-Span-8694" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8695" style="font-size: 50%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8696" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8697" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-8698" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8699" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-8700"><span class="mrow" id="MathJax-Span-8701"><span class="msubsup" id="MathJax-Span-8702"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8703" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-8704" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8705" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8706"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8707" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8708"><span class="mrow" id="MathJax-Span-8709"><span class="mi" id="MathJax-Span-8710" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8711" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8712" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8713" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8714" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mfrac" id="MathJax-Span-8715" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 3.442em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.478em); top: -3.221em; left: 50%; margin-left: -0.704em;"><span class="mrow" id="MathJax-Span-8716"><span class="mn" id="MathJax-Span-8717" style="font-family: STIXGeneral-Regular;">2</span><span class="mi" id="MathJax-Span-8718" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mi" id="MathJax-Span-8719" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.484em, 1000em, 2.909em, -0.459em); top: -1.672em; left: 50%; margin-left: -1.661em;"><span class="mrow" id="MathJax-Span-8720"><span class="mo" id="MathJax-Span-8721" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-8722" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-8723" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-8724" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-8725"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8726" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-8727" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.442em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8728" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8729" style="font-family: STIXGeneral-Italic;">Œ±</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.563em;"><span class="mn" id="MathJax-Span-8730" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8731" style="font-family: STIXGeneral-Regular;">,</span><span class="mspace" id="MathJax-Span-8732" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-8733" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-8734" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">where&nbsp;</span><span class="mi" id="MathJax-Span-8735" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mo" id="MathJax-Span-8736" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-8737" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8738" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.624em; left: 0.704em;"><span class="mi" id="MathJax-Span-8739" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8740" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8741" style="vertical-align: 0.775em;"><span style="display: inline-block; position: relative; width: 0.266em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.308em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.136em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8742"><span style="display: inline-block; position: relative; width: 3.679em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8743"><span class="mrow" id="MathJax-Span-8744"><span class="mi" id="MathJax-Span-8745" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8746"><span class="mrow" id="MathJax-Span-8747"><span class="mi" id="MathJax-Span-8748" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-8749" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="msup" id="MathJax-Span-8750"><span style="display: inline-block; position: relative; width: 0.729em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8751" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.451em;"><span class="mo" id="MathJax-Span-8752" style="font-size: 50%; font-family: STIXVariants;">‚Ä≤</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-8753" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8754" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8755"><span class="mrow" id="MathJax-Span-8756"><span class="mo" id="MathJax-Span-8757" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8758" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8759" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8760" style="font-family: STIXGeneral-Regular;">[</span><span class="msubsup" id="MathJax-Span-8761"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8762" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-8763"><span class="mrow" id="MathJax-Span-8764"><span class="mi" id="MathJax-Span-8765" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8766" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8767" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8768" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8769" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8770" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8771" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-8772" style="vertical-align: 0.775em;"><span style="display: inline-block; position: relative; width: 0.266em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.308em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.136em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.153em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.823em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-307">V^{\pi_{i+1}} \ge L_{\pi_i}(\pi_{i+1}) - \frac{2 \epsilon \gamma}{(1-\gamma)^2}\alpha^2 , \;\;\text{where } \epsilon = \max_s \left| \mathbb{E}_{a \sim \pi ' (a|s)}[A_{\pi}(s,a)] \right|</script><p></p>
<p><strong>Lower Bounds, General Case</strong><br>
Def: The <strong>distance of total variation</strong> between two policies <span class="MathJax" id="MathJax-Element-308-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8773" style="width: 20.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.806em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8774"><span class="msubsup" id="MathJax-Span-8775"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8776" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8777"><span class="mrow" id="MathJax-Span-8778"><span class="mi" id="MathJax-Span-8779" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-8780" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8781" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8782"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8783" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8784" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8785" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8786" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8787"><span class="mrow" id="MathJax-Span-8788"><span class="mo" id="MathJax-Span-8789" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8790" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8791" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8792" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8793" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8794" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8795" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8796" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8797" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8798"><span class="mrow" id="MathJax-Span-8799"><span class="mo" id="MathJax-Span-8800" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8801" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8802" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8803" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8804" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-8805" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.215em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8806" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="mi" id="MathJax-Span-8807" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8808" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-8809"><span class="mo" id="MathJax-Span-8810" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8811"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8812" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8813" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8814" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8815" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-8816"><span class="mrow" id="MathJax-Span-8817"><span class="mo" id="MathJax-Span-8818" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8819" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8820" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8821" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="msubsup" id="MathJax-Span-8822" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8823" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8824" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8825" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8826"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8827" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8828" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8829" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-8830"><span class="mrow" id="MathJax-Span-8831"><span class="mo" id="MathJax-Span-8832" style="font-family: STIXGeneral-Regular;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-308">D_{TV}(\pi_1(\cdot | s) , \pi_2(\cdot | s)) = \max_a | \pi_1(a|s) - \pi_2(a_s)|</script> as the maximum difference in action probability between the two policies over all actions.<br>
Def: Let <span class="MathJax" id="MathJax-Element-309-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8833" style="width: 18.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.836em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.673em, 1000em, 2.985em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8834"><span class="msubsup" id="MathJax-Span-8835"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8836" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8837"><span class="mrow" id="MathJax-Span-8838"><span class="mi" id="MathJax-Span-8839" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-8840" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-8841" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.49em, -0.465em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8842"><span class="mrow" id="MathJax-Span-8843"><span class="mi" id="MathJax-Span-8844" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-8845" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8846" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8847"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8848" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8849" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8850" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8851" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8852" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8853" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8854" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8855" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-8856" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8857" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="mi" id="MathJax-Span-8858" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8859" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8860" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8861"><span class="mrow" id="MathJax-Span-8862"><span class="mi" id="MathJax-Span-8863" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-8864" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8865" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8866"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8867" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8868" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8869" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8870" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8871"><span class="mrow" id="MathJax-Span-8872"><span class="mo" id="MathJax-Span-8873" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8874" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8875" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8876" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8877" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8878" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8879" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8880" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8881" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8882"><span class="mrow" id="MathJax-Span-8883"><span class="mo" id="MathJax-Span-8884" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8885" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8886" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8887" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.206em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-309">D_{TV}^{max}(\pi_1,\pi_2) = \max_s D_{TV} (\pi_1(\cdot | s) , \pi_2(\cdot | s))</script><br>
Def: The <strong>KL divergence</strong> between two policies is the regular KL distance <span class="MathJax" id="MathJax-Element-310-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8888" style="width: 8.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.052em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8889"><span class="msubsup" id="MathJax-Span-8890"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8891" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8892"><span class="mrow" id="MathJax-Span-8893"><span class="mi" id="MathJax-Span-8894" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-8895" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8896" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8897"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8898" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8899" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8900" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8901" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8902"><span class="mrow" id="MathJax-Span-8903"><span class="mo" id="MathJax-Span-8904" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8905" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8906" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8907" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8908" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8909" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8910" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8911" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8912" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8913"><span class="mrow" id="MathJax-Span-8914"><span class="mo" id="MathJax-Span-8915" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8916" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8917" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8918" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-310">D_{KL}(\pi_1(\cdot | s) , \pi_2(\cdot | s))</script>.<br>
Def: Let <span class="MathJax" id="MathJax-Element-311-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8919" style="width: 18.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.836em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.673em, 1000em, 2.972em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8920"><span class="msubsup" id="MathJax-Span-8921"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8922" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8923"><span class="mrow" id="MathJax-Span-8924"><span class="mi" id="MathJax-Span-8925" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-8926" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-8927" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8928"><span class="mrow" id="MathJax-Span-8929"><span class="mi" id="MathJax-Span-8930" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-8931" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8932" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8933"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8934" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8935" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8936" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8937" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8938" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8939" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8940" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8941" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-8942" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8943" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="mi" id="MathJax-Span-8944" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8945" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8946" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8947"><span class="mrow" id="MathJax-Span-8948"><span class="mi" id="MathJax-Span-8949" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-8950" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8951" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8952"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8953" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8954" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8955" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8956" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8957"><span class="mrow" id="MathJax-Span-8958"><span class="mo" id="MathJax-Span-8959" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8960" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8961" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8962" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8963" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8964" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mn" id="MathJax-Span-8965" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8966" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8967" style="font-family: STIXGeneral-Regular;">‚ãÖ</span><span class="texatom" id="MathJax-Span-8968"><span class="mrow" id="MathJax-Span-8969"><span class="mo" id="MathJax-Span-8970" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8971" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8972" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8973" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.192em; vertical-align: -0.362em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-311">D_{KL}^{max}(\pi_1,\pi_2) = \max_s D_{KL} (\pi_1(\cdot | s) , \pi_2(\cdot | s))</script></p>
<p><strong>Theorem</strong>:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-312-Frame" style=""><nobr><span class="math" id="MathJax-Span-8974" style="width: 33.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.462em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.565em, 1000em, 4.334em, -0.431em); top: -3.097em; left: 0em;"><span class="mrow" id="MathJax-Span-8975"><span class="msubsup" id="MathJax-Span-8976"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8977" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.805em;"><span class="texatom" id="MathJax-Span-8978"><span class="mrow" id="MathJax-Span-8979"><span class="msubsup" id="MathJax-Span-8980"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8981" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-8982"><span class="mrow" id="MathJax-Span-8983"><span class="mi" id="MathJax-Span-8984" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8985" style="font-size: 50%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8986" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8987" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-8988" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8989" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-8990"><span class="mrow" id="MathJax-Span-8991"><span class="msubsup" id="MathJax-Span-8992"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8993" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-8994" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-8995" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8996"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8997" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8998"><span class="mrow" id="MathJax-Span-8999"><span class="mi" id="MathJax-Span-9000" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9001" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9002" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9003" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9004" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mfrac" id="MathJax-Span-9005" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 3.442em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.495em); top: -3.221em; left: 50%; margin-left: -0.704em;"><span class="mrow" id="MathJax-Span-9006"><span class="mn" id="MathJax-Span-9007" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-9008" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mi" id="MathJax-Span-9009" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.484em, 1000em, 2.909em, -0.459em); top: -1.672em; left: 50%; margin-left: -1.661em;"><span class="mrow" id="MathJax-Span-9010"><span class="mo" id="MathJax-Span-9011" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-9012" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-9013" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-9014" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-9015"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9016" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-9017" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.442em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9018" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9019" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9020"><span class="mrow" id="MathJax-Span-9021"><span class="mi" id="MathJax-Span-9022" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-9023" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-9024" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.49em, -0.465em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9025"><span class="mrow" id="MathJax-Span-9026"><span class="mi" id="MathJax-Span-9027" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-9028" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9029" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9030"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9031" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9032" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9033" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9034" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9035" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9036"><span class="mrow" id="MathJax-Span-9037"><span class="mi" id="MathJax-Span-9038" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9039" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9040" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9041"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9042" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.338em;"><span class="mn" id="MathJax-Span-9043" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9044" style="font-family: STIXGeneral-Regular;">,</span><span class="mspace" id="MathJax-Span-9045" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-9046" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-9047" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">where&nbsp;</span><span class="mi" id="MathJax-Span-9048" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mo" id="MathJax-Span-9049" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-9050" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9051" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.624em; left: 0.704em;"><span class="mi" id="MathJax-Span-9052" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9053" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9054" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mrow" id="MathJax-Span-9055" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-9056" style="vertical-align: 0.677em;"><span style="display: inline-block; position: relative; width: 0.266em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.308em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.333em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9057"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9058" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9059"><span class="mrow" id="MathJax-Span-9060"><span class="mi" id="MathJax-Span-9061" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9062" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9063" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9064" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9065" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-9066" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9067" style="vertical-align: 0.677em;"><span style="display: inline-block; position: relative; width: 0.266em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.308em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.333em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.097em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.823em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-312">V^{\pi_{i+1}} \ge  L_{\pi_i}(\pi_{i+1}) - \frac{4 \epsilon \gamma}{(1-\gamma)^2}D_{TV}^{max}(\pi_i,\pi_{i+1})^2, \;\;\text{where }\epsilon = \max_s,a \left| A_{\pi}(s,a) \right|</script><p></p>
<p>We can also use <span class="MathJax" id="MathJax-Element-313-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9068" style="width: 10.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.628em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.484em, 1000em, 2.912em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9069"><span class="msubsup" id="MathJax-Span-9070"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9071" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9072"><span class="mrow" id="MathJax-Span-9073"><span class="mi" id="MathJax-Span-9074" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-9075" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9076" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9077" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-9078" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9079" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="msubsup" id="MathJax-Span-9080"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9081" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-9082" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9083" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â§</span><span class="msubsup" id="MathJax-Span-9084" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.764em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9085" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9086"><span class="mrow" id="MathJax-Span-9087"><span class="mi" id="MathJax-Span-9088" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-9089" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9090" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9091" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-9092" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9093" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span><span class="mo" id="MathJax-Span-9094" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.335em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-313">D_{TV}(p,q)^2 \le D_{KL}(p,q)</script> for prob distributions <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9095" style="width: 1.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9096"><span class="mi" id="MathJax-Span-9097" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-9098" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9099" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">p,q</script> to get:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-315-Frame" style=""><nobr><span class="math" id="MathJax-Span-9100" style="width: 39.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 35.191em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.565em, 1000em, 4.334em, -0.431em); top: -3.097em; left: 0em;"><span class="mrow" id="MathJax-Span-9101"><span class="msubsup" id="MathJax-Span-9102"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9103" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9104"><span class="mrow" id="MathJax-Span-9105"><span class="msubsup" id="MathJax-Span-9106"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9107" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-9108"><span class="mrow" id="MathJax-Span-9109"><span class="mi" id="MathJax-Span-9110" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9111" style="font-size: 50%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9112" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9113" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-9114" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9115" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9116" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9117" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9118"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9119" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9120"><span class="mrow" id="MathJax-Span-9121"><span class="mi" id="MathJax-Span-9122" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9123" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9124" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9125" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9126" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:<span style="font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;">=</span></span><span class="msubsup" id="MathJax-Span-9127" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9128" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-9129"><span class="mrow" id="MathJax-Span-9130"><span class="msubsup" id="MathJax-Span-9131"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9132" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-9133" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9134" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9135"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9136" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9137"><span class="mrow" id="MathJax-Span-9138"><span class="mi" id="MathJax-Span-9139" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9140" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9141" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9142" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9143" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mfrac" id="MathJax-Span-9144" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 3.442em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.495em); top: -3.221em; left: 50%; margin-left: -0.704em;"><span class="mrow" id="MathJax-Span-9145"><span class="mn" id="MathJax-Span-9146" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-9147" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mi" id="MathJax-Span-9148" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.484em, 1000em, 2.909em, -0.459em); top: -1.672em; left: 50%; margin-left: -1.661em;"><span class="mrow" id="MathJax-Span-9149"><span class="mo" id="MathJax-Span-9150" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-9151" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-9152" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-9153" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-9154"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9155" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-9156" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.442em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9157" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9158" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9159"><span class="mrow" id="MathJax-Span-9160"><span class="mi" id="MathJax-Span-9161" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-9162" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-9163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9164"><span class="mrow" id="MathJax-Span-9165"><span class="mi" id="MathJax-Span-9166" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-9167" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9168" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9169"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9170" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9171" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9172" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9173" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9174" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9175"><span class="mrow" id="MathJax-Span-9176"><span class="mi" id="MathJax-Span-9177" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9178" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9179" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9180" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9181" style="font-family: STIXGeneral-Regular;">,</span><span class="mspace" id="MathJax-Span-9182" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-9183" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mtext" id="MathJax-Span-9184" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">where&nbsp;</span><span class="mi" id="MathJax-Span-9185" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mo" id="MathJax-Span-9186" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-9187" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9188" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.624em; left: 0.704em;"><span class="mi" id="MathJax-Span-9189" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9190" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9191" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mrow" id="MathJax-Span-9192" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-9193" style="vertical-align: 0.677em;"><span style="display: inline-block; position: relative; width: 0.266em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.308em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.333em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9194"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9195" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9196"><span class="mrow" id="MathJax-Span-9197"><span class="mi" id="MathJax-Span-9198" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9199" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9200" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9201" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9202" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-9203" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9204" style="vertical-align: 0.677em;"><span style="display: inline-block; position: relative; width: 0.266em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.308em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -3.333em; left: 0em;">‚à£<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.097em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.823em; vertical-align: -1.248em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-315">V^{\pi_{i+1}} \ge  M_i(\pi_{i+1}) := L_{\pi_i}(\pi_{i+1}) - \frac{4 \epsilon \gamma}{(1-\gamma)^2}D_{KL}^{max}(\pi_i,\pi_{i+1}), \;\;\text{where }\epsilon = \max_s,a \left| A_{\pi}(s,a) \right|</script><p></p>
<p>This is a lower bound for the value of the new policy, which we call <span class="MathJax" id="MathJax-Element-316-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9205" style="width: 1.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.182em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.374em, 1000em, 2.523em, -0.525em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-9206"><span class="msubsup" id="MathJax-Span-9207"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9208" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9209" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.025em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-316">M_i</script> above. Note that<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-317-Frame" style=""><nobr><span class="math" id="MathJax-Span-9210" style="width: 22.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.989em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.002em, 1000em, 4.495em, -0.525em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9211"><span class="msubsup" id="MathJax-Span-9212"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9213" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9214" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9215" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9216"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9217" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9218" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9219" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9220" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-9221" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px;"><span style="position: absolute; clip: rect(3.153em, 1000em, 4.902em, -0.507em); top: -3.998em; left: 0em;"><span class="munderover" id="MathJax-Span-9222"><span style="display: inline-block; position: relative; width: 3.238em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.964em, -0.515em); top: -2.534em; left: 0.211em;"><span class="mrow" id="MathJax-Span-9223"><span class="msubsup" id="MathJax-Span-9224"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9225" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-9226"><span class="mrow" id="MathJax-Span-9227"><span class="msubsup" id="MathJax-Span-9228"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9229" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-9230" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9231" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9232"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9233" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9234" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9235" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.521em, 1000em, 2.13em, -0.507em); top: -1.226em; left: 0em;"><span class="mo" id="MathJax-Span-9236" style=""><span style="font-family: STIXSizeFiveSym;">‚èü</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.657em, 1000em, 2.59em, -0.473em); top: -0.898em; left: 0.803em;"><span class="texatom" id="MathJax-Span-9237"><span class="mrow" id="MathJax-Span-9238"><span class="mo" id="MathJax-Span-9239" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="msubsup" id="MathJax-Span-9240"><span style="display: inline-block; position: relative; width: 1.098em; height: 0px;"><span style="position: absolute; clip: rect(1.678em, 1000em, 2.49em, -0.453em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9241" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.266em; left: 0.573em;"><span class="texatom" id="MathJax-Span-9242"><span class="mrow" id="MathJax-Span-9243"><span class="msubsup" id="MathJax-Span-9244"><span style="display: inline-block; position: relative; width: 0.472em; height: 0px;"><span style="position: absolute; clip: rect(1.813em, 1000em, 2.374em, -0.497em); top: -2.196em; left: 0em;"><span class="mi" id="MathJax-Span-9245" style="font-size: 50%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span><span style="position: absolute; top: -2.041em; left: 0.266em;"><span class="mi" id="MathJax-Span-9246" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9247" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mfrac" id="MathJax-Span-9248" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 3.442em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.495em); top: -3.221em; left: 50%; margin-left: -0.704em;"><span class="mrow" id="MathJax-Span-9249"><span class="mn" id="MathJax-Span-9250" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-9251" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mi" id="MathJax-Span-9252" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.484em, 1000em, 2.909em, -0.459em); top: -1.672em; left: 50%; margin-left: -1.661em;"><span class="mrow" id="MathJax-Span-9253"><span class="mo" id="MathJax-Span-9254" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-9255" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-9256" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-9257" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-9258"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9259" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-9260" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.442em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="munderover" id="MathJax-Span-9261" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 4.857em; height: 0px;"><span style="position: absolute; clip: rect(3.137em, 1000em, 5.237em, -0.507em); top: -3.998em; left: 0em;"><span class="munderover" id="MathJax-Span-9262"><span style="display: inline-block; position: relative; width: 4.857em; height: 0px;"><span style="position: absolute; clip: rect(1.673em, 1000em, 2.972em, -0.515em); top: -2.534em; left: 0.007em;"><span class="mrow" id="MathJax-Span-9263"><span class="msubsup" id="MathJax-Span-9264"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9265" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9266"><span class="mrow" id="MathJax-Span-9267"><span class="mi" id="MathJax-Span-9268" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-9269" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-9270" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9271"><span class="mrow" id="MathJax-Span-9272"><span class="mi" id="MathJax-Span-9273" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-9274" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9275" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9276"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9277" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9278" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9279" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9280" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9281" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9282" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9283" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(2.183em, 1000em, 3.227em, -0.507em); top: -1.988em; left: 0em;"><span class="mo" id="MathJax-Span-9284" style=""><span style="display: inline-block; position: relative; width: 4.857em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.025em;">ÓÑΩ<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 3.935em;">ÓÑæ<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 1.5em;">ÓÖÅ<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 0.683em;">ÓÖã<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 1.091em;">ÓÖã<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 3.118em;">ÓÖã<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 3.527em;">ÓÖã<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.587em, -0.473em); top: -0.627em; left: 1.978em;"><span class="texatom" id="MathJax-Span-9285"><span class="mrow" id="MathJax-Span-9286"><span class="mo" id="MathJax-Span-9287" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-9288" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9289" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-9290" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.474em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9291" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.411em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9292"><span class="mrow" id="MathJax-Span-9293"><span class="msubsup" id="MathJax-Span-9294"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9295" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-9296" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.627em; vertical-align: -2.052em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-317">M_i(\pi_i) = \underbrace{L_{\pi_i}(\pi_i)}_{=V^{\pi_i}} - \frac{4 \epsilon \gamma}{(1-\gamma)^2}\underbrace{D_{KL}^{max}(\pi_i,\pi_i)}_{= 0} = V^{\pi_i}</script><br>
as the KL divergence between any distribution and itself is 0 and <span class="MathJax" id="MathJax-Element-318-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9297" style="width: 6.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.574em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9298"><span class="msubsup" id="MathJax-Span-9299"><span style="display: inline-block; position: relative; width: 1.086em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9300" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.616em;"><span class="mi" id="MathJax-Span-9301" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9302" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9303" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-9304" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9305" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-9306" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-9307" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9308" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-9309" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-318">L_\pi(\pi) = V(\pi)</script>.<p></p>
<p>Then we have <span class="MathJax" id="MathJax-Element-319-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9310" style="width: 42.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 38.514em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.882em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9311"><span class="msubsup" id="MathJax-Span-9312"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9313" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9314"><span class="mrow" id="MathJax-Span-9315"><span class="msubsup" id="MathJax-Span-9316"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9317" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-9318"><span class="mrow" id="MathJax-Span-9319"><span class="mi" id="MathJax-Span-9320" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9321" style="font-size: 50%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9322" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9323" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-9324" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9325" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9326" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9327" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9328"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9329" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9330"><span class="mrow" id="MathJax-Span-9331"><span class="mi" id="MathJax-Span-9332" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9333" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9334" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9335" style="font-family: STIXGeneral-Regular;">)</span><span class="mspace" id="MathJax-Span-9336" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-9337" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚üπ</span><span class="mspace" id="MathJax-Span-9338" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-9339" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9340" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9341"><span class="mrow" id="MathJax-Span-9342"><span class="msubsup" id="MathJax-Span-9343"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9344" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-9345"><span class="mrow" id="MathJax-Span-9346"><span class="mi" id="MathJax-Span-9347" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9348" style="font-size: 50%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9349" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9350" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="msubsup" id="MathJax-Span-9351" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.474em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9352" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9353"><span class="mrow" id="MathJax-Span-9354"><span class="msubsup" id="MathJax-Span-9355"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-9357" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9358" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-9359" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9360" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9361" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9362" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9363"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9364" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9365"><span class="mrow" id="MathJax-Span-9366"><span class="mi" id="MathJax-Span-9367" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9368" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9369" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9370" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9371" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="msubsup" id="MathJax-Span-9372" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.474em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9373" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9374"><span class="mrow" id="MathJax-Span-9375"><span class="msubsup" id="MathJax-Span-9376"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9377" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-9378" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mspace" id="MathJax-Span-9379" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-9380" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚ü∫</span><span class="mspace" id="MathJax-Span-9381" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-9382" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.093em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9383" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9384"><span class="mrow" id="MathJax-Span-9385"><span class="msubsup" id="MathJax-Span-9386"><span style="display: inline-block; position: relative; width: 1.213em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9387" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="texatom" id="MathJax-Span-9388"><span class="mrow" id="MathJax-Span-9389"><span class="mi" id="MathJax-Span-9390" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9391" style="font-size: 50%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9392" style="font-size: 50%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9393" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="msubsup" id="MathJax-Span-9394" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.474em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9395" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.378em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9396"><span class="mrow" id="MathJax-Span-9397"><span class="msubsup" id="MathJax-Span-9398"><span style="display: inline-block; position: relative; width: 0.593em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.49em, -0.493em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9399" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.372em;"><span class="mi" id="MathJax-Span-9400" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9401" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â•</span><span class="msubsup" id="MathJax-Span-9402" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9403" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9404" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9405" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9406"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9407" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9408"><span class="mrow" id="MathJax-Span-9409"><span class="mi" id="MathJax-Span-9410" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9411" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9412" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9413" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9414" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="msubsup" id="MathJax-Span-9415" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9416" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9417" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9418" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9419"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9420" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9421" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9422" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.081em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-319">V^{\pi_{i+1}} \ge  M_i(\pi_{i+1}) \implies V^{\pi_{i+1}} -  V^{\pi_i}  \ge  M_i(\pi_{i+1})- V^{\pi_i} \iff V^{\pi_{i+1}} -  V^{\pi_i}  \ge  M_i(\pi_{i+1})- M_i(\pi_i)</script>.<br>
That means that if you optimize w.r.t this lower bound <span class="MathJax" id="MathJax-Element-320-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9423" style="width: 3.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.703em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.525em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9424"><span class="msubsup" id="MathJax-Span-9425"><span style="display: inline-block; position: relative; width: 1.162em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.525em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9426" style="font-family: STIXGeneral-Italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.862em;"><span class="mi" id="MathJax-Span-9427" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9428" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9429"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9430" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9431" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9432" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-320">M_i(\pi_i)</script> and your new lower bound is higher than your old lower bound, then you are guanenteed monotonic improvment. This is called a <strong>Minorization Maximization Algorithm</strong><br>
Better is with respect to an infinity norm - that all states are improved.</p>
<h3>TRPO: Trust Regions Policy Gradient Optimization</h3>
<p>TRPO is the policy gradient algorithm that most people build on for applications today. Very influential.</p>
<ul>
<li>Empircally consistently does well and has monotonic improvement.</li>
</ul>
<p>In order to pick our next update, our goal is to optimize<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-321-Frame" style=""><nobr><span class="math" id="MathJax-Span-9433" style="width: 34.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.025em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.002em, 1000em, 5.296em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9434"><span class="mi" id="MathJax-Span-9435" style="font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-9436" style="font-family: STIXGeneral-Italic;">a</span><span class="msubsup" id="MathJax-Span-9437"><span style="display: inline-block; position: relative; width: 0.973em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9438" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-9439" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9440"><span style="display: inline-block; position: relative; width: 1.804em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9441" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-9442"><span class="mrow" id="MathJax-Span-9443"><span class="msubsup" id="MathJax-Span-9444"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9445" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9446"><span class="mrow" id="MathJax-Span-9447"><span class="mi" id="MathJax-Span-9448" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9449" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9450" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9451" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9452"><span style="display: inline-block; position: relative; width: 1.75em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9453" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-9454"><span class="mrow" id="MathJax-Span-9455"><span class="mi" id="MathJax-Span-9456" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-9457" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-9458" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9459" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9460" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="munderover" id="MathJax-Span-9461" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 3.697em; height: 0px;"><span style="position: absolute; clip: rect(2.635em, 1000em, 6.204em, -0.507em); top: -4.167em; left: 0em;"><span class="munderover" id="MathJax-Span-9462"><span style="display: inline-block; position: relative; width: 3.697em; height: 0px;"><span style="position: absolute; clip: rect(2.466em, 1000em, 5.234em, -0.507em); top: -3.998em; left: 0.008em;"><span class="mfrac" id="MathJax-Span-9463"><span style="display: inline-block; position: relative; width: 3.442em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.495em); top: -3.221em; left: 50%; margin-left: -0.704em;"><span class="mrow" id="MathJax-Span-9464"><span class="mn" id="MathJax-Span-9465" style="font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-9466" style="font-family: STIXGeneral-Italic;">œµ</span><span class="mi" id="MathJax-Span-9467" style="font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.484em, 1000em, 2.909em, -0.459em); top: -1.672em; left: 50%; margin-left: -1.661em;"><span class="mrow" id="MathJax-Span-9468"><span class="mo" id="MathJax-Span-9469" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-9470" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-9471" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-9472" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-9473"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9474" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-9475" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.442em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.183em, 1000em, 3.227em, -0.507em); top: -1.19em; left: 0em;"><span class="mo" id="MathJax-Span-9476" style=""><span style="display: inline-block; position: relative; width: 3.697em; height: 0px;"><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.025em;">ÓÑΩ<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 2.775em;">ÓÑæ<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXNonUnicode-Regular; top: -3.998em; left: 0.92em;">ÓÖÅ<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 0.597em;">ÓÖã<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXNonUnicode-Regular; position: absolute; top: -3.998em; left: 2.452em;">ÓÖã<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.167em;"></span></span><span style="position: absolute; clip: rect(1.669em, 1000em, 2.59em, -0.46em); top: 0.172em; left: 1.595em;"><span class="texatom" id="MathJax-Span-9477"><span class="mrow" id="MathJax-Span-9478"><span class="mi" id="MathJax-Span-9479" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9480"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9481" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9482"><span class="mrow" id="MathJax-Span-9483"><span class="mi" id="MathJax-Span-9484" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-9485" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-9486" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9487"><span class="mrow" id="MathJax-Span-9488"><span class="mi" id="MathJax-Span-9489" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-9490" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9491" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9492"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9493" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9494" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9495" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9496" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9497" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9498"><span class="mrow" id="MathJax-Span-9499"><span class="mi" id="MathJax-Span-9500" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9501" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9502" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9503" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9504" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-9505" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.804em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9506" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-9507"><span class="mrow" id="MathJax-Span-9508"><span class="msubsup" id="MathJax-Span-9509"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9510" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9511"><span class="mrow" id="MathJax-Span-9512"><span class="mi" id="MathJax-Span-9513" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9514" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9515" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9516" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9517"><span style="display: inline-block; position: relative; width: 1.75em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9518" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-9519"><span class="mrow" id="MathJax-Span-9520"><span class="mi" id="MathJax-Span-9521" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span class="mi" id="MathJax-Span-9522" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-9523" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9524" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9525" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-9526" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.022em;"></span></span><span class="mo" id="MathJax-Span-9527" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚ãÖ</span><span class="msubsup" id="MathJax-Span-9528" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 2.046em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9529" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.498em); top: -2.689em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9530"><span class="mrow" id="MathJax-Span-9531"><span class="mi" id="MathJax-Span-9532" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span class="mi" id="MathJax-Span-9533" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-9534" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.039em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9535"><span class="mrow" id="MathJax-Span-9536"><span class="mi" id="MathJax-Span-9537" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-9538" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9539" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9540"><span style="display: inline-block; position: relative; width: 0.831em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9541" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9542" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9543" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9544" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.732em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9545" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9546"><span class="mrow" id="MathJax-Span-9547"><span class="mi" id="MathJax-Span-9548" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-9549" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9550" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9551" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.516em; vertical-align: -2.941em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-321"> max_\theta L_{\theta_{old}}(\theta_{new}) - \underbrace{\frac{4 \epsilon \gamma}{(1-\gamma)^2}}_{C} D_{KL}^{max}(\pi_i,\pi_{i+1}) = L_{\theta_{old}}(\theta_{new}) - C\cdot D_{KL}^{max}(\pi_i,\pi_{i+1}) </script><br>
where <span class="MathJax" id="MathJax-Element-322-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9552" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.721em, -0.441em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9553"><span class="mi" id="MathJax-Span-9554" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.022em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.884em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-322">C</script> is the penality coefficient. In practice if we use the penalty coefficient recommend by the theory <span class="MathJax" id="MathJax-Element-323-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9555" style="width: 5.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.505em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.326em, 1000em, 3.387em, -0.441em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9556"><span class="mi" id="MathJax-Span-9557" style="font-family: STIXGeneral-Italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.022em;"></span></span><span class="mo" id="MathJax-Span-9558" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-9559" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.203em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.662em, 1000em, 2.623em, -0.498em); top: -2.87em; left: 50%; margin-left: -0.507em;"><span class="mrow" id="MathJax-Span-9560"><span class="mn" id="MathJax-Span-9561" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">4</span><span class="mi" id="MathJax-Span-9562" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">œµ</span><span class="mi" id="MathJax-Span-9563" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.517em, 1000em, 2.623em, -0.473em); top: -1.77em; left: 50%; margin-left: -1.042em;"><span class="mrow" id="MathJax-Span-9564"><span class="mo" id="MathJax-Span-9565" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-9566" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-9567" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àí</span><span class="mi" id="MathJax-Span-9568" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.02em;"></span></span><span class="msubsup" id="MathJax-Span-9569"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.662em, 1000em, 2.603em, -0.486em); top: -2.309em; left: 0em;"><span class="mo" id="MathJax-Span-9570" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.481em; left: 0.282em;"><span class="mn" id="MathJax-Span-9571" style="font-size: 50%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.203em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.038em; vertical-align: -0.822em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-323">C=\frac{4 \epsilon \gamma}{(1-\gamma)^2}</script>, the step sizes would be very small.<p></p>
<p>New Idea: Instaed of subtracting the KL term as above, we use a "<strong>Trust Region</strong>" KL divergence constraint on step sizes. Any parameter update is allowed as long as the KL divergenve with the old policy is within a particular bound. Note: This uses the average KL instead of the max, as the max requires the KL is bounded at all states and yields an impractical number of constraints.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-324-Frame" style=""><nobr><span class="math" id="MathJax-Span-9572" style="width: 25.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.255em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.159em, 1000em, 4.051em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-9573"><span class="mtable" id="MathJax-Span-9574" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 22.917em; height: 0px;"><span style="position: absolute; clip: rect(2.618em, 1000em, 5.555em, -0.507em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 0em; height: 0px;"><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -5.209em; right: 0em;"><span class="mtd" id="MathJax-Span-9575"><span class="mrow" id="MathJax-Span-9576"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.609em; right: 0em;"><span class="mtd" id="MathJax-Span-9648"><span class="mrow" id="MathJax-Span-9649"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.544em, 1000em, 6.753em, -0.491em); top: -4.899em; left: 0em;"><span style="display: inline-block; position: relative; width: 22.917em; height: 0px;"><span style="position: absolute; clip: rect(1.39em, 1000em, 3.962em, -0.241em); top: -3.745em; left: 0em;"><span class="mtd" id="MathJax-Span-9577"><span class="mrow" id="MathJax-Span-9578"><span class="munderover" id="MathJax-Span-9579" style="padding-left: 0.25em; padding-right: 0.375em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-9580" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.66em, 1000em, 2.585em, -0.488em); top: -1.624em; left: 0.676em;"><span class="mi" id="MathJax-Span-9581" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9582"><span style="display: inline-block; position: relative; width: 1.804em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9583" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.616em;"><span class="texatom" id="MathJax-Span-9584"><span class="mrow" id="MathJax-Span-9585"><span class="msubsup" id="MathJax-Span-9586"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9587" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9588"><span class="mrow" id="MathJax-Span-9589"><span class="mi" id="MathJax-Span-9590" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9591" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9592" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9593" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9594" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-9595" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9596" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-9597" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span class="mo" id="MathJax-Span-9598" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9599" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-9600" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9601" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="munderover" id="MathJax-Span-9602" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-9603" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-9604" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9605" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9606" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.757em; left: 0.563em;"><span class="texatom" id="MathJax-Span-9607"><span class="mrow" id="MathJax-Span-9608"><span class="msubsup" id="MathJax-Span-9609"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9610" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9611"><span class="mrow" id="MathJax-Span-9612"><span class="mi" id="MathJax-Span-9613" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9614" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9615" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9616" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9617" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9618" style="font-family: STIXGeneral-Regular;">)</span><span class="munderover" id="MathJax-Span-9619" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-9620" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.585em, -0.495em); top: -1.159em; left: 0.479em;"><span class="mi" id="MathJax-Span-9621" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-9622" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-9623" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9624" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-9625"><span class="mrow" id="MathJax-Span-9626"><span class="mo" id="MathJax-Span-9627" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-9628" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9629" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9630" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-9631" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-9632"><span style="display: inline-block; position: relative; width: 1.807em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9633" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9634"><span class="mrow" id="MathJax-Span-9635"><span class="msubsup" id="MathJax-Span-9636"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9637" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9638"><span class="mrow" id="MathJax-Span-9639"><span class="mi" id="MathJax-Span-9640" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9641" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9642" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9643" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9644" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9645" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9646" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-9647" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.362em, 1000em, 3em, -0.491em); top: -1.145em; left: 0em;"><span class="mtd" id="MathJax-Span-9650"><span class="mrow" id="MathJax-Span-9651"><span class="mi" id="MathJax-Span-9652" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9653" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-9654" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-9655" style="font-family: STIXGeneral-Regular;">.</span><span class="msubsup" id="MathJax-Span-9656" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.059em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9657" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.823em, -0.495em); top: -2.999em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9658"><span class="mrow" id="MathJax-Span-9659"><span class="mi" id="MathJax-Span-9660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9661" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="msubsup" id="MathJax-Span-9662"><span style="display: inline-block; position: relative; width: 1.435em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.622em, -0.53em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9663" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.394em;"><span class="texatom" id="MathJax-Span-9664"><span class="mrow" id="MathJax-Span-9665"><span class="msubsup" id="MathJax-Span-9666"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(1.688em, 1000em, 2.37em, -0.493em); top: -2.196em; left: 0em;"><span class="mi" id="MathJax-Span-9667" style="font-size: 50%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span><span style="position: absolute; top: -2.027em; left: 0.275em;"><span class="texatom" id="MathJax-Span-9668"><span class="mrow" id="MathJax-Span-9669"><span class="mi" id="MathJax-Span-9670" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9671" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9672" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.678em, 1000em, 2.477em, -0.502em); top: -2.011em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9673"><span class="mrow" id="MathJax-Span-9674"><span class="mi" id="MathJax-Span-9675" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.039em;"></span></span><span class="mi" id="MathJax-Span-9676" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9677" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9678"><span style="display: inline-block; position: relative; width: 1.525em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9679" style="font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-9680"><span class="mrow" id="MathJax-Span-9681"><span class="mi" id="MathJax-Span-9682" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9683" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-9684" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9685" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9686" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-9687" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9688" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚â§</span><span class="mi" id="MathJax-Span-9689" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">Œ¥</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.899em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.423em; vertical-align: -1.934em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-324">\begin{align}   & \max_\theta L_{\theta_{old}}(\theta) = V(\theta) + \sum_s \mu_{\theta_{old}}(s) \sum_a \pi(a|s,\theta) A_{\theta_{old}}(s,a)\\   & s.t.  D_{KL}^{s \sim \mu_{\theta_{old}}}(\theta_{old},\theta) \le \delta  \end{align}</script><p></p>
<p>They also do a few substitutions to make this practical:</p>
<ol>
<li>Since the state space might be very large or continuous, they estimate it using reweighted sampline (below <span class="MathJax" id="MathJax-Element-325-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9690" style="width: 1.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.633em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.859em, -0.419em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9691"><span class="mo" id="MathJax-Span-9692" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-9693" style="font-family: STIXGeneral-Regular;">‚ãØ</span><span class="mo" id="MathJax-Span-9694" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.033em; vertical-align: -0.236em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-325">[\cdots]</script> represents <span class="MathJax" id="MathJax-Element-326-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9695" style="width: 9.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.727em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em, 1000em, 3.007em, -0.449em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9696"><span class="munderover" id="MathJax-Span-9697"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-9698" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="mi" id="MathJax-Span-9699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-9700" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-9701" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9702" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-9703"><span class="mrow" id="MathJax-Span-9704"><span class="mo" id="MathJax-Span-9705" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-9706" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9707" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9708" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-9709" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-9710"><span style="display: inline-block; position: relative; width: 1.807em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9711" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9712"><span class="mrow" id="MathJax-Span-9713"><span class="msubsup" id="MathJax-Span-9714"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9715" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9716"><span class="mrow" id="MathJax-Span-9717"><span class="mi" id="MathJax-Span-9718" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9719" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9720" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9721" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9722" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9723" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9724" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-9725" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.307em; vertical-align: -0.4em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-326">\sum_a \pi(a|s,\theta) A_{\theta_{old}}(s,a)</script>):<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-327-Frame" style=""><nobr><span class="math" id="MathJax-Span-9726" style="width: 16.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.921em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.012em, 1000em, 3.962em, -0.417em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9727"><span class="munderover" id="MathJax-Span-9728"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-9729" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.827em, 1000em, 2.587em, -0.495em); top: -1.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-9730" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9731" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.751em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.908em, -0.54em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9732" style="font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.757em; left: 0.563em;"><span class="texatom" id="MathJax-Span-9733"><span class="mrow" id="MathJax-Span-9734"><span class="msubsup" id="MathJax-Span-9735"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9736" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9737"><span class="mrow" id="MathJax-Span-9738"><span class="mi" id="MathJax-Span-9739" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9740" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9741" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9742" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9743" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9744" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9745" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-9746" style="font-family: STIXGeneral-Regular;">‚ãØ</span><span class="mo" id="MathJax-Span-9747" style="font-family: STIXGeneral-Regular;">]</span><span class="mo" id="MathJax-Span-9748" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚Üí</span><span class="mfrac" id="MathJax-Span-9749" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.316em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.703em, -0.396em); top: -3.21em; left: 50%; margin-left: -0.253em;"><span class="mn" id="MathJax-Span-9750" style="font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.396em); top: -1.848em; left: 50%; margin-left: -1.098em;"><span class="mrow" id="MathJax-Span-9751"><span class="mn" id="MathJax-Span-9752" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-9753" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">‚àí</span><span class="mi" id="MathJax-Span-9754" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Œ≥<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.316em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9755" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 3.003em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-9756"><span class="mrow" id="MathJax-Span-9757"><span class="mi" id="MathJax-Span-9758" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-9759"><span class="mrow" id="MathJax-Span-9760"><span class="mi" id="MathJax-Span-9761" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9762" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="msubsup" id="MathJax-Span-9763"><span style="display: inline-block; position: relative; width: 1.435em; height: 0px;"><span style="position: absolute; clip: rect(1.837em, 1000em, 2.622em, -0.53em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9764" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œº</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.394em;"><span class="texatom" id="MathJax-Span-9765"><span class="mrow" id="MathJax-Span-9766"><span class="msubsup" id="MathJax-Span-9767"><span style="display: inline-block; position: relative; width: 0.988em; height: 0px;"><span style="position: absolute; clip: rect(1.688em, 1000em, 2.37em, -0.493em); top: -2.196em; left: 0em;"><span class="mi" id="MathJax-Span-9768" style="font-size: 50%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.007em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span><span style="position: absolute; top: -2.027em; left: 0.275em;"><span class="texatom" id="MathJax-Span-9769"><span class="mrow" id="MathJax-Span-9770"><span class="mi" id="MathJax-Span-9771" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9772" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9773" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9774" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-9775" style="font-family: STIXGeneral-Regular;">‚ãØ</span><span class="mo" id="MathJax-Span-9776" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.024em; vertical-align: -1.46em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-327">\sum_s \mu_{\theta_{old}}(s) [ \cdots ] \rightarrow \frac{1}{1-\gamma} \mathbb{E}_{s \sim \mu_{\theta_{old}}} [\cdots]</script></li>
<li>Since the action space might be a continuous set, instead of summing over all the actions, we use importance sampling. Note: the <span class="MathJax" id="MathJax-Element-328-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9777" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9778"><span class="mi" id="MathJax-Span-9779" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-328">q</script> below is just the notation for importance sampling, normally <span class="MathJax" id="MathJax-Element-329-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9780" style="width: 6.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.462em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9781"><span class="mi" id="MathJax-Span-9782" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-9783" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-9784" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.563em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9785" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9786"><span class="mrow" id="MathJax-Span-9787"><span class="mi" id="MathJax-Span-9788" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9789" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-9790" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.019em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9791" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9792" style="font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-9793" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9794" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">s</span><span class="mo" id="MathJax-Span-9795" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.107em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-329">q = \pi_{old}(a,s)</script>.<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-330-Frame" style=""><nobr><span class="math" id="MathJax-Span-9796" style="width: 23.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.115em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.461em, 1000em, 5.537em, -0.417em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-9797"><span class="munderover" id="MathJax-Span-9798"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-9799" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">‚àë</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.828em, 1000em, 2.585em, -0.495em); top: -1.159em; left: 0.479em;"><span class="mi" id="MathJax-Span-9800" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-9801" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-9802" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9803" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-9804"><span class="mrow" id="MathJax-Span-9805"><span class="mo" id="MathJax-Span-9806" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-9807" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9808" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9809" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-9810" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-9811"><span style="display: inline-block; position: relative; width: 1.807em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9812" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9813"><span class="mrow" id="MathJax-Span-9814"><span class="msubsup" id="MathJax-Span-9815"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9816" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9817"><span class="mrow" id="MathJax-Span-9818"><span class="mi" id="MathJax-Span-9819" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9820" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9821" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9822" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9823" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9824" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9825" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-9826" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9827" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚Üí</span><span class="msubsup" id="MathJax-Span-9828" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.989em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-9829"><span class="mrow" id="MathJax-Span-9830"><span class="mi" id="MathJax-Span-9831" style="font-family: STIXGeneral-Regular;">ùîº</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-9832"><span class="mrow" id="MathJax-Span-9833"><span class="mi" id="MathJax-Span-9834" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-9835" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">‚àº</span><span class="mi" id="MathJax-Span-9836" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">q</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-9837" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-9838" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mfrac" id="MathJax-Span-9839"><span style="display: inline-block; position: relative; width: 3.442em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.488em); top: -3.21em; left: 50%; margin-left: -1.661em;"><span class="mrow" id="MathJax-Span-9840"><span class="msubsup" id="MathJax-Span-9841"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9842" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9843"><span class="mrow" id="MathJax-Span-9844"><span class="mi" id="MathJax-Span-9845" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9846" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9847" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-9848"><span class="mrow" id="MathJax-Span-9849"><span class="mo" id="MathJax-Span-9850" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-9851"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9852" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9853" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9854" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.912em, -0.482em); top: -1.848em; left: 50%; margin-left: -1.408em;"><span class="mrow" id="MathJax-Span-9855"><span class="mi" id="MathJax-Span-9856" style="font-family: STIXGeneral-Italic;">q</span><span class="mo" id="MathJax-Span-9857" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9858" style="font-family: STIXGeneral-Italic;">a</span><span class="texatom" id="MathJax-Span-9859"><span class="mrow" id="MathJax-Span-9860"><span class="mo" id="MathJax-Span-9861" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-9862"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9863" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9864" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9865" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 3.442em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-9866" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.807em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9867" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9868"><span class="mrow" id="MathJax-Span-9869"><span class="msubsup" id="MathJax-Span-9870"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9871" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9872"><span class="mrow" id="MathJax-Span-9873"><span class="mi" id="MathJax-Span-9874" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9875" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9876" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9877" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9878" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-9879" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-9880" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-9881" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-9882" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.164em; vertical-align: -1.459em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-330">\sum_a \pi(a|s,\theta) A_{\theta_{old}}(s,a) \rightarrow \mathbb{E}_{a \sim q} \left[ \frac{\pi_{\theta}(a|s_n)}{q(a|s_n)} A_{\theta_{old}}(s,a)\right]</script><br>
where <span class="MathJax" id="MathJax-Element-328-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9777" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9778"><span class="mi" id="MathJax-Span-9779" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-328">q</script> is some sampling distribution over the actions and <span class="MathJax" id="MathJax-Element-331-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9883" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.957em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.521em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-9884"><span class="msubsup" id="MathJax-Span-9885"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9886" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9887" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">n</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.789em; vertical-align: -0.236em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-331">s_n</script> is a particular sampled state.<br>
"We look at times when we took some actions under our current policy, and we reweight them according to the probabilty they would have taken that action under the new policy".<br>
Importance sampling essentially allows us to sample according to an alternate sampling distribution <span class="MathJax" id="MathJax-Element-328-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9777" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.912em, -0.482em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9778"><span class="mi" id="MathJax-Span-9779" style="font-family: STIXGeneral-Italic;">q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.847em; vertical-align: -0.294em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-328">q</script> rather than the new policy <span class="MathJax" id="MathJax-Element-332-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9888" style="width: 1.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.014em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.599em, 1000em, 2.523em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-9889"><span class="msubsup" id="MathJax-Span-9890"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9891" style="font-family: STIXGeneral-Italic;">œÄ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="mi" id="MathJax-Span-9892" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.775em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-332">\pi_\theta</script> which may have a continuous action space.</li>
<li>Third substituion is switching the advantage back to the Q function:<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-333-Frame" style=""><nobr><span class="math" id="MathJax-Span-9893" style="width: 5.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.293em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.697em, 1000em, 3.033em, -0.558em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9894"><span class="msubsup" id="MathJax-Span-9895"><span style="display: inline-block; position: relative; width: 1.807em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.703em, -0.558em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9896" style="font-family: STIXGeneral-Italic;">A</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.619em;"><span class="texatom" id="MathJax-Span-9897"><span class="mrow" id="MathJax-Span-9898"><span class="msubsup" id="MathJax-Span-9899"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9900" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9901"><span class="mrow" id="MathJax-Span-9902"><span class="mi" id="MathJax-Span-9903" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9904" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9905" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9906" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">‚Üí</span><span class="msubsup" id="MathJax-Span-9907" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.92em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9908" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.78em; left: 0.732em;"><span class="texatom" id="MathJax-Span-9909"><span class="mrow" id="MathJax-Span-9910"><span class="msubsup" id="MathJax-Span-9911"><span style="display: inline-block; position: relative; width: 1.113em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-9912" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">Œ∏<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="texatom" id="MathJax-Span-9913"><span class="mrow" id="MathJax-Span-9914"><span class="mi" id="MathJax-Span-9915" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span class="mi" id="MathJax-Span-9916" style="font-size: 50%; font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span class="mi" id="MathJax-Span-9917" style="font-size: 50%; font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.233em; vertical-align: -0.429em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-333">A_{\theta_{old}} \rightarrow Q_{\theta_{old}}</script></li>
</ol>
<p>Note that these three substitutions don't change the solution to the optimization problem.<br>
(Schulman et al ICML 2015)</p>
</div><div class="cell text-cell"><p><b>Putting it all together</b></p><p><img src="resources/28D8A241E3C6C6EA9C580EAD50C382AD.png" alt="Screenshot 2020-04-03 at 10.00.19 PM.png" width="615" height="460"><strong><br></strong></p><p><img src="resources/6C204D53BDC486C937E1C8766929D15C.png" alt="Screenshot 2020-04-03 at 10.00.49 PM.png" width="626" height="467"><br></p><p><img src="resources/57E367FF5E21C8CF72A24318FD5D2F05.png" alt="Screenshot 2020-04-03 at 10.01.07 PM.png" width="621" height="460"><br></p><p><br></p><p><b>Summary:</b></p><p><img src="resources/50766B358C3D863C3220DDDF467E3FA6.png" alt="Screenshot 2020-04-03 at 10.02.57 PM.png" width="520" height="381"><br></p><p><img src="resources/40D6690AEDD775B0A31D84DF04F7B935.png" alt="Screenshot 2020-04-03 at 10.02.51 PM.png" width="558" height="428"><br></p><p><strong>Appendix 1</strong><br>
On why subtracting a baseline does not bias the estimator.</p>
<img src="resources/DB68F40AF1279CBF74028AFB14655929.png" alt="Screenshot 2020-04-03 at 1.47.20 PM.png" width="643" height="477"><div>Break Up Expectation: Expectation over current/prev states+actions and future ones</div><div>Pull baseline term out: because b(s_t) depends on the current state only, which is a function of previous states, not affected by future states</div><div>Remove irrelevant variables: $\nabla_\theta \log \pi(a_t | s_t, \theta)$ only depends on a_t, not any future states or actions</div><div>Likelihood ratio: Simply an expansion of the expectation term and the log-derivative term</div><div>The general gist of this argument is, the log derivative term only depends on a_t, and at time-step $a_t$, the expectation is constant so its derivative does not contribute to the bias term.</div><div><br></div><div>This property depends on the baseline being a funciton only on the state (not dependent on the action)</div></div></div>
    </body>
    </html>
  