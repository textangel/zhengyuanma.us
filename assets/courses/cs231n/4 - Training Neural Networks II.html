
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS231N (CS224N) - * Lecture 7 Training Neural Networks II</h2>
      </div>
      <div id="contentarea"><div class="cell text-cell"><div><b>Issues for Training:</b></div><div>&nbsp; &nbsp;- Poor conditioning (High condition number) is an issue for optimisation (Appendix 1)</div>&nbsp; &nbsp; - Saddle Points<div>&nbsp; &nbsp; - &nbsp;Local Minima<div><div><br></div><div>Tldr, use RMSProp or Adam.</div><div><br></div><div><b>SGD + Momentum</b></div><div>Maintain a velocity as a running (exponential) mean of gradients</div><div>Step in the direction of the velocity, instead of just the gradient. This smooths out the direction of updates.</div><div></div></div></div></div><div class="cell markdown-cell"><p></p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-249-Frame" style=""><nobr><span class="math" id="MathJax-Span-7164" style="width: 100%; display: inline-block; min-width: 8.953em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(3.151em, 1000em, 5.546em, -0.534em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-7165"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000em, 4.374em, -0.487em); top: -3.998em; left: 50%; margin-left: -4.014em;"><span class="msubsup" id="MathJax-Span-7166"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7167" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7168"><span class="mrow" id="MathJax-Span-7169"><span class="mi" id="MathJax-Span-7170" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7171" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7172" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7173" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7174" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ρ</span><span class="msubsup" id="MathJax-Span-7175"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7176" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7177" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7178" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7179" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∇</span><span class="mi" id="MathJax-Span-7180" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-7181" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7182"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7183" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7184" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7185" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000em, 4.346em, -0.534em); top: -2.798em; left: 50%; margin-left: -3.604em;"><span class="mspace" id="MathJax-Span-7186" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-7187"><span style="display: inline-block; position: relative; width: 1.705em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7188" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-7189"><span class="mrow" id="MathJax-Span-7190"><span class="mi" id="MathJax-Span-7191" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7192" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7193" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7194" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7195" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7196" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7197" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7198" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7199" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="msubsup" id="MathJax-Span-7200"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7201" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7202"><span class="mrow" id="MathJax-Span-7203"><span class="mi" id="MathJax-Span-7204" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7205" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7206" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.408em; vertical-align: -1.593em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-249">v_{t+1} = \rho v_t + \nabla f(x_t) \\ x_{t+1} = x_t - \alpha v_{t+1}</script><p></p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>while True:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  dx = compute_gradient(x)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  vx = rho * vx + dx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  x += learning_rate * vx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div></div></div></div><div class="cell text-cell"><div>Note: Rho gives “friction”, typically, 0.9 or 0.99.</div><div>Helps with Local Minima, Saddle Points and also Poor Conditioning. (Appendix 2)</div><div>Momentum tends to overshoot the optimum.</div><div></div></div><div class="cell text-cell"><div><b>SGD + Nesterov Momentum</b></div><div><b></b></div><p>You start at your point, you step in the direction of where the velocity would take you, and then you compute the gradient at that point and make the step.<br>
"If your velocity equation was a little bit wrong, it allows you to incorporate gradient information from some other parts of your objective landscape"</p>
</div><div class="cell markdown-cell"><p></p><div class="MathJax_Display" role="textbox" aria-readonly="true"><span class="MathJax" id="MathJax-Element-250-Frame" style=""><nobr><span class="math" id="MathJax-Span-7207" style="width: 100%; display: inline-block; min-width: 11.828em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(3.151em, 1000em, 5.584em, -0.534em); top: -3.998em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-7208"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000em, 4.374em, -0.487em); top: -3.998em; left: 50%; margin-left: -5.331em;"><span class="msubsup" id="MathJax-Span-7209"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7210" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7211"><span class="mrow" id="MathJax-Span-7212"><span class="mi" id="MathJax-Span-7213" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7214" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7215" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7216" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7217" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">ρ</span><span class="msubsup" id="MathJax-Span-7218"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7219" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7220" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7221" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7222" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mi" id="MathJax-Span-7223" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-7224" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-7225" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7226" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7227" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7228" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ρ</span><span class="msubsup" id="MathJax-Span-7229"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7230" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7231" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7232" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.282em, 1000em, 4.346em, -0.534em); top: -2.759em; left: 50%; margin-left: -3.328em;"><span class="mspace" id="MathJax-Span-7233" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-7234"><span style="display: inline-block; position: relative; width: 1.705em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7235" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="texatom" id="MathJax-Span-7236"><span class="mrow" id="MathJax-Span-7237"><span class="mi" id="MathJax-Span-7238" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7239" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7240" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7241" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7242" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7243" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7244" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7245" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-7246" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7247" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7248"><span class="mrow" id="MathJax-Span-7249"><span class="mi" id="MathJax-Span-7250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7251" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7252" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.451em; vertical-align: -1.636em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-250">v_{t+1} = \rho v_t -\alpha \nabla f(x + \rho v_t) \\ x_{t+1}=x_t + v_{t+1}</script><p></p>
</div><div class="cell markdown-cell"><p>Generally, we evaluate Nesterov Momentum using a change of variables <span class="MathJax" id="MathJax-Element-251-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7253" style="width: 6.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.405em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.908em, -0.786em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7254"><span class="msubsup" id="MathJax-Span-7255"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000em, 4.178em, -0.786em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-7256"><span class="mrow" id="MathJax-Span-7257"><span class="munderover" id="MathJax-Span-7258"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7259" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.048em; left: 0.115em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7260" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-7261" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7262" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7263" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7264" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7265" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7266" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7267" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ρ</span><span class="msubsup" id="MathJax-Span-7268"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7269" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7270" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.116em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-251">\tilde x_t = x_t + \rho v_t</script>, allowing us to use a form very similar to original momentum.</p>
</div><div class="cell markdown-cell"><p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-252-Frame" style=""><nobr><span class="math" id="MathJax-Span-7271" style="width: 14.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.063em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.069em, 1000em, 3.961em, -0.619em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7272"><span class="mtable" id="MathJax-Span-7273" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 12.688em; height: 0px;"><span style="position: absolute; clip: rect(2.204em, 1000em, 5.67em, -0.786em); top: -4.11em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.708em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000em, 4.346em, -0.487em); top: -5.294em; right: 0em;"><span class="mtd" id="MathJax-Span-7274"><span class="mrow" id="MathJax-Span-7275"><span class="msubsup" id="MathJax-Span-7276"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7277" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7278"><span class="mrow" id="MathJax-Span-7279"><span class="mi" id="MathJax-Span-7280" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7281" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7282" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.141em, 1000em, 4.346em, -0.786em); top: -3.949em; right: 0em;"><span class="mtd" id="MathJax-Span-7303"><span class="mrow" id="MathJax-Span-7304"><span class="msubsup" id="MathJax-Span-7305"><span style="display: inline-block; position: relative; width: 1.708em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000em, 4.178em, -0.786em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-7306"><span class="mrow" id="MathJax-Span-7307"><span class="munderover" id="MathJax-Span-7308"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7309" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.048em; left: 0.115em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7310" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7311"><span class="mrow" id="MathJax-Span-7312"><span class="mi" id="MathJax-Span-7313" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7314" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7315" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.607em; right: 0em;"><span class="mtd" id="MathJax-Span-7344"><span class="mrow" id="MathJax-Span-7345"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span><span style="position: absolute; clip: rect(2.408em, 1000em, 6.326em, -0.209em); top: -4.561em; left: 1.708em;"><span style="display: inline-block; position: relative; width: 10.98em; height: 0px;"><span style="position: absolute; clip: rect(1.677em, 1000em, 2.91em, -0.209em); top: -3.83em; left: 0em;"><span class="mtd" id="MathJax-Span-7283"><span class="mrow" id="MathJax-Span-7284"><span class="mo" id="MathJax-Span-7285" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="mi" id="MathJax-Span-7286" style="font-family: STIXGeneral-Italic;">ρ</span><span class="msubsup" id="MathJax-Span-7287"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7288" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7289" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7290" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7291" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">α</span><span class="mi" id="MathJax-Span-7292" style="font-family: STIXGeneral-Regular;">∇</span><span class="mi" id="MathJax-Span-7293" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-7294" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7295"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000em, 4.178em, -0.786em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-7296"><span class="mrow" id="MathJax-Span-7297"><span class="munderover" id="MathJax-Span-7298"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7299" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.048em; left: 0.115em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7300" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-7301" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7302" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.908em, -0.209em); top: -2.485em; left: 0em;"><span class="mtd" id="MathJax-Span-7316"><span class="mrow" id="MathJax-Span-7317"><span class="mo" id="MathJax-Span-7318" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-7319"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000em, 4.178em, -0.786em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-7320"><span class="mrow" id="MathJax-Span-7321"><span class="munderover" id="MathJax-Span-7322"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7323" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.048em; left: 0.115em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7324" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-7325" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7326" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7327" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ρ</span><span class="msubsup" id="MathJax-Span-7328"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7329" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7330" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7331" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mo" id="MathJax-Span-7332" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">(</span><span class="mn" id="MathJax-Span-7333" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7334" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-7335" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ρ</span><span class="mo" id="MathJax-Span-7336" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-7337"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7338" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7339"><span class="mrow" id="MathJax-Span-7340"><span class="mi" id="MathJax-Span-7341" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7342" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7343" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.677em, 1000em, 2.908em, -0.209em); top: -1.143em; left: 0em;"><span class="mtd" id="MathJax-Span-7346"><span class="mrow" id="MathJax-Span-7347"><span class="mo" id="MathJax-Span-7348" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-7349"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000em, 4.178em, -0.786em); top: -3.998em; left: 0em;"><span class="texatom" id="MathJax-Span-7350"><span class="mrow" id="MathJax-Span-7351"><span class="munderover" id="MathJax-Span-7352"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7353" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -4.048em; left: 0.115em;"><span style="height: 0em; vertical-align: 0em; width: 0.395em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-7354" style="font-family: STIXGeneral-Regular; margin-left: -0.395em;">̃&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.676em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="mi" id="MathJax-Span-7355" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7356" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="msubsup" id="MathJax-Span-7357" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7358" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7359"><span class="mrow" id="MathJax-Span-7360"><span class="mi" id="MathJax-Span-7361" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7362" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7363" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7364" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7365" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">ρ</span><span class="mo" id="MathJax-Span-7366" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7367"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7368" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7369"><span class="mrow" id="MathJax-Span-7370"><span class="mi" id="MathJax-Span-7371" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7372" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7373" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7374" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-7375" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.721em, -0.487em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7376" style="font-family: STIXGeneral-Italic;">v</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7377" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7378" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.561em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.223em; vertical-align: -1.834em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-252">\begin{align} v_{t+1} & = \rho v_t - \alpha \nabla f(\tilde x_t) \\ \tilde x_{t+1} & = \tilde x_t - \rho v_t + (1-\rho) v_{t+1} \\ & = \tilde x_t + v_{t+1} + \rho(v_{t+1}-v_t) \end{align}</script><p></p>
</div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>while True:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  dx = compute_gradient(x)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  old_v = v
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  v = rho * v - learning_rate * dx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  x += -rho * old_v + (1 + rho) * v
</div></div></div></div><div class="cell text-cell"><p>The interpretation of Nestrov Momentum: We update our point according to our current velocity plus a weighted difference between our current velocity and our previous velocity. This is an error correcting term between the current velocity and the previous velocity.</p>
<p>Nesterov Momentum tends to overshoot the optimum but less than raw momentum. For this reason raw momentum is used less than Nesterov Momentum.<br></p><p>Intuition for Nesterov Momentum in Appendix 3.</p><p><b>AdaGrad (deprecated)</b></p><p>Keeps a running historical sum of sqiares of the gradient in each direction. Adds Element-wise scaling of the gradient based on the historical sum of squares in that direction.</p><p>Motivation: Helps with conditioning, dimensions with high gradients get scaled to be smaller (slowed down process along dimensions where the gradient oscillates a lot), dimensions with low gradients get scaled to be larger (speed up process along dimensions progressing too slowly).&nbsp;</p><p>However, AdaGrad makes smaller and smaller updates each step, so it is not used that much in favor of RMSProp</p><p></p></div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>grad_squared = 0
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>while True:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  dx = compute_gradient(x)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  grad_squared += dx * dx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  x -= learning_rate * dx / (np.sqrt(grad_squared) + 1e-7)
</div></div></div></div><div class="cell text-cell"><div><b>RMSProp</b></div><div>Variant of AdaGrad that solves the issue of updates getting smaller and smaller. Simple fix: instead of keeping the full sum of squares of gradients along each dimension, we keep an exponentially moving average.</div><div></div></div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>grad_squared = 0
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>while True:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  dx = compute_gradient(x)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  grad_squared = decay_rate * grad_squared + (1 - decay_rate) * dx * dx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  x -= learning_rate * dx / (np.sqrt(grad_squared) + 1e-7)
</div></div></div></div><div class="cell text-cell"><div>Overshoots much less than SGD-Momentum/Nesterov Momentum</div><div><b><br></b></div><div><b>Adam</b></div><div>Uses both momentum (the first moment) and the square gradients (RMSProp) to update the weights.</div><div>However, a slight adjustment is needed because updates will be unnecessarily large in the first updates (Appendix 4 for details)</div><div></div></div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>first_moment = 0
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>second_moment = 0
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>while True:
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  dx = compute_gradient(x)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  first_moment = beta1 * first_moment + (1 - beta1) * dx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  second_moment = beta2 * second_moment + (1 - beta2) * dx * dx
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  first_unbiased_moment = first_moment / (1 - beta1 ** t)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  second_unbiased_moment = second_moment / (1 - beta2 ** t)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  x -= learning_rate * first_unbiased_moment / (np.sqrt(second_unbiased_moment) + 1e-7)
</div></div></div></div><div class="cell text-cell"><div>Adam is a good default optimization algo with beta1=0.9, beta2=0.999, learning_rate = 1e-3 or 5e-4 is a great starting point for many models!</div><div></div></div><div class="cell text-cell"><div><b>Learning Rate Schedules</b></div><div></div></div><div class="cell markdown-cell"><p>Ideas:<br>
Step decay learnign rate: e.g. decay learning rate by half every few epochs<br>
Exponentially decayed learning rate: <span class="MathJax" id="MathJax-Element-253-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7379" style="width: 5.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.561em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.519em, 1000em, 2.863em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7380"><span class="mi" id="MathJax-Span-7381" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-7382" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7383" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7384" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-7385" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7386"><span style="display: inline-block; position: relative; width: 1.595em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.476em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7387" style="font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7388"><span class="mrow" id="MathJax-Span-7389"><span class="mo" id="MathJax-Span-7390" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mi" id="MathJax-Span-7391" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.012em;"></span></span><span class="mi" id="MathJax-Span-7392" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.241em; vertical-align: -0.24em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-253">\alpha = \alpha_0 e^{-kt}</script><br>
1/t decay: <span class="MathJax" id="MathJax-Element-254-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7393" style="width: 7.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.363em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7394"><span class="mi" id="MathJax-Span-7395" style="font-family: STIXGeneral-Italic;">α</span><span class="mo" id="MathJax-Span-7396" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7397" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7398" style="font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-7399" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">9</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7400"><span class="mrow" id="MathJax-Span-7401"><span class="mo" id="MathJax-Span-7402" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mo" id="MathJax-Span-7403" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7404" style="font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-7405" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7406" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span class="mi" id="MathJax-Span-7407" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-7408" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-254">\alpha = \alpha_9 / (1+kt)</script></p>
</div><div class="cell text-cell"><div>Step decayed learning rates get you loss plots that look like Appendix 5.</div><div>However, learning rate decay is less important than the learnign rate itself. First train a good model with a good learning rate itself, then look into possibly doing learnign rate decay by looking at the loss curve.</div><div><br></div><div><b>Second order optimization</b></div><div>Second Order optimization allows us to jump directly to (or close to) the optimum.</div><div>Generally it is very slow and infeasible to invert the Hessian for second order optimization (The Hessian is O(N^2) and the inversion is O(N^3)). (Appendix 6 for Equation).</div><div>However, some approximate second order optimizations functions, in particular <b>L-BFGS</b> (using low-rank approximations of the Hessian) are sometimes used for neural network training, esp in Style Transfer. (Appendix 6)</div><div><br></div><div>L-BFGS usually works very well in full batch, deterministic mode (i.e. if you have a single, deterministic f(x) then L-BFGS will work very nicely). It does not transfer very well to mini-batch setting.</div><div><br></div><div>Adapting L-BFGS to large-scale stochastic setting is active research area.</div><div>If you can afford to do full batch updates, then try out L-DFGS (and dont forget to disable all sources of noise). Otherwise use Adam.<br></div><div style="font-size: 18px; font-weight: bold;"><b style="font-size: 18px;"><br></b></div><div style="font-size: 15px;"><b>Model Ensembles</b></div><div>You can ensemble multiple separate models, or use multiple snapshots of a single model during training. Very interestingly, you can use cyclic learning rate schedules that jump around preiodically to fit to differnet parts of the optimal space, and then ensemble the shapshots of the models taken at those different spaces.&nbsp;</div><div><br></div><div>Polyak averaging- insated of usign the actual parameter (weights) vector, keep a moving average of the parameter vector and use that at test time. Not used that much in practice.</div><div><br></div><div><b>Regularization</b></div><div><b>Dropout</b> is the default regularizer for neural networks. &nbsp;Dropout is an implicit type of ensembling.<br></div><div>In each forward pass, randomly set some neurons to zero.</div><div>Probability of dropping is a hyperparameter, 0.5 is common. (Appendix 7)</div><div>More specifically, what we are setting to zero are the activations (x). Each layer is computing previous activation times weight matrix is your next activation. In each layer, right after computing the activations for that layer, randomly set some of them to zero.</div><div><br></div><div>Dropout is more common in fully connected layers, but you sometimes see this in convolutional layers, in whcih case instead of dropping activations randomly sometines you drop entire feature maps (channels) randomly.</div><div><br></div><div><div>During test time, we multiply back the dropout probability, or, as is more commonly seen, we perform dropout and scale the activations during training and we keep test time as is so that test time inference is faster (“inverted dropout, more commonly used). &nbsp;(Appendix 7)</div></div><div><br></div><div>Inverted Dropout (More Common)</div><div style="font-size: 18px; font-weight: bold;"><div></div></div></div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>p = 0.5
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>def train_step(X):
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H1 = np.maximum(0, np.dot(W1,X) + b1)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  U1 = (np.random.rand(*H1.shape) &lt; p) / p #first dropout mask. Note the /p so we don't have to multiply it back later!
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H1 *= U1
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H2 = np.maximum(0, np.dot(W2, H1) + b2)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  U2 = (np.random.rand(*H2.shape) &lt; p) / p #second dropout mask. Note the /p so we don't have to multiply it back later!
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H2 *= U2
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  out = np.dot(W3, H2) + b3
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>def predict(X):
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H1 = np.maximum(0, np.dot(W1, X) + b1 ) 
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H2 = np.maximum(0, np.dot(W2, H1) + b2 )
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  out = np.dot(W3, H2) + b3
</div></div></div></div><div class="cell text-cell"><div>Vanilla Dropout</div><div></div></div><div class="cell code-cell"><div class="ace-chrome"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>p = 0.5
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>def train_step(X):
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H1 = np.maximum(0, np.dot(W1,X) + b1)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  U1 = np.random.rand(*H1.shape) &lt; p #first dropout mask.
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H1 *= U1
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H2 = np.maximum(0, np.dot(W2, H1) + b2)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  U2 = np.random.rand(*H2.shape) &lt; p #second dropout mask.
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H2 *= U2
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  out = np.dot(W3, H2) + b3
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>def predict(X):
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H1 = np.maximum(0, np.dot(W1, X) + b1 ) * p #scale the activations back
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  H2 = np.maximum(0, np.dot(W2, H1) + b2 ) * p #scale the activations back
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>  out = np.dot(W3, H2) + b3
</div></div></div></div><div class="cell text-cell"><div><br></div><div>L2 regularization is not used that often in neural networks. Too many parameters.&nbsp;<br></div><div><br></div><div><b>Randomness Regularization</b></div><div>Dropout is an example of a general strategy for regularization: During training, add some kind of randomness, and during testing, average out the randomness (sometimes approximate). Batch norm is also an example of this.</div><div>Data Augmentation is an example of this. For images (Inversion, random cropping) (Appendix 8)</div><div>Other ideas: (Appendix 8)<br></div><div>DropConnect (rather than zeroing the activations, randomly zero the weight vector)</div><div>Fractional Max Pooling</div><div>Stochastic Depth&nbsp;</div><div><br></div><div><b>Batch Norm</b></div></div><div class="cell markdown-cell"></div><div class="cell text-cell"><div><br></div><div><b>Transfer Learning</b></div><div>First train on ImageNet or using an existing model, then freeze the lower layers, reinitalize the last layer randomly, and only train the last layer.</div><div>If you have more data, try to fine-tune more and more of the network.&nbsp;</div><div>When fine-tuning, use a small learning rate. 1/10 of original learning rate is a good idea.</div><div>Almost always used for projects! Use an existing trained model and fine-tune it! Basic low-level image features are hardly ever trained from scratch. (Appendix 9)</div><div><br></div><div style="font-size: 18px; font-weight: bold;"><div><b>Appendices</b><br></div></div><div style="font-size: 14px;"><b>Appendix 1</b></div><div style="font-size: 14px;">Poor Conditioning - some dimensions are a lot more ’steep’ than others - this is captured by the condition number of the Hessian - the ratio of the largest to smallest singular value&nbsp;</div><div style="font-size: 14px;"><img src="resources/54D435E9875102A8AC2682F9903C18FD.png" alt="IMG_9962.PNG" width="2208" height="1242"><br></div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;"><b>Appendix 2:</b></div><div style="font-size: 14px;">How momentum helps with Local Minima, Saddle Points, Poor Conditioning</div><div style="font-size: 14px;"><img src="resources/12D9ED69BB62DFF6D6B131AF28A20574.png" alt="IMG_9964.PNG" width="2208" height="1242"><b><br></b></div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;"><b>Appendix 3:&nbsp;</b></div><div style="font-size: 14px;">Nesterov Momentum</div><div style="font-size: 14px;"><img src="resources/D5EDE4C5F504DA4046963DBAB4402731.png" alt="Screenshot 2020-02-26 at 11.52.28 AM.png" width="813" height="365"><br></div><div style="font-size: 14px;"><br></div><div style="font-size: 14px;"><b>Appendix 4: Adam</b></div><div style="font-size: 14px;"><img src="resources/C9E4854544FB0757E58E3BC908CF8E94.png" alt="IMG_9972.PNG" width="2208" height="1242"><b><br></b></div></div><div class="cell text-cell"><img src="resources/E4CCAB0F8B5DEC35DA05C2764D5C1C9A.png" alt="Screenshot 2020-02-26 at 12.19.30 PM.png" width="827" height="413"><br><div></div><div><br></div><div><b>Appendix 5: Learning Rates</b></div><div><img src="resources/433546C2982828A4867186E709889E80.png" alt="Screenshot 2020-02-26 at 12.23.50 PM.png" width="794" height="299"><br></div><div><br></div><div><b>Appendix 6: Second Order and Quasi Second Order Methods</b></div><div><img src="resources/597942E740C4131366D5AF6111705240.png" alt="Screenshot 2020-02-26 at 12.26.55 PM.png" width="822" height="405"><img src="resources/0E8A92A8E5C09BCAF5C80F1A1B94F436.png" alt="Screenshot 2020-02-26 at 12.27.50 PM.png" width="814" height="403"><b><br></b></div><div><br></div><div><b>Appendix 7: Dropout</b></div><div><img src="resources/3FE422F276FE90DB717A7B29E59B6880.png" alt="Screenshot 2020-02-26 at 12.36.23 PM.png" width="806" height="414"><b><br></b></div><div><img src="resources/3E54CD76477BC1064A2A85A897C5899A.png" alt="Screenshot 2020-02-26 at 12.47.02 PM.png" width="824" height="419"><img src="resources/E01133491DEB1984669B91EE25AFE2BF.png" alt="Screenshot 2020-02-26 at 12.47.27 PM.png" width="802" height="409"><br></div><div><b>Appendix 8: Data Augmentation</b></div><div><img src="resources/F8CB86E316C4847029E5B1A280943DDC.png" alt="Screenshot 2020-02-26 at 12.54.33 PM.png" width="820" height="410"><img src="resources/13AC38DCB140A57F166478066771EA49.png" alt="Screenshot 2020-02-26 at 12.54.45 PM.png" width="797" height="416"><br></div><div><img src="resources/5427B96E8B844640866F0D177FAB4CF7.png" alt="Screenshot 2020-02-26 at 12.54.52 PM.png" width="651" height="400"><br></div><div><br></div><div><b>Appendix 8b: Other Randomness Regularization Ideas</b></div><div><img src="resources/C3A3F5B4BF63FD73C566CD2AB48A9DC2.png" alt="Screenshot 2020-02-26 at 12.56.13 PM.png" width="810" height="390"><b><br></b></div><div><img src="resources/4E53C8488E4BE72359B53C3736FA7245.png" alt="Screenshot 2020-02-26 at 12.56.23 PM.png" width="805" height="413"><br></div><div><br></div><div>Appendix 9: Transfer Learning</div><div><div style="font-size: 18px; font-weight: bold;"><div><img src="resources/D9CD907DBA22925315300ADDD9C7160C.png" alt="Screenshot 2020-02-26 at 12.59.55 PM.png" width="837" height="421"><br></div><div><img src="resources/7D3E6B12C2E3388AA0F73B38B3D223C2.png" alt="Screenshot 2020-02-26 at 1.00.34 PM.png" width="812" height="414"><br></div><div><img src="resources/5A40D6C80AFCC21475555E72FC1DD846.png" alt="Screenshot 2020-02-26 at 1.01.14 PM.png" width="812" height="402"><br></div><div><br></div></div><b style="font-size: 18px;"></b></div></div></div>
      <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = 'CS231N (CS224N)-   Lecture 8 - TF and Pytorch Tutorial.html';
if (e.keyCode === 37) window.location.href = 'CS231N (CS224N) - Lecture 4,5 - Backprop, Neural Networks.html';
}</script>
    </body>
    </html>
  