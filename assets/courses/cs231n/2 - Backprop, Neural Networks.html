
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS231N (CS224N) - Lecture 4,5 - Backprop, Neural Networks</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><h1>Backprop</h1>
<p>See (1)</p>
<p><strong>History of NN</strong></p>
<ul>
<li>Rosenblatt Perceptron</li>
<li>Widrow and Hoff: 1960 Adaline /Madaline - multi-layered perceptrion</li>
<li>1986 Rumelhart - Backprop</li>
<li>Hinton and Salakhutdinov 2006</li>
<li>Deep belief networks for acoustic recognition (Adbel-rahman Mohamed) 2010</li>
<li>AlexNet 2012</li>
</ul>
<p><strong>CNNS</strong></p>
<ul>
<li>Hubel and Weisel - 1959 Cat Neocortex -found neurons had hierarchical orientation</li>
<li>Fukushima 1980 - Neuroconitron . Alternating lauers of simple (pooling) and complex cells</li>
<li>LeNet - 1980- Handwriting recognition for zip codes. Applied Backprop to CNNs</li>
<li>ALexNet - 2012</li>
<li>Classificaiton, Image Retrieveal, Object Detection, Object Segmentation, Video, Facial Recognition, Pose Recognition, Game Playing</li>
</ul>
<p>Medical images, classification of galaxies, aerial maps, Image captioning, style transfer</p>
<p><img src="resources/27B946627A98D8F6AC747687E33C95EF.png" alt="Screenshot 2020-02-25 at 11.56.46 AM.png">**<br>
**</p>
<p>Note that each filter produces a dot product with the entire depth of the image, and produces one number as output (the results of the dot product for each layer of the image are added together).</p>
<p>Use multiple filters to stack depth in the next layer.</p>
<p><img src="resources/DEC111AF97909199529D664B8F6466B1.png" alt="Screenshot 2020-02-25 at 11.59.46 AM.png">**<br>
**</p>
<p><img src="resources/7AEFCD160E86A816E833BA47B66F0F3F.png" alt="Screenshot 2020-02-25 at 12.00.13 PM.png"></p>
<p><img src="resources/BD6290A18F647B23255D2798D7AB4CF8.png" alt="Screenshot 2020-02-25 at 12.00.37 PM.png"></p>
<p>(2)</p>
<p>Code for Convolutions in Torch (Appendix 4)</p>
<p>Dimensionality of the Convolution (3 for details)</p>
<p>You can slide the convolutional filter also with different stride. <span class="MathJax" id="MathJax-Element-234-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6979" style="width: 14.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.725em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.908em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-6980"><span class="mi" id="MathJax-Span-6981" style="font-family: STIXGeneral-Italic;">O</span><span class="mi" id="MathJax-Span-6982" style="font-family: STIXGeneral-Italic;">u</span><span class="mi" id="MathJax-Span-6983" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-6984" style="font-family: STIXGeneral-Italic;">p</span><span class="mi" id="MathJax-Span-6985" style="font-family: STIXGeneral-Italic;">u</span><span class="msubsup" id="MathJax-Span-6986"><span style="display: inline-block; position: relative; width: 0.733em; height: 0px;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-6987" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.32em;"><span class="mi" id="MathJax-Span-6988" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-6989" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-6990" style="font-family: STIXGeneral-Italic;">z</span><span class="mi" id="MathJax-Span-6991" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-6992" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-6993" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-6994" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-6995" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.034em;"></span></span><span class="texatom" id="MathJax-Span-6996"><span class="mrow" id="MathJax-Span-6997"><span class="mo" id="MathJax-Span-6998" style="font-family: STIXGeneral-Regular;">/</span></span></span><span class="mi" id="MathJax-Span-6999" style="font-family: STIXGeneral-Italic;">s</span><span class="mi" id="MathJax-Span-7000" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mi" id="MathJax-Span-7001" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mi" id="MathJax-Span-7002" style="font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-7003" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-7004" style="font-family: STIXGeneral-Italic;">e</span><span class="mo" id="MathJax-Span-7005" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mn" id="MathJax-Span-7006" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.111em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-234">Output_size = N-F/stride + 1</script>. Stride is roughly the resolution in which you are looking at your image. It shrinks the image.</p>
<p>We zero-pad our image so that we can maintain the image size. Note that the number of filters is usually a power of 2.</p>
<p>Example:</p>
<p>Input volume: 32x32x3, 10 5x5 fitlers with stride 1, pad 2</p>
<p>=&gt; 5x5x10 x depth (3) p arameters = 750 parameters + 10 bias terms = 760 parameters</p>
<p><strong>Pooling Layers</strong></p>
<p>Dimensionality of the Pooling Layer (3 for details, but basically 2x2 and 3x3 pooling is all that people ever use)**<br>
**</p>
<p>Compress the prepresentations, downsampling them to make them smaller and more manageable.</p>
<p>Example: Max-pool - take the max activation in each region.</p>
<p>Note that pooling is performed over the whole depth (pooling perserves depth).</p>
<p>Interpretation of max-pooling: the activation is “now much the neuron fired in this region”. Max-pooling gives the maximum of how much each filter is active in the local region (for each filter, because filters are counted in depth and max-pooling is performed over the whole depth).\</p>
<p>Note: You can also use stride to use down-sampling, and is getting more popular, but pooling is preferred.</p>
<p><img src="resources/A26AAFC006AFE02067A78ABFBE8E1EEB.png" alt="Screenshot 2020-02-25 at 12.27.42 PM.png"></p>
<p>Trends:</p>
<p>Trend towards smaller filters and deeper architectures, treidn towards getting rid of POOL/FC layers (just CONV)</p>
<p>Typical architectures look like</p>
<p><strong>[(CONV-RELU) *N -POOL?]*M-(FC-RELU) *K, Softmax</strong></p>
<p>where N is usually up to ~5, M is large, K between 0 and 2,</p>
<p>but recent advances such as ResNet/GoogLeNet challenge this paradigm</p>
<p><strong>Appendices</strong></p>
<p><strong>Appendix 1: Computing Backprop</strong></p>
<p>I draw my gradient flow diagrams like this.</p>
<p>If there are any values, here called <em>statistics</em>, aggregated across the batch (like means, std deviations etc. These are 1d and are affected by every instance in the batch, likewise their value affects the backprop of every instance in the batch.) I will <strong>underline</strong> them.</p>
<p>Every time an aggregation is done, I mark that flow with a squiggle ~~.</p>
<ul>
<li>Squiggled edges require re-expansion of the (1D) gradient flowing in back into a 2D form. In Usually that means initializing a 2D matrix and having the 1D gradient affect it somehow. In the case of the average function, the appropriate gradient is 1/N * np.ones((N,D)) * d_out</li>
</ul>
<p>Every time a deaggregation is done (the aggregated statistic is applied to all elements of the batch somehow), I mark that flow with a dash —.</p>
<ul>
<li>Dashed edges take the gradient flowing in and sums it across elements (in numpy, axis=0) to get the gradient of the statistic.</li>
</ul>
<p><img src="resources/F5F653DF8462614DAB448DFBF8F07850.jpg" alt="IMG_0219.jpg"></p>
<p>In the below image, we show the flor of gradients. Note that whenever the original value is underlined, the gradient must also be underlined (a 1d vector). When we move from not underlined to underlined we use np.sum(…, axis=0). When we move from underlined to not underlined, we mark it as expanded and in numpy we initialize a 2D matrix (e.g. np.ones(N,D)) and adjust it according to the original gradient.</p>
<p>In each gradient computation,</p>
<p>dL/dY1 = dL/dY2 * dY2/dY1</p>
<p>where the first term is the gradient flowing back and the second term is the chain rule derivative of this step. In particular, if we have the flowed back gradient at Y2, we take the flowed back gradient and multiply it by a chain rule derivative with respect to the variables in the previous step Y1. For eample in the image below, given the gradient d_1_std at (1/N) the gradient at √(v+e) is d_1_std * ( - std ^(-2)). Thus we use the value at the previous step and plug it in to the derivative of the current step, and multiply that by the backflowing gradient.</p>
<p><img src="resources/B8430A26D9343900018743211BA92D12.jpg" alt="IMG_0220.jpg">**<br>
**</p>
<p><strong>Appendix 1: Backprop</strong></p>
</div><div class="cell markdown-cell"><ul>
<li>Gradient of Softmax Loss:<br>
If we have a softmax function <span class="MathJax" id="MathJax-Element-235-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7007" style="width: 5.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.786em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.388em, 1000em, 3.371em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7008"><span class="msubsup" id="MathJax-Span-7009"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7010" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.563em;"><span class="mi" id="MathJax-Span-7011" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7012" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-7013" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.31em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.275em, 1000em, 4.174em, -0.485em); top: -4.421em; left: 50%; margin-left: -0.439em;"><span class="msubsup" id="MathJax-Span-7014"><span style="display: inline-block; position: relative; width: 0.879em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.485em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7015" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">e</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.331em; left: 0.338em;"><span class="texatom" id="MathJax-Span-7016"><span class="mrow" id="MathJax-Span-7017"><span class="msubsup" id="MathJax-Span-7018"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.37em, -0.493em); top: -2.196em; left: 0em;"><span class="mi" id="MathJax-Span-7019" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span><span style="position: absolute; top: -2.042em; left: 0.282em;"><span class="mi" id="MathJax-Span-7020" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.291em, 1000em, 4.382em, -0.466em); top: -3.544em; left: 50%; margin-left: -1.095em;"><span class="mrow" id="MathJax-Span-7021"><span class="munderover" id="MathJax-Span-7022"><span style="display: inline-block; position: relative; width: 1.01em; height: 0px;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.662em, -0.466em); top: -2.309em; left: 0em;"><span class="mo" id="MathJax-Span-7023" style="font-size: 70.7%; font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -1.986em; left: 0.676em;"><span class="mi" id="MathJax-Span-7024" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.009em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7025" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.991em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7026" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -4.249em; left: 0.338em;"><span class="texatom" id="MathJax-Span-7027"><span class="mrow" id="MathJax-Span-7028"><span class="msubsup" id="MathJax-Span-7029"><span style="display: inline-block; position: relative; width: 0.601em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.37em, -0.493em); top: -2.196em; left: 0em;"><span class="mi" id="MathJax-Span-7030" style="font-size: 50%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span><span style="position: absolute; top: -2.027em; left: 0.282em;"><span class="mi" id="MathJax-Span-7031" style="font-size: 50%; font-family: STIXGeneral-Italic;">k<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.009em;"></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 2.31em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.952em; vertical-align: -0.805em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-235">p_j = \frac{e^{o_j}}{\sum_k s^{o_k}}</script>, then it has a loss function of the form <span class="MathJax" id="MathJax-Element-236-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7032" style="width: 8.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.995em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.604em, 1000em, 3.145em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7033"><span class="mi" id="MathJax-Span-7034" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7035" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-7036" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">−</span><span class="munderover" id="MathJax-Span-7037" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7038" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="mi" id="MathJax-Span-7039" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7040" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7041" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-7042" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-7043" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-7044"></span><span class="mo" id="MathJax-Span-7045" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7046"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7047" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.563em;"><span class="mi" id="MathJax-Span-7048" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7049" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.461em; vertical-align: -0.554em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-236">L = - \sum_j y_j \log(p_j)</script>.<br>
The derivative of this loss is <span class="MathJax" id="MathJax-Element-237-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7050" style="width: 6.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.518em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.469em, 1000em, 3.202em, -0.507em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7051"><span class="mfrac" id="MathJax-Span-7052"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.667em, 1000em, 2.485em, -0.478em); top: -2.732em; left: 50%; margin-left: -0.394em;"><span class="mrow" id="MathJax-Span-7053"><span class="mi" id="MathJax-Span-7054" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-7055" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.667em, 1000em, 2.589em, -0.478em); top: -1.921em; left: 50%; margin-left: -0.507em;"><span class="mrow" id="MathJax-Span-7056"><span class="mi" id="MathJax-Span-7057" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-7058"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-7059" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">o</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.394em;"><span class="mi" id="MathJax-Span-7060" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 1.134em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-7061" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7062" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7063" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.563em;"><span class="mi" id="MathJax-Span-7064" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7065" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-7066" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7067" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-7068" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.674em; vertical-align: -0.617em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-237">\frac{\partial L}{\partial o_i} = p_i - y_i</script> for the target class and <span class="MathJax" id="MathJax-Element-238-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7069" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.613em, -0.582em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7070"><span class="msubsup" id="MathJax-Span-7071"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7072" style="font-family: STIXGeneral-Italic;">p</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.068em; left: 0.563em;"><span class="mi" id="MathJax-Span-7073" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.338em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-238">p_i</script> for the other classes.</li>
<li>Gradient of Softmax Function:<br>
Note that the gradient of the Softmax function (not its negative log likelihood loss) with output <span class="MathJax" id="MathJax-Element-239-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7074" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.711em, 1000em, 2.714em, -0.458em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7075"><span class="mi" id="MathJax-Span-7076" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.863em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-239">i</script> <span class="MathJax" id="MathJax-Element-240-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7077" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.36em, 1000em, 2.523em, -0.49em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7078"><span class="msubsup" id="MathJax-Span-7079"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7080" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7081" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.041em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-240">S_i</script> is <span class="MathJax" id="MathJax-Element-241-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7082" style="width: 8.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.827em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.999em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7083"><span class="msubsup" id="MathJax-Span-7084"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7085" style="font-family: STIXGeneral-Italic;">D</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.732em;"><span class="mi" id="MathJax-Span-7086" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7087"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7088" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7089" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7090" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-7091" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7092" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7093" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7094" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7095"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.714em, -0.483em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7096" style="font-family: STIXGeneral-Italic;">δ</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7097"><span class="mrow" id="MathJax-Span-7098"><span class="mi" id="MathJax-Span-7099" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-7100" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7101" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="msubsup" id="MathJax-Span-7102" style="padding-left: 0.25em;"><span style="display: inline-block; position: relative; width: 0.855em; height: 0px;"><span style="position: absolute; clip: rect(1.698em, 1000em, 2.721em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7103" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.555em;"><span class="mi" id="MathJax-Span-7104" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7105" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.204em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-241">D_jS_i = S_i(\delta_{ij} - S_j)</script>, where <span class="MathJax" id="MathJax-Element-242-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7106" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.359em, 1000em, 2.661em, -0.483em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7107"><span class="msubsup" id="MathJax-Span-7108"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.714em, -0.483em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7109" style="font-family: STIXGeneral-Italic;">δ</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.507em;"><span class="texatom" id="MathJax-Span-7110"><span class="mrow" id="MathJax-Span-7111"><span class="mi" id="MathJax-Span-7112" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-7113" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.195em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-242">\delta_{ij}</script> is the Kronecker delta function (<span class="MathJax" id="MathJax-Element-243-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7114" style="width: 7.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.038em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.999em, -0.492em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7115"><span class="mi" id="MathJax-Span-7116" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-7117" style="font-family: STIXGeneral-Italic;">e</span><span class="mi" id="MathJax-Span-7118" style="font-family: STIXGeneral-Italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mi" id="MathJax-Span-7119" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="msubsup" id="MathJax-Span-7120"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7121" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="texatom" id="MathJax-Span-7122"><span class="mrow" id="MathJax-Span-7123"><span class="mi" id="MathJax-Span-7124" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-7125" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7126" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-7127" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">1</span><span class="mo" id="MathJax-Span-7128" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-7129" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-7130" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7131" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span class="mo" id="MathJax-Span-7132" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.212em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-243">delta_{ij}=1[i=j]</script>)</li>
</ul>
</div><div class="cell text-cell"><div><br></div><img src="resources/CFE3AD22D324EBA88364BD6192D1E39D.png" alt="IMG_9926.PNG" width="2208" height="1242"><div><br></div><div><b>Vectorized gradients</b></div><div>The full Jacobian used to compute the gradient is obviously a matrix. However, it is often sufficient to store a vector if most of the elements dont affect one another.</div><div>For functions like&nbsp;</div></div><div class="cell markdown-cell"><p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-244-Frame" style=""><nobr><span class="math" id="MathJax-Span-7133" style="width: 7.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.644em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.91em, -0.654em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7134"><span class="mi" id="MathJax-Span-7135" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.146em;"></span></span><span class="mo" id="MathJax-Span-7136" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7137" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7138" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7139" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7140" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">m</span><span class="mi" id="MathJax-Span-7141" style="font-family: STIXGeneral-Italic;">a</span><span class="mi" id="MathJax-Span-7142" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7143" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-7144" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-7145" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7146" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-7147" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.107em; vertical-align: -0.292em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-244">f(x) = max(0,x)</script><br>
Only <span class="MathJax" id="MathJax-Element-245-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7148" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.534em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7149"><span class="msubsup" id="MathJax-Span-7150"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7151" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">x_i</script> affects <span class="MathJax" id="MathJax-Element-245-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7148" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.534em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7149"><span class="msubsup" id="MathJax-Span-7150"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7151" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">x_i</script>, so the Jacobian is diagonal. We only have to store the effects of <span class="MathJax" id="MathJax-Element-245-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7148" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.534em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7149"><span class="msubsup" id="MathJax-Span-7150"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7151" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">x_i</script> on <span class="MathJax" id="MathJax-Element-245-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7148" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.534em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7149"><span class="msubsup" id="MathJax-Span-7150"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7151" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7152" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-245">x_i</script> (<span class="MathJax" id="MathJax-Element-246-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7153" style="width: 2.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.447em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7154"><span class="mi" id="MathJax-Span-7155" style="font-family: STIXGeneral-Italic;">O</span><span class="mo" id="MathJax-Span-7156" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7157" style="font-family: STIXGeneral-Italic;">n</span><span class="mo" id="MathJax-Span-7158" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-246">O(n)</script> space) and not any other <span class="MathJax" id="MathJax-Element-247-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7159" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.661em, -0.534em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7160"><span class="msubsup" id="MathJax-Span-7161"><span style="display: inline-block; position: relative; width: 0.804em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.534em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7162" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.504em;"><span class="mi" id="MathJax-Span-7163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.001em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.943em; vertical-align: -0.391em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-247">x_j</script>.<p></p>
</div><div class="cell text-cell"><div><br></div><div><img src="resources/4D66A15067B2EC13480FCD43B2B2DA23.png" alt="IMG_9931.PNG" width="2208" height="1242"><img src="resources/344AAD4707A5FAEBC3EA83C604EBCB25.png" alt="IMG_9932.PNG" width="2208" height="1242"><img src="resources/5FA12ED6B42838B2DEF6AD84865E8F3A.png" alt="IMG_9936.PNG" width="2208" height="1242"></div><div><br></div><div>Appendix 2:</div><div><img src="resources/4508A4B5BD30C65C771304B9935CDAEA.png" alt="Screenshot 2020-02-25 at 12.05.07 PM.png" width="832" height="387"><br></div><div>Play Around wiht Andrej Karparthy’s ConvNet JS Demo!</div><div><a href="https://cs.stanford.edu/people/karpathy/convnetjs/demo/cifar10.html">https://cs.stanford.edu/people/karpathy/convnetjs/demo/cifar10.html</a><br></div><div><img src="resources/0FA9BC0B95B1E9C7FB593FB94AE7AA47.png" alt="Screenshot 2020-02-25 at 12.55.26 PM.png" width="819" height="389"><br></div><div>Appendix 3:</div><div><b>Dimensionality of the Convolutional Layer</b></div><div><img src="resources/51E8118561CA96EBDF039681E08D92E7.png" alt="Screenshot 2020-02-25 at 12.19.02 PM.png" width="781" height="399"><br></div><div>Note: 1x1 convolutions make perfect sense; they change the depth of the layer.</div><div><b>Dimensionality of the Pooling Layer</b><br></div><div><img src="resources/41114512D51E0606D1ED8C1996B87E19.png" alt="Screenshot 2020-02-25 at 12.32.44 PM.png" width="785" height="291"><b><br></b></div><div><br></div><div>Appendix 4:&nbsp;</div><div><b>Convolutions in Torch</b></div><div><img src="resources/D0192A260A8605CE7F20CA9E76424747.png" alt="Screenshot 2020-02-25 at 12.21.00 PM.png" width="828" height="413"></div></div></div>
    </body>
    </html>
  