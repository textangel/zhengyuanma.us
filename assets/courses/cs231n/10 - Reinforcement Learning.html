
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-chrome .ace_gutter {background: #ebebeb;color: #333;overflow : hidden;}.ace-chrome .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-chrome {background-color: #FFFFFF;color: black;}.ace-chrome .ace_cursor {color: black;}.ace-chrome .ace_invisible {color: rgb(191, 191, 191);}.ace-chrome .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-chrome .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-chrome .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-chrome .ace_invalid {background-color: rgb(153, 0, 0);color: white;}.ace-chrome .ace_fold {}.ace-chrome .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-chrome .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-chrome .ace_support.ace_type,.ace-chrome .ace_support.ace_class.ace-chrome .ace_support.ace_other {color: rgb(109, 121, 222);}.ace-chrome .ace_variable.ace_parameter {font-style:italic;color:#FD971F;}.ace-chrome .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-chrome .ace_comment {color: #236e24;}.ace-chrome .ace_comment.ace_doc {color: #236e24;}.ace-chrome .ace_comment.ace_doc.ace_tag {color: #236e24;}.ace-chrome .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-chrome .ace_variable {color: rgb(49, 132, 149);}.ace-chrome .ace_xml-pe {color: rgb(104, 104, 91);}.ace-chrome .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-chrome .ace_heading {color: rgb(12, 7, 255);}.ace-chrome .ace_list {color:rgb(185, 6, 144);}.ace-chrome .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-chrome .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-chrome .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-chrome .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-chrome .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-chrome .ace_gutter-active-line {background-color : #dcdcdc;}.ace-chrome .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-chrome .ace_storage,.ace-chrome .ace_keyword,.ace-chrome .ace_meta.ace_tag {color: rgb(147, 15, 128);}.ace-chrome .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-chrome .ace_string {color: #1A1AA6;}.ace-chrome .ace_entity.ace_other.ace_attribute-name {color: #994409;}.ace-chrome .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="titlearea">
        <h2>CS231N - Lecture 14 - Reinforcement Learning</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p>Reinforcement Learning</p>
<ul>
<li>Problems involving an <strong>agent</strong> interacting with an <strong>environment</strong>, maximizing a reward.</li>
</ul>
<p>RL Problem:</p>
<ul>
<li>At time <span class="MathJax" id="MathJax-Element-260-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7493" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7494"><span class="mi" id="MathJax-Span-7495" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.743em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">t</script>, environment is at state <span class="MathJax" id="MathJax-Element-261-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7496" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7497"><span class="msubsup" id="MathJax-Span-7498"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7499" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7500" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">s_t</script></li>
<li>Agent take action <span class="MathJax" id="MathJax-Element-262-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7501" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.49em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7502"><span class="msubsup" id="MathJax-Span-7503"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7504" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7505" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-262">a_t</script>, and recieves reward <span class="MathJax" id="MathJax-Element-263-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7506" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.462em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7507"><span class="msubsup" id="MathJax-Span-7508"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7509" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7510" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-263">r_t</script>, transitioning environment to next state <span class="MathJax" id="MathJax-Element-264-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7511" style="width: 1.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.544em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7512"><span class="msubsup" id="MathJax-Span-7513"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7514" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7515"><span class="mrow" id="MathJax-Span-7516"><span class="mi" id="MathJax-Span-7517" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7518" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7519" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.814em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">s_{t+1}</script>.</li>
</ul>
</div><div class="cell text-cell"><div><b>Classic Examples:</b></div><div><img src="resources/97472A875F496DF79A1DC316FF488289.png" alt="Screenshot 2020-03-27 at 9.17.25 PM.png" width="939" height="518"><img src="resources/D71590EBF0B40218DF967DF348D53567.png" alt="Screenshot 2020-03-27 at 9.18.21 PM.png" width="946" height="523"></div><div><img src="resources/DE1C7F833A08FE2D8E1416141D2C51B9.png" alt="Screenshot 2020-03-27 at 9.18.57 PM.png" width="939" height="526"><br></div><div><br></div><div><b></b></div></div><div class="cell markdown-cell"><h1>Markov Decision Processes</h1>
<p>This is the mathematical formulation of all RL problems. It assumes the enviornment has the <strong>Markov Property</strong>, that the current state completely characterizes the state of the world.</p>
<p>The entire problem is defined as<br>
<span class="MathJax" id="MathJax-Element-265-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7520" style="width: 5.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.293em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.909em, -0.459em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7521"><span class="mo" id="MathJax-Span-7522" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7523" style="font-family: STIXGeneral-Italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-7524" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7525" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">A</span><span class="mo" id="MathJax-Span-7526" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7527" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">R</span><span class="mo" id="MathJax-Span-7528" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7529" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">P</span><span class="mo" id="MathJax-Span-7530" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7531" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="mo" id="MathJax-Span-7532" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.104em; vertical-align: -0.291em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-265">(S,A,R,P,\gamma)</script>, where</p>
<ul>
<li>S: set of possible states</li>
<li>A: set of possible actions</li>
<li>R: distribution of reward given (state, action) pair</li>
<li>P: transition probability (distribution over next state given (state, action) pair)</li>
<li><span class="MathJax" id="MathJax-Element-266-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7533" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7534"><span class="mi" id="MathJax-Span-7535" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.837em; vertical-align: -0.291em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-266">\gamma</script>: discount factor.</li>
</ul>
<p>At time step <span class="MathJax" id="MathJax-Element-267-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7536" style="width: 2.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.14em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7537"><span class="mi" id="MathJax-Span-7538" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-7539" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-7540" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-267">t=0</script>, environment samples init <span class="MathJax" id="MathJax-Element-268-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7541" style="width: 4.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.392em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7542"><span class="msubsup" id="MathJax-Span-7543"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7544" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7545" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7546" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-7547" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-7548" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7549"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7550" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7551" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7552" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-268">s_0 \sim p(s_0)</script>.<br>
Then for <span class="MathJax" id="MathJax-Element-260-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7493" style="width: 0.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.338em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.819em, 1000em, 2.714em, -0.469em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7494"><span class="mi" id="MathJax-Span-7495" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.743em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-260">t</script> from <span class="MathJax" id="MathJax-Element-269-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7553" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.717em, -0.483em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7554"><span class="mn" id="MathJax-Span-7555" style="font-family: STIXGeneral-Regular;">0</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.078em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-269">0</script> until done:</p>
<ul>
<li>Agent selects <span class="MathJax" id="MathJax-Element-262-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7501" style="width: 1.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.901em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.49em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7502"><span class="msubsup" id="MathJax-Span-7503"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7504" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7505" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-262">a_t</script></li>
<li>Environment samples next reward <span class="MathJax" id="MathJax-Element-270-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7556" style="width: 6.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.912em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.462em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7557"><span class="msubsup" id="MathJax-Span-7558"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7559" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7560" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7561" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-7562" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">R</span><span class="mo" id="MathJax-Span-7563" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-7564" style="font-family: STIXGeneral-Regular;">⋅</span><span class="texatom" id="MathJax-Span-7565"><span class="mrow" id="MathJax-Span-7566"><span class="mo" id="MathJax-Span-7567" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7568"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7569" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7570" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7571" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7572" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7573" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7574" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7575" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-270">r_t \sim R(\cdot | s_t, a_t)</script></li>
<li>Environment samples next state <span class="MathJax" id="MathJax-Element-271-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7576" style="width: 7.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.813em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.882em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7577"><span class="msubsup" id="MathJax-Span-7578"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7579" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7580"><span class="mrow" id="MathJax-Span-7581"><span class="mi" id="MathJax-Span-7582" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7583" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7584" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7585" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-7586" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">P</span><span class="mo" id="MathJax-Span-7587" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-7588" style="font-family: STIXGeneral-Regular;">⋅</span><span class="texatom" id="MathJax-Span-7589"><span class="mrow" id="MathJax-Span-7590"><span class="mo" id="MathJax-Span-7591" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7592"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7593" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7594" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7595" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7596" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7597" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7598" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7599" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-271">s_{t+1} \sim P(\cdot | s_t, a_t)</script></li>
<li>Agent recieves reward <span class="MathJax" id="MathJax-Element-263-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7506" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.523em, -0.462em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7507"><span class="msubsup" id="MathJax-Span-7508"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7509" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7510" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.79em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-263">r_t</script> and next state <span class="MathJax" id="MathJax-Element-264-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7511" style="width: 1.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.544em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7512"><span class="msubsup" id="MathJax-Span-7513"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7514" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7515"><span class="mrow" id="MathJax-Span-7516"><span class="mi" id="MathJax-Span-7517" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7518" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7519" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.814em; vertical-align: -0.261em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-264">s_{t+1}</script></li>
</ul>
<p>A <strong>policy</strong> <span class="MathJax" id="MathJax-Element-272-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7600" style="width: 4.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.697em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7601"><span class="mi" id="MathJax-Span-7602" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7603" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">:</span><span class="mi" id="MathJax-Span-7604" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.008em;"></span></span><span class="mo" id="MathJax-Span-7605" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="mi" id="MathJax-Span-7606" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">A</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.886em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-272">\pi: S \rightarrow A</script> is a function that specifies what action to take in each state.<br>
Objective: find policy <span class="MathJax" id="MathJax-Element-273-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7607" style="width: 1.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.894em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7608"><span class="mi" id="MathJax-Span-7609" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7610" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">∗</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.668em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-273">\pi*</script> that maximizes the cumulative expected discounted reward <span class="MathJax" id="MathJax-Element-274-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7611" style="width: 4.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.885em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.266em, 1000em, 2.678em, -0.449em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7612"><span class="munderover" id="MathJax-Span-7613"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7614" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7615"><span class="mrow" id="MathJax-Span-7616"><span class="mi" id="MathJax-Span-7617" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7618" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&gt;</span><span class="mn" id="MathJax-Span-7619" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7620" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7621"><span class="msubsup" id="MathJax-Span-7622"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7623" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.509em;"><span class="mi" id="MathJax-Span-7624" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7625"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7626" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7627" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.318em; vertical-align: -0.41em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-274">\sum_{t>0}{\gamma^tr_t}</script>. More specifically<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-275-Frame" style=""><nobr><span class="math" id="MathJax-Span-7628" style="width: 34.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.743em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.488em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-7629"><span class="mi" id="MathJax-Span-7630" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7631" style="font-family: STIXGeneral-Regular;">∗</span><span class="mo" id="MathJax-Span-7632" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7633" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">arg</span><span class="mo" id="MathJax-Span-7634"></span><span class="munderover" id="MathJax-Span-7635" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-7636" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.837em, 1000em, 2.59em, -0.493em); top: -1.624em; left: 0.676em;"><span class="mi" id="MathJax-Span-7637" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7638" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7639"><span class="mi" id="MathJax-Span-7640" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-7641" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-7642" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="munderover" id="MathJax-Span-7643"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7644" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.594em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7645"><span class="mrow" id="MathJax-Span-7646"><span class="mi" id="MathJax-Span-7647" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7648" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&gt;</span><span class="mn" id="MathJax-Span-7649" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7650" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7651"><span class="msubsup" id="MathJax-Span-7652"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7653" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-7654" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7655"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7656" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7657" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7658"><span class="mrow" id="MathJax-Span-7659"><span class="mo" id="MathJax-Span-7660" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-7661" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7662" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span><span class="mspace" id="MathJax-Span-7663" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-7664" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-7665" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">s</span><span class="mo" id="MathJax-Span-7666" style="font-family: STIXGeneral-Regular;">.</span><span class="mi" id="MathJax-Span-7667" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.018em;"></span></span><span class="mo" id="MathJax-Span-7668" style="font-family: STIXGeneral-Regular;">.</span><span class="msubsup" id="MathJax-Span-7669" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7670" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7671" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7672" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-7673" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-7674" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-7675"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7676" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7677" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7678" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7679" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7680" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7681" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7682" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7683" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-7684" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7685" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-7686" style="font-family: STIXGeneral-Regular;">⋅</span><span class="texatom" id="MathJax-Span-7687"><span class="mrow" id="MathJax-Span-7688"><span class="mo" id="MathJax-Span-7689" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7690"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7691" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7692" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7693" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7694" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7695" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7696" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-7697"><span class="mrow" id="MathJax-Span-7698"><span class="mi" id="MathJax-Span-7699" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7700" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-7701" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7702" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∼</span><span class="mi" id="MathJax-Span-7703" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-7704" style="font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-7705" style="font-family: STIXGeneral-Regular;">⋅</span><span class="texatom" id="MathJax-Span-7706"><span class="mrow" id="MathJax-Span-7707"><span class="mo" id="MathJax-Span-7708" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7709"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7710" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7711" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7712" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7713" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7714" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-7715" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7716" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-275">\pi*  = \arg \max_\pi \mathbb{E}\left[\sum_{t>0}{\gamma^tr_t}|\pi\right] \;\; s.t. s_0 \sim p(s_0), a_t \sim\pi(\cdot | s_t), s_{t+1} \sim p(\cdot | s_t, a_t)</script>.<p></p>
<p>Following a policy produces sample trajectories (or paths) <span class="MathJax" id="MathJax-Element-276-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7717" style="width: 10.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.516em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.863em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7718"><span class="msubsup" id="MathJax-Span-7719"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7720" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7721" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7722" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7723" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7724" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-7725" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7726" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7727" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7728" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-7729" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7730" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7731" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7732" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7733" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7734" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7735" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7736" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-7737" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7738" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7739" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7740" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-7741" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7742" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-7743" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-7744" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-7745" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.793em; vertical-align: -0.24em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-276">s_0,a_0,r_0, s_1,a_1,r_1,...</script></p>
<p>The <strong>value function</strong> <span class="MathJax" id="MathJax-Element-277-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7746" style="width: 2.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.365em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7747"><span class="msubsup" id="MathJax-Span-7748"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7749" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="mi" id="MathJax-Span-7750" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7751" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7752" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7753" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.079em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-277">V^\pi(s)</script> at state <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script> is the expected cumulative reward from following the policy at state <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script>. [Answers how good is a state?]<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-280-Frame" style=""><nobr><span class="math" id="MathJax-Span-7760" style="width: 14.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.725em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.431em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-7761"><span class="msubsup" id="MathJax-Span-7762"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7763" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.805em;"><span class="mi" id="MathJax-Span-7764" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7765" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7766" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7767" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7768" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-7769" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-7770"><span class="mi" id="MathJax-Span-7771" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-7772" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-7773" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="munderover" id="MathJax-Span-7774"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7775" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.594em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7776"><span class="mrow" id="MathJax-Span-7777"><span class="mi" id="MathJax-Span-7778" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7779" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&gt;</span><span class="mn" id="MathJax-Span-7780" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7781" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7782"><span class="msubsup" id="MathJax-Span-7783"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7784" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-7785" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7786"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7787" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7788" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7789"><span class="mrow" id="MathJax-Span-7790"><span class="mo" id="MathJax-Span-7791" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7792"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7793" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7794" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7795" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7796" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">s</span><span class="mo" id="MathJax-Span-7797" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7798" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7799" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-280">V^\pi(s) = \mathbb{E} \left[\sum_{t>0}{\gamma^tr_t}|s_0=s, \pi\right]</script><p></p>
<p>The <strong>Q-value function</strong> <span class="MathJax" id="MathJax-Element-281-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7800" style="width: 3.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.266em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.669em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7801"><span class="msubsup" id="MathJax-Span-7802"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7803" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mi" id="MathJax-Span-7804" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7805" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7806" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7807" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7808" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7809" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.099em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-281">Q^\pi(s,a)</script> at state <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script> and action <span class="MathJax" id="MathJax-Element-315-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8339" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8340"><span class="mi" id="MathJax-Span-8341" style="font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">a</script> is the expected cumulative reward from taking action <span class="MathJax" id="MathJax-Element-315-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8339" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8340"><span class="mi" id="MathJax-Span-8341" style="font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">a</script> in state <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script> and then following the policy</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-286-Frame" style=""><nobr><span class="math" id="MathJax-Span-7822" style="width: 18.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.892em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.154em, 1000em, 5.567em, -0.448em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-7823"><span class="msubsup" id="MathJax-Span-7824"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7825" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mi" id="MathJax-Span-7826" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7827" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7828" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7829" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7830" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7831" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7832" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-7833" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-7834"><span class="mi" id="MathJax-Span-7835" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-7836" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-7837" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">[</span></span><span class="munderover" id="MathJax-Span-7838"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-7839" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.594em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-7840"><span class="mrow" id="MathJax-Span-7841"><span class="mi" id="MathJax-Span-7842" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7843" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&gt;</span><span class="mn" id="MathJax-Span-7844" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7845" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7846"><span class="msubsup" id="MathJax-Span-7847"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7848" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-7849" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7850"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7851" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7852" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7853"><span class="mrow" id="MathJax-Span-7854"><span class="mo" id="MathJax-Span-7855" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7856"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7857" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7858" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7859" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7860" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">s</span><span class="mo" id="MathJax-Span-7861" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7862" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7863" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-7864" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7865" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7866" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">a</span><span class="mo" id="MathJax-Span-7867" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7868" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7869" style="vertical-align: -0.778em;"><span style="font-family: STIXSizeFourSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 3.538em; vertical-align: -1.492em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-286">Q^\pi(s,a) = \mathbb{E} \left[ \sum_{t>0}{\gamma^tr_t}|s_0=s, a_0=a, \pi\right]</script><p></p>
<p>The optimal Q value function <span class="MathJax" id="MathJax-Element-287-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7870" style="width: 21.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.538em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.448em); top: -2.984em; left: 0em;"><span class="mrow" id="MathJax-Span-7871"><span class="msubsup" id="MathJax-Span-7872"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7873" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-7874" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7875" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-7876" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-7877" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7878" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-7879" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-7880" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-7881" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.215em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-7882" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="mi" id="MathJax-Span-7883" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7884" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7885"><span class="mi" id="MathJax-Span-7886" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-7887" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-7888" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">[</span></span><span class="munderover" id="MathJax-Span-7889"><span style="display: inline-block; position: relative; width: 2.158em; height: 0px;"><span style="position: absolute; clip: rect(1.548em, 1000em, 2.907em, -0.449em); top: -2.477em; left: 0em;"><span class="mo" id="MathJax-Span-7890" style="font-family: STIXGeneral-Regular; vertical-align: -0.002em;">∑</span><span style="display: inline-block; width: 0px; height: 2.477em;"></span></span><span style="position: absolute; top: -2.012em; left: 0.957em;"><span class="texatom" id="MathJax-Span-7891"><span class="mrow" id="MathJax-Span-7892"><span class="mi" id="MathJax-Span-7893" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-7894" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">&gt;</span><span class="mn" id="MathJax-Span-7895" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7896" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-7897"><span class="msubsup" id="MathJax-Span-7898"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7899" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.509em;"><span class="mi" id="MathJax-Span-7900" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-7901"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7902" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-7903" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span></span><span class="texatom" id="MathJax-Span-7904"><span class="mrow" id="MathJax-Span-7905"><span class="mo" id="MathJax-Span-7906" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-7907"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7908" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-7909" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7910" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7911" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">s</span><span class="mo" id="MathJax-Span-7912" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-7913" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7914" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-7915" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7916" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-7917" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">a</span><span class="mo" id="MathJax-Span-7918" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-7919" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-7920" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.49em; vertical-align: -0.468em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-287">Q^*(s,a) = \max_\pi \mathbb{E} \left[ \sum_{t>0}{\gamma^tr_t}|s_0=s, a_0=a, \pi\right]</script> satisfies the following <strong>Bellman Equation</strong>. (Intuition: if the optimial state-action values for the next time-step <span class="MathJax" id="MathJax-Element-288-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7921" style="width: 4.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.054em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7922"><span class="msubsup" id="MathJax-Span-7923"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7924" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-7925" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7926" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-7927"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7928" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-7929" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7930" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-7931" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7932" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.563em;"><span class="mo" id="MathJax-Span-7933" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7934" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.173em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-288">Q^*(s',a')</script> are known, then the optimal strategy is to take the action that maximizes the expected value of <span class="MathJax" id="MathJax-Element-289-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7935" style="width: 6.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.137em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.602em, 1000em, 2.909em, -0.462em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-7936"><span class="mi" id="MathJax-Span-7937" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-7938" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-7939" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="msubsup" id="MathJax-Span-7940"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7941" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-7942" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7943" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-7944"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7945" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-7946" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7947" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-7948" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7949" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.563em;"><span class="mo" id="MathJax-Span-7950" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-7951" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.2em; vertical-align: -0.291em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-289">r + \gamma Q^*(s',a')</script>).</p>
<p></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-305-Frame" style=""><nobr><span class="math" id="MathJax-Span-8151" style="width: 19.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.849em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.461em, 1000em, 5.259em, -0.448em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-8152"><span class="msubsup" id="MathJax-Span-8153"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8154" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mo" id="MathJax-Span-8155" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8156" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8157" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8158" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8159" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8160" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8161" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8162" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8163"><span class="mrow" id="MathJax-Span-8164"><span class="mi" id="MathJax-Span-8165" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8166"><span class="mrow" id="MathJax-Span-8167"><span class="msup" id="MathJax-Span-8168"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8169" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.338em;"><span class="mo" id="MathJax-Span-8170" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-8171" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8172" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8173" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8174" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mi" id="MathJax-Span-8175" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8176" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8177" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="munderover" id="MathJax-Span-8178" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8179" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.29em, 1000em, 4.274em, -0.495em); top: -3.261em; left: 0.537em;"><span class="texatom" id="MathJax-Span-8180"><span class="mrow" id="MathJax-Span-8181"><span class="msup" id="MathJax-Span-8182"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8183" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.394em;"><span class="mo" id="MathJax-Span-8184" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8185" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8186" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mo" id="MathJax-Span-8187" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8188" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-8189"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8190" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.45em;"><span class="mo" id="MathJax-Span-8191" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8192" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-8193" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8194" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.563em;"><span class="mo" id="MathJax-Span-8195" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8196" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-8197"><span class="mrow" id="MathJax-Span-8198"><span class="mo" id="MathJax-Span-8199" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8200" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8201" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8202" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8203" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.856em; vertical-align: -1.15em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-305">Q^*(s,a) = \mathbb{E}_{s' \sim E}\left[r + \gamma \max_{a'} Q^*(s',a')|s,a\right]</script><p></p>
<p>Note that the optimal policy <span class="MathJax" id="MathJax-Element-313-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8331" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.126em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.383em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8332"><span class="msubsup" id="MathJax-Span-8333"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8334" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-8335" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.917em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-313">\pi^*</script> corresponds to taking the best action in any state as specified by <span class="MathJax" id="MathJax-Element-312-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8326" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.301em, 1000em, 2.547em, -0.448em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8327"><span class="msubsup" id="MathJax-Span-8328"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8329" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-8330" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.133em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-312">Q^*</script>.</p>
<h2>Value Iteration</h2>
<p>Value iteration is one way to solve for the optimal policy. It is a DP algorithm that computes <span class="MathJax" id="MathJax-Element-293-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8015" style="width: 4.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.998em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.949em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8016"><span class="msubsup" id="MathJax-Span-8017"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8018" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8019"><span class="mrow" id="MathJax-Span-8020"><span class="mi" id="MathJax-Span-8021" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8022" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8023" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8024" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8025" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8026" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8027" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8028" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.149em; vertical-align: -0.336em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-293">Q_{i+1}(s,a)</script> iteratively, using the Bellman equation as an interative update. <span class="MathJax" id="MathJax-Element-294-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8029" style="width: 1.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.361em, 1000em, 2.59em, -0.448em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8030"><span class="msubsup" id="MathJax-Span-8031"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8032" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="mi" id="MathJax-Span-8033" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.114em; vertical-align: -0.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-294">Q_i</script> will converge to <span class="MathJax" id="MathJax-Element-312-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8326" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.301em, 1000em, 2.547em, -0.448em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8327"><span class="msubsup" id="MathJax-Span-8328"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8329" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-8330" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.133em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-312">Q^*</script> as <span class="MathJax" id="MathJax-Element-296-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8039" style="width: 3.141em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.815em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.711em, 1000em, 2.714em, -0.458em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8040"><span class="mi" id="MathJax-Span-8041" style="font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8042" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">→</span><span class="mi" id="MathJax-Span-8043" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∞</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.863em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-296">i \rightarrow \infty</script>.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-297-Frame" style=""><nobr><span class="math" id="MathJax-Span-8044" style="width: 18.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.723em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.461em, 1000em, 5.259em, -0.448em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-8045"><span class="msubsup" id="MathJax-Span-8046"><span style="display: inline-block; position: relative; width: 1.933em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8047" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8048"><span class="mrow" id="MathJax-Span-8049"><span class="mi" id="MathJax-Span-8050" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8051" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8052" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8053" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8054" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8055" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8056" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8057" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8058" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="texatom" id="MathJax-Span-8059" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-8060"><span class="mi" id="MathJax-Span-8061" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-8062" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8063" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mi" id="MathJax-Span-8064" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8065" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8066" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="munderover" id="MathJax-Span-8067" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8068" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.29em, 1000em, 4.274em, -0.495em); top: -3.261em; left: 0.537em;"><span class="texatom" id="MathJax-Span-8069"><span class="mrow" id="MathJax-Span-8070"><span class="msup" id="MathJax-Span-8071"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8072" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.394em;"><span class="mo" id="MathJax-Span-8073" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8074" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8075" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="mi" id="MathJax-Span-8076" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8077" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-8078"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8079" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.45em;"><span class="mo" id="MathJax-Span-8080" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8081" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-8082" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8083" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.563em;"><span class="mo" id="MathJax-Span-8084" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8085" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-8086"><span class="mrow" id="MathJax-Span-8087"><span class="mo" id="MathJax-Span-8088" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8089" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8090" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8091" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8092" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.856em; vertical-align: -1.15em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-297">Q_{i+1}(s,a) = \mathbb{E}\left[r + \gamma \max_{a'}Q_i(s',a')|s,a\right]</script><p></p>
<p>Intuition:<br>
Problem: This is not scalable. Requires to compute <span class="MathJax" id="MathJax-Element-298-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8093" style="width: 3.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.759em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8094"><span class="mi" id="MathJax-Span-8095" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-8096" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8097" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8098" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8099" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8100" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.077em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-298">Q(s,a)</script> for every state-action pair. If state is e.g. current game pixels, computationally infeasible to compute for entire state space!</p>
<p>Solution: Approximate <span class="MathJax" id="MathJax-Element-299-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8101" style="width: 3.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.097em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.928em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8102"><span class="msubsup" id="MathJax-Span-8103"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8104" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.091em; left: 0.732em;"><span class="texatom" id="MathJax-Span-8105"><span class="mrow" id="MathJax-Span-8106"><span class="mi" id="MathJax-Span-8107" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8108" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8109" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8110" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8111" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8112" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.125em; vertical-align: -0.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-299">Q_{i}(s,a)</script> using a function approximator, e.g. a neural network. This is <strong>Q-learning</strong>): <span class="MathJax" id="MathJax-Element-300-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8113" style="width: 9.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.277em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.639em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8114"><span class="mi" id="MathJax-Span-8115" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-8116" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8117" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8118" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8119" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8120" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8121" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8122" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8123" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">≈</span><span class="msubsup" id="MathJax-Span-8124" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8125" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-8126" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8127" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8128" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8129" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8130" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8131" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.133em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-300">Q(s,a;\theta) \approx Q^*(s,a)</script>. Here, <span class="MathJax" id="MathJax-Element-301-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8132" style="width: 4.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.773em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8133"><span class="mi" id="MathJax-Span-8134" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-8135" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8136" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8137" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8138" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8139" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8140" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8141" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-301">Q(s,a;\theta)</script> is interpreted as, "if I take action <span class="MathJax" id="MathJax-Element-315-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8339" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8340"><span class="mi" id="MathJax-Span-8341" style="font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">a</script> from state <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script>, what is an approximation of the best cumulative reward I can hope for?"</p>
<h2>Q-Learning</h2>
<p>We want to find a <span class="MathJax" id="MathJax-Element-304-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8148" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8149"><span class="mi" id="MathJax-Span-8150" style="font-family: STIXGeneral-Italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.066em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-304">Q</script>-function that satisfies the Bellman Equation:<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-305-Frame" style=""><nobr><span class="math" id="MathJax-Span-8151" style="width: 19.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.849em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.461em, 1000em, 5.259em, -0.448em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-8152"><span class="msubsup" id="MathJax-Span-8153"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8154" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mo" id="MathJax-Span-8155" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8156" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8157" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8158" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8159" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8160" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8161" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8162" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8163"><span class="mrow" id="MathJax-Span-8164"><span class="mi" id="MathJax-Span-8165" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8166"><span class="mrow" id="MathJax-Span-8167"><span class="msup" id="MathJax-Span-8168"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8169" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.338em;"><span class="mo" id="MathJax-Span-8170" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-8171" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8172" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8173" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8174" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mi" id="MathJax-Span-8175" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8176" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8177" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="munderover" id="MathJax-Span-8178" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8179" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.29em, 1000em, 4.274em, -0.495em); top: -3.261em; left: 0.537em;"><span class="texatom" id="MathJax-Span-8180"><span class="mrow" id="MathJax-Span-8181"><span class="msup" id="MathJax-Span-8182"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8183" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.394em;"><span class="mo" id="MathJax-Span-8184" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8185" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8186" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.732em;"><span class="mo" id="MathJax-Span-8187" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8188" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-8189"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8190" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.45em;"><span class="mo" id="MathJax-Span-8191" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8192" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-8193" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8194" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.563em;"><span class="mo" id="MathJax-Span-8195" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8196" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-8197"><span class="mrow" id="MathJax-Span-8198"><span class="mo" id="MathJax-Span-8199" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8200" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8201" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8202" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8203" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.856em; vertical-align: -1.15em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-305">Q^*(s,a) = \mathbb{E}_{s' \sim E}\left[r + \gamma \max_{a'} Q^*(s',a')|s,a\right]</script><p></p>
<p>We approximate Q* as a neural network <span class="MathJax" id="MathJax-Element-306-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8204" style="width: 4.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.054em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8205"><span class="mi" id="MathJax-Span-8206" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-8207" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8208" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8209" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8210" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8211" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-8212" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.793em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8213" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="mi" id="MathJax-Span-8214" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8215" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.08em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-306">Q(s,a;\theta_i)</script>. The interpration of Q is "if I take action <span class="MathJax" id="MathJax-Element-315-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8339" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8340"><span class="mi" id="MathJax-Span-8341" style="font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">a</script> from state <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script>, what is an approximation of the best cumulative reward I can hope for?"</p>
<p><strong>Forward Pass</strong><br>
Loss Function: <span class="MathJax" id="MathJax-Element-309-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8222" style="width: 16.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.696em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.484em, 1000em, 2.998em, -0.515em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8223"><span class="msubsup" id="MathJax-Span-8224"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8225" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.616em;"><span class="mi" id="MathJax-Span-8226" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8227" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8228"><span style="display: inline-block; position: relative; width: 0.793em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8229" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="mi" id="MathJax-Span-8230" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8231" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8232" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8233" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.172em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8234"><span class="mrow" id="MathJax-Span-8235"><span class="mi" id="MathJax-Span-8236" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8237"><span class="mrow" id="MathJax-Span-8238"><span class="mi" id="MathJax-Span-8239" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8240" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8241" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-8242" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8243" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ρ</span><span class="mo" id="MathJax-Span-8244" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8245" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⋅</span><span class="mo" id="MathJax-Span-8246" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8247" style="font-family: STIXGeneral-Regular;">[</span><span class="mo" id="MathJax-Span-8248" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8249"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8250" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-8251" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8252" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-8253" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Q</span><span class="mo" id="MathJax-Span-8254" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8255" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8256" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8257" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8258" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-8259" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.793em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8260" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="mi" id="MathJax-Span-8261" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8262" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8263"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.478em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8264" style="font-family: STIXGeneral-Regular;">)</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.712em; left: 0.338em;"><span class="mn" id="MathJax-Span-8265" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8266" style="font-family: STIXGeneral-Regular;">]</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.43em; vertical-align: -0.39em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-309">L_i(\theta_i) = \mathbb{E}_{s,a\sim \rho(\cdot)} [(y_i - Q(s,a;\theta_i))^2]</script>,<br>
where <span class="MathJax" id="MathJax-Element-310-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8267" style="width: 19.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.568em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.95em, 1000em, 3.518em, -0.531em); top: -2.984em; left: 0em;"><span class="mrow" id="MathJax-Span-8268"><span class="msubsup" id="MathJax-Span-8269"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8270" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-8271" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8272" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8273" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8274"><span class="mrow" id="MathJax-Span-8275"><span class="mi" id="MathJax-Span-8276" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8277"><span class="mrow" id="MathJax-Span-8278"><span class="msup" id="MathJax-Span-8279"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8280" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.338em;"><span class="mo" id="MathJax-Span-8281" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-8282" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8283" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8284" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8285" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">[</span></span><span class="mi" id="MathJax-Span-8286" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8287" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8288" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="munderover" id="MathJax-Span-8289" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.493em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8290" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.803em; left: 1.745em;"><span class="texatom" id="MathJax-Span-8291"><span class="mrow" id="MathJax-Span-8292"><span class="msup" id="MathJax-Span-8293"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8294" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.394em;"><span class="mo" id="MathJax-Span-8295" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-8296" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Q</span><span class="mo" id="MathJax-Span-8297" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-8298"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8299" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.45em;"><span class="mo" id="MathJax-Span-8300" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8301" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-8302" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8303" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.563em;"><span class="mo" id="MathJax-Span-8304" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8305" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-8306" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.694em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8307" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-8308"><span class="mrow" id="MathJax-Span-8309"><span class="mi" id="MathJax-Span-8310" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8311" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-8312" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8313" style="font-family: STIXGeneral-Regular;">)</span><span class="texatom" id="MathJax-Span-8314"><span class="mrow" id="MathJax-Span-8315"><span class="mo" id="MathJax-Span-8316" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="mi" id="MathJax-Span-8317" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8318" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8319" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8320" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.49em; vertical-align: -0.468em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-310">y_i = \mathbb{E}_{s' \sim E}\left[r + \gamma \max_{a'} Q(s',a';\theta_{i-1})|s,a\right]</script></p>
<p>Idea: This neural network enforces closeness to the Bellman function, that is, it iteratively tries to make the Q-value close to the target value (<span class="MathJax" id="MathJax-Element-311-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8321" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.586em, 1000em, 2.614em, -0.531em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8322"><span class="msubsup" id="MathJax-Span-8323"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.909em, -0.531em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8324" style="font-family: STIXGeneral-Italic;">y</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.067em; left: 0.45em;"><span class="mi" id="MathJax-Span-8325" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.891em; vertical-align: -0.339em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-311">y_i</script>) that it should have if the Q-function corresponds to optimal <span class="MathJax" id="MathJax-Element-312-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8326" style="width: 1.391em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.239em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.301em, 1000em, 2.547em, -0.448em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8327"><span class="msubsup" id="MathJax-Span-8328"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(1.699em, 1000em, 2.885em, -0.448em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8329" style="font-family: STIXGeneral-Italic;">Q</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.702em; left: 0.732em;"><span class="mo" id="MathJax-Span-8330" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.133em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-312">Q^*</script> and optimal policy <span class="MathJax" id="MathJax-Element-313-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8331" style="width: 1.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.126em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.331em, 1000em, 2.383em, -0.488em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8332"><span class="msubsup" id="MathJax-Span-8333"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8334" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.671em; left: 0.623em;"><span class="mo" id="MathJax-Span-8335" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.917em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-313">\pi^*</script>. Note that this is an RNN, with the same weights shared for all values of <span class="MathJax" id="MathJax-Element-314-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8336" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8337"><span class="mi" id="MathJax-Span-8338" style="font-family: STIXGeneral-Italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.63em; vertical-align: -0.077em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-314">s</script>, <span class="MathJax" id="MathJax-Element-315-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8339" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8340"><span class="mi" id="MathJax-Span-8341" style="font-family: STIXGeneral-Italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.627em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-315">a</script>, so it becomes more precise after iteration.</p>
<p><strong>Backward Pass</strong><br>
Gradient Update (w.r.t. Q-function parameters <span class="MathJax" id="MathJax-Element-316-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8342" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8343"><span class="mi" id="MathJax-Span-8344" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-316">\theta</script>):<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-317-Frame" style=""><nobr><span class="math" id="MathJax-Span-8345" style="width: 35.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.32em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(2.461em, 1000em, 5.259em, -0.444em); top: -4.11em; left: 0em;"><span class="mrow" id="MathJax-Span-8346"><span class="msubsup" id="MathJax-Span-8347"><span style="display: inline-block; position: relative; width: 1.469em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8348" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8349"><span class="mrow" id="MathJax-Span-8350"><span class="msubsup" id="MathJax-Span-8351"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8352" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="mi" id="MathJax-Span-8353" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8354"><span style="display: inline-block; position: relative; width: 0.917em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.703em, -0.515em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8355" style="font-family: STIXGeneral-Italic;">L<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.616em;"><span class="mi" id="MathJax-Span-8356" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8357" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8358"><span style="display: inline-block; position: relative; width: 0.793em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8359" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="mi" id="MathJax-Span-8360" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8361" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8362" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8363" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 4.974em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8364"><span class="mrow" id="MathJax-Span-8365"><span class="mi" id="MathJax-Span-8366" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8367"><span class="mrow" id="MathJax-Span-8368"><span class="mi" id="MathJax-Span-8369" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8370" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8371" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span class="mo" id="MathJax-Span-8372" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8373" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">ρ</span><span class="mo" id="MathJax-Span-8374" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mo" id="MathJax-Span-8375" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⋅</span><span class="mo" id="MathJax-Span-8376" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8377" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">;</span><span class="msup" id="MathJax-Span-8378"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px;"><span style="position: absolute; clip: rect(1.827em, 1000em, 2.487em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8379" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.4em; left: 0.338em;"><span class="mo" id="MathJax-Span-8380" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span><span class="mo" id="MathJax-Span-8381" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8382" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8383" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8384" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mi" id="MathJax-Span-8385" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8386" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8387" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span class="munderover" id="MathJax-Span-8388" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.745em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8389" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.29em, 1000em, 4.274em, -0.495em); top: -3.261em; left: 0.537em;"><span class="texatom" id="MathJax-Span-8390"><span class="mrow" id="MathJax-Span-8391"><span class="msup" id="MathJax-Span-8392"><span style="display: inline-block; position: relative; width: 0.672em; height: 0px;"><span style="position: absolute; clip: rect(1.828em, 1000em, 2.485em, -0.495em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8393" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.453em; left: 0.394em;"><span class="mo" id="MathJax-Span-8394" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-8395" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">Q</span><span class="mo" id="MathJax-Span-8396" style="font-family: STIXGeneral-Regular;">(</span><span class="msup" id="MathJax-Span-8397"><span style="display: inline-block; position: relative; width: 0.807em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8398" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.45em;"><span class="mo" id="MathJax-Span-8399" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8400" style="font-family: STIXGeneral-Regular;">,</span><span class="msup" id="MathJax-Span-8401" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8402" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.563em;"><span class="mo" id="MathJax-Span-8403" style="font-size: 70.7%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8404" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-8405" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.694em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8406" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="texatom" id="MathJax-Span-8407"><span class="mrow" id="MathJax-Span-8408"><span class="mi" id="MathJax-Span-8409" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-8410" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-8411" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8412" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8413" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">−</span><span class="mi" id="MathJax-Span-8414" style="font-family: STIXGeneral-Italic; padding-left: 0.25em;">Q</span><span class="mo" id="MathJax-Span-8415" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8416" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8417" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8418" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8419" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-8420" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.793em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8421" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="mi" id="MathJax-Span-8422" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8423" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8424" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8425"><span style="display: inline-block; position: relative; width: 1.469em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8426" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -3.848em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8427"><span class="mrow" id="MathJax-Span-8428"><span class="msubsup" id="MathJax-Span-8429"><span style="display: inline-block; position: relative; width: 0.606em; height: 0px;"><span style="position: absolute; clip: rect(1.66em, 1000em, 2.485em, -0.488em); top: -2.309em; left: 0em;"><span class="mi" id="MathJax-Span-8430" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; top: -2.09em; left: 0.384em;"><span class="mi" id="MathJax-Span-8431" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-8432" style="font-family: STIXGeneral-Italic;">Q</span><span class="mo" id="MathJax-Span-8433" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8434" style="font-family: STIXGeneral-Italic;">s</span><span class="mo" id="MathJax-Span-8435" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8436" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-8437" style="font-family: STIXGeneral-Regular;">;</span><span class="msubsup" id="MathJax-Span-8438" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.793em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8439" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.493em;"><span class="mi" id="MathJax-Span-8440" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8441" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8442" style="vertical-align: -0.586em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.11em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.856em; vertical-align: -1.15em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-317">\nabla_{\theta_i}L_i(\theta_i) = \mathbb{E}_{s,a \sim \rho(\cdot); s' \sim E} \left[r + \gamma \max_{a'} Q(s',a'; \theta_{i-1}) - Q(s,a;\theta_i)) \nabla_{\theta_i}Q(s,a;\theta_i)\right]</script><p></p>
<p><strong>Example: Atari Games</strong></p>
</div><div class="cell text-cell"><div><img src="resources/DE33438C71AD1979BC0FA7F52FD38447.png" alt="Screenshot 2020-03-28 at 11.33.18 AM.png" width="951" height="527"><br></div><div><img src="resources/5DD245859D687FC45A5B3B0ECBEF2291.png" alt="Screenshot 2020-03-28 at 11.43.48 AM.png" width="947" height="529"><br></div><div><img src="resources/522570818B876CB21424410915598AD5.png" alt="Screenshot 2020-03-28 at 11.46.45 AM.png" width="953" height="535"><br></div><div><br></div><div>(Don’t train the learnign algorithm sequentially over the game - break up gameplay into chunks, and learn over those chunks randomly - this is Experience Replay)<br></div><div><br></div><div><img src="resources/30A1B2DC70F9DFB105DE8F77AB66B9C1.png" alt="Screenshot 2020-03-28 at 11.48.38 AM.png" width="946" height="534"><br></div><div></div></div><div class="cell markdown-cell"><h2>Policy Gradients</h2>
<p>(See Appendix 1 for slides for Policy Gradients)</p>
<p>A problen with Q-learning is that the Q-function can be very complicated. You have to learn the Q function for every state-action pair. This leads us to wonder whether or not we can simplfy the state space and not store every state-action pair. This leads us to <strong>policy gradients</strong>.</p>
<p>Define a class of parameterized policies <span class="MathJax" id="MathJax-Element-318-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8443" style="width: 8.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.714em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.664em, 1000em, 2.884em, -0.489em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8444"><span class="mi" id="MathJax-Span-8445" style="font-family: STIXGeneral-Regular;">Π</span><span class="mo" id="MathJax-Span-8446" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-8447" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">{</span><span class="msubsup" id="MathJax-Span-8448"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8449" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8450"><span class="mrow" id="MathJax-Span-8451"><span class="mi" id="MathJax-Span-8452" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8453" style="font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-8454" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8455" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">∈</span><span class="msubsup" id="MathJax-Span-8456" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.426em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8457"><span class="mrow" id="MathJax-Span-8458"><span class="mi" id="MathJax-Span-8459" style="font-family: STIXGeneral-Regular;">ℝ</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.698em; left: 0.788em;"><span class="mi" id="MathJax-Span-8460" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">m</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8461" style="font-family: STIXGeneral-Regular;">}</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.104em; vertical-align: -0.263em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-318">\Pi = \{\pi_{\theta}, \theta \in \mathbb{R}^m\}</script>.<br>
For each policy, define its value (=expected reward):<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-319-Frame" style=""><nobr><span class="math" id="MathJax-Span-8462" style="width: 10.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.685em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-1.837em, 1000em, 5.729em, -0.346em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8463"><span class="mtable" id="MathJax-Span-8464" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 9.347em; height: 0px;"><span style="position: absolute; clip: rect(3.249em, 1000em, 8.743em, -0.513em); top: -6.137em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.513em); top: -4.575em; right: 0em;"><span class="mtd" id="MathJax-Span-8465"><span class="mrow" id="MathJax-Span-8466"><span class="mi" id="MathJax-Span-8467" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-8468" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8469" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8470" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -3.578em; right: 0em;"><span class="mtd" id="MathJax-Span-8501"><span class="mrow" id="MathJax-Span-8502"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -1.562em; right: 0em;"><span class="mtd" id="MathJax-Span-8526"><span class="mrow" id="MathJax-Span-8527"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.137em;"></span></span><span style="position: absolute; clip: rect(4.188em, 1000em, 11.754em, -0.209em); top: -8.221em; left: 1.689em;"><span style="display: inline-block; position: relative; width: 7.658em; height: 0px;"><span style="position: absolute; clip: rect(2.231em, 1000em, 5.715em, -0.209em); top: -6.264em; left: 0em;"><span class="mtd" id="MathJax-Span-8471"><span class="mrow" id="MathJax-Span-8472"><span class="mo" id="MathJax-Span-8473" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="texatom" id="MathJax-Span-8474"><span class="mrow" id="MathJax-Span-8475"><span class="mi" id="MathJax-Span-8476" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span class="mrow" id="MathJax-Span-8477" style="padding-left: 0.188em;"><span class="mo" id="MathJax-Span-8478" style="vertical-align: 1.823em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.17em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.601em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.885em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-8479"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8480" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.65em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-8481"><span class="mrow" id="MathJax-Span-8482"><span class="mi" id="MathJax-Span-8483" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8484" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-8485" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8486" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.809em; height: 0px;"><span style="position: absolute; clip: rect(1.93em, 1000em, 2.909em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8487" style="font-family: STIXGeneral-Italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.721em; left: 0.509em;"><span class="mi" id="MathJax-Span-8488" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8489"><span style="display: inline-block; position: relative; width: 0.728em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8490" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mi" id="MathJax-Span-8491" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8492"><span class="mrow" id="MathJax-Span-8493"><span class="mo" id="MathJax-Span-8494" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8495"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8496" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8497"><span class="mrow" id="MathJax-Span-8498"><span class="mi" id="MathJax-Span-8499" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8500" style="vertical-align: 1.823em;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px;"><span style="position: absolute; font-family: STIXSizeOneSym; top: -3.316em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: STIXSizeOneSym; top: -1.17em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -2.601em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: STIXSizeOneSym; position: absolute; top: -1.885em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.223em;"></span></span><span style="position: absolute; clip: rect(1.689em, 1000em, 2.998em, -0.209em); top: -2.114em; left: 0em;"><span class="mtd" id="MathJax-Span-8503"><span class="mrow" id="MathJax-Span-8504"><span class="mo" id="MathJax-Span-8505" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8506"><span style="display: inline-block; position: relative; width: 3.341em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8507"><span class="mrow" id="MathJax-Span-8508"><span class="mi" id="MathJax-Span-8509" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8510"><span class="mrow" id="MathJax-Span-8511"><span class="mi" id="MathJax-Span-8512" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-8513" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8514" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8515" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8516" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-8517" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8518" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mo" id="MathJax-Span-8519" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8520" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-8521" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8522" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8523" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8524" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8525" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.98em, 1000em, 3.63em, -0.209em); top: -0.098em; left: 0em;"><span class="mtd" id="MathJax-Span-8528"><span class="mrow" id="MathJax-Span-8529"><span class="mo" id="MathJax-Span-8530" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8531"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1000em, 4.657em, -0.451em); top: -3.604em; left: 0em;"><span class="mo" id="MathJax-Span-8532" style="font-family: STIXIntegralsD; vertical-align: -0.615em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.45em;"></span></span><span style="display: inline-block; width: 0px; height: 3.604em;"></span></span><span style="position: absolute; top: -1.389em; left: 0.62em;"><span class="texatom" id="MathJax-Span-8533"><span class="mrow" id="MathJax-Span-8534"><span class="mi" id="MathJax-Span-8535" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8536" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8537" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8538" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8539" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-8540" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8541" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8542" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8543" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8544" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8545" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-8546" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-8547" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.221em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 8.148em; vertical-align: -3.796em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-319">\begin{align} J(\theta) & = \mathbb{E} \left[ \sum_{t \ge 0} \gamma^t r_t | \pi_{\theta}\right] \\           & = \mathbb{E}_{\tau \sim p(\tau; \theta)} [r(\tau)] \\           & = \int_{\tau} r(\tau)p(\tau;\theta) d\tau \end{align}</script><br>
where <span class="MathJax" id="MathJax-Element-335-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9060" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.462em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9061"><span class="mi" id="MathJax-Span-9062" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-9063" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9064" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-9065" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-335">r(\tau)</script> is the reward of a trajectory <span class="MathJax" id="MathJax-Element-321-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8554" style="width: 10.328em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.291em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8555"><span class="mi" id="MathJax-Span-8556" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8557" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-8558" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">(</span><span class="msubsup" id="MathJax-Span-8559"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8560" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-8561" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8562" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8563" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.032em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8564" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mn" id="MathJax-Span-8565" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8566" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8567" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.703em, -0.462em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8568" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.427em;"><span class="mn" id="MathJax-Span-8569" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8570" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8571" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8572" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mn" id="MathJax-Span-8573" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8574" style="font-family: STIXGeneral-Regular;">,</span><span class="mo" id="MathJax-Span-8575" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-8576" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-8577" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">.</span><span class="mo" id="MathJax-Span-8578" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-321">\tau = (s_0,a_0,r_0,s_1,...)</script>.<br>
We can find the optimal policy <span class="MathJax" id="MathJax-Element-322-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8579" style="width: 8.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.939em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.627em, 1000em, 2.921em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8580"><span class="msubsup" id="MathJax-Span-8581"><span style="display: inline-block; position: relative; width: 1.03em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8582" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.714em; left: 0.561em;"><span class="mo" id="MathJax-Span-8583" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∗</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8584" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-8585" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">arg</span><span class="mo" id="MathJax-Span-8586"></span><span class="munderover" id="MathJax-Span-8587" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 2.215em; height: 0px;"><span style="position: absolute; clip: rect(1.905em, 1000em, 2.713em, -0.491em); top: -2.534em; left: 0em;"><span class="mo" id="MathJax-Span-8588" style="font-family: STIXGeneral-Regular;">max</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 1.745em;"><span class="texatom" id="MathJax-Span-8589"><span class="mrow" id="MathJax-Span-8590"><span class="mi" id="MathJax-Span-8591" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8592" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-8593" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8594" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8595" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.304em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-322">\theta^* = \arg \max_{\theta} J(\theta)</script> using <strong>gradient ascent</strong> on the parameters <span class="MathJax" id="MathJax-Element-329-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8974" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8975"><span class="mi" id="MathJax-Span-8976" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-329">\theta</script>. This algorithm is also called the <strong>REINFORCE algorithm</strong>.<p></p>
<p>We can compute the gradient of policy value, which unforunately is intractable.<br>
</p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-324-Frame" style=""><nobr><span class="math" id="MathJax-Span-8599" style="width: 13.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.881em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(0.98em, 1000em, 3.63em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8600"><span class="msubsup" id="MathJax-Span-8601"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8602" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8603"><span class="mrow" id="MathJax-Span-8604"><span class="mi" id="MathJax-Span-8605" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8606" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-8607" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8608" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8609" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8610" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-8611" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1000em, 4.657em, -0.451em); top: -3.604em; left: 0em;"><span class="mo" id="MathJax-Span-8612" style="font-family: STIXIntegralsD; vertical-align: -0.615em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.45em;"></span></span><span style="display: inline-block; width: 0px; height: 3.604em;"></span></span><span style="position: absolute; top: -1.389em; left: 0.62em;"><span class="texatom" id="MathJax-Span-8613"><span class="mrow" id="MathJax-Span-8614"><span class="mi" id="MathJax-Span-8615" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8616" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8617" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8618" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8619" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8620"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8621" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8622"><span class="mrow" id="MathJax-Span-8623"><span class="mi" id="MathJax-Span-8624" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8625" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8626" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8627" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8628" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8629" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8630" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-8631" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-8632" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.691em; vertical-align: -1.092em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-324">\nabla_{\theta} J(\theta) = \int_{\tau} r(\tau)\nabla_{\theta}p(\tau ; \theta) d\tau</script><br>
However, using the clever substitution<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-325-Frame" style=""><nobr><span class="math" id="MathJax-Span-8633" style="width: 24.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.622em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.001em, 1000em, 3.594em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8634"><span class="msubsup" id="MathJax-Span-8635"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8636" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8637"><span class="mrow" id="MathJax-Span-8638"><span class="mi" id="MathJax-Span-8639" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8640" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8641" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8642" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8643" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8644" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8645" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8646" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-8647" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-8648" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8649" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8650" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8651" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8652" style="font-family: STIXGeneral-Regular;">)</span><span class="mfrac" id="MathJax-Span-8653" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 4.005em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.908em, -0.444em); top: -3.22em; left: 50%; margin-left: -1.943em;"><span class="mrow" id="MathJax-Span-8654"><span class="msubsup" id="MathJax-Span-8655"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8656" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8657"><span class="mrow" id="MathJax-Span-8658"><span class="mi" id="MathJax-Span-8659" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8660" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8661" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8662" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8663" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8664" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8665" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.687em, 1000em, 2.908em, -0.582em); top: -1.848em; left: 50%; margin-left: -1.295em;"><span class="mrow" id="MathJax-Span-8666"><span class="mi" id="MathJax-Span-8667" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8668" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8669" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8670" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8671" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8672" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(0.831em, 1000em, 1.239em, -0.507em); top: -1.29em; left: 0em;"><span style="border-left-width: 4.005em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.07em;"></span></span></span></span><span class="mo" id="MathJax-Span-8673" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-8674" style="font-family: STIXGeneral-Italic; padding-left: 0.313em;">p</span><span class="mo" id="MathJax-Span-8675" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8676" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8677" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8678" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8679" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8680"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8681" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8682"><span class="mrow" id="MathJax-Span-8683"><span class="mi" id="MathJax-Span-8684" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8685" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-8686"></span><span class="mi" id="MathJax-Span-8687" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8688" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8689" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8690" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8691" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8692" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.628em; vertical-align: -1.051em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-325">\nabla_{\theta}p(\tau ; \theta) = p(\tau ; \theta) \frac{\nabla_{\theta}p(\tau ; \theta)}{p(\tau ; \theta)} = p(\tau ; \theta) \nabla_{\theta}\log p(\tau ; \theta)</script><br>
we obtain<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-326-Frame" style=""><nobr><span class="math" id="MathJax-Span-8693" style="width: 18.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.948em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-0.095em, 1000em, 3.987em, -0.34em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8694"><span class="mtable" id="MathJax-Span-8695" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 16.61em; height: 0px;"><span style="position: absolute; clip: rect(2.413em, 1000em, 5.494em, -0.507em); top: -3.998em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.928em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.444em); top: -3.272em; right: 0em;"><span class="mtd" id="MathJax-Span-8696"><span class="mrow" id="MathJax-Span-8697"><span class="msubsup" id="MathJax-Span-8698"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8699" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8700"><span class="mrow" id="MathJax-Span-8701"><span class="mi" id="MathJax-Span-8702" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8703" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-8704" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8705" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8706" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(3.829em, 1000em, 4.167em, -0.507em); top: -2.67em; right: 0em;"><span class="mtd" id="MathJax-Span-8742"><span class="mrow" id="MathJax-Span-8743"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.439em, 1000em, 6.521em, -0.209em); top: -4.73em; left: 2.928em;"><span style="display: inline-block; position: relative; width: 13.682em; height: 0px;"><span style="position: absolute; clip: rect(0.98em, 1000em, 3.63em, -0.209em); top: -3.272em; left: 0em;"><span class="mtd" id="MathJax-Span-8707"><span class="mrow" id="MathJax-Span-8708"><span class="mo" id="MathJax-Span-8709" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8710"><span style="display: inline-block; position: relative; width: 1.07em; height: 0px;"><span style="position: absolute; clip: rect(2.05em, 1000em, 4.657em, -0.451em); top: -3.604em; left: 0em;"><span class="mo" id="MathJax-Span-8711" style="font-family: STIXIntegralsD; vertical-align: -0.615em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.45em;"></span></span><span style="display: inline-block; width: 0px; height: 3.604em;"></span></span><span style="position: absolute; top: -1.389em; left: 0.62em;"><span class="texatom" id="MathJax-Span-8712"><span class="mrow" id="MathJax-Span-8713"><span class="mi" id="MathJax-Span-8714" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8715" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8716" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8717" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8718" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8719" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8720"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8721" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8722"><span class="mrow" id="MathJax-Span-8723"><span class="mi" id="MathJax-Span-8724" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8725" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-8726"></span><span class="mi" id="MathJax-Span-8727" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8728" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8729" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8730" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8731" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8732" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8733" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-8734" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8735" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8736" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8737" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8738" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8739" style="font-family: STIXGeneral-Regular;">)</span><span class="mi" id="MathJax-Span-8740" style="font-family: STIXGeneral-Italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.027em;"></span></span><span class="mi" id="MathJax-Span-8741" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.998em, -0.209em); top: -1.206em; left: 0em;"><span class="mtd" id="MathJax-Span-8744"><span class="mrow" id="MathJax-Span-8745"><span class="mo" id="MathJax-Span-8746" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="msubsup" id="MathJax-Span-8747"><span style="display: inline-block; position: relative; width: 3.341em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.703em, -0.437em); top: -2.534em; left: 0em;"><span class="texatom" id="MathJax-Span-8748"><span class="mrow" id="MathJax-Span-8749"><span class="mi" id="MathJax-Span-8750" style="font-family: STIXGeneral-Regular;">𝔼</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.676em;"><span class="texatom" id="MathJax-Span-8751"><span class="mrow" id="MathJax-Span-8752"><span class="mi" id="MathJax-Span-8753" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-8754" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">∼</span><span class="mi" id="MathJax-Span-8755" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8756" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8757" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.011em;"></span></span><span class="mo" id="MathJax-Span-8758" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8759" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span><span class="mo" id="MathJax-Span-8760" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8761" style="font-family: STIXGeneral-Regular;">[</span><span class="mi" id="MathJax-Span-8762" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-8763" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8764" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8765" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8766"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8767" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8768"><span class="mrow" id="MathJax-Span-8769"><span class="mi" id="MathJax-Span-8770" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8771" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-8772"></span><span class="mi" id="MathJax-Span-8773" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8774" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8775" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8776" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8777" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8778" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8779" style="font-family: STIXGeneral-Regular;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.73em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 4.281em; vertical-align: -1.863em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-326">\begin{align} \nabla_{\theta} J(\theta) & = \int_{\tau} (r(\tau)\nabla_{\theta}\log p(\tau ; \theta)) p(\tau ; \theta) d\tau \\ & = \mathbb{E}_{\tau \sim p(\tau ; \theta)}[r(\tau) \nabla_{\theta} \log p(\tau ; \theta)] \end{align}</script><br>
which we can estimate with Monte Carlo Sampling.<br>
See repeat of this defivation in CS234 Lecture 8.<br>
Now,<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-327-Frame" style=""><nobr><span class="math" id="MathJax-Span-8780" style="width: 26.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.043em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(-2.008em, 1000em, 5.9em, -0.415em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-8781"><span class="mtable" id="MathJax-Span-8782" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 23.705em; height: 0px;"><span style="position: absolute; clip: rect(3.245em, 1000em, 9.75em, -0.582em); top: -7.151em; left: 0em;"><span style="display: inline-block; position: relative; width: 8.052em; height: 0px;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.908em, -0.582em); top: -5.593em; right: 0em;"><span class="mtd" id="MathJax-Span-8783"><span class="mrow" id="MathJax-Span-8784"><span class="mi" id="MathJax-Span-8785" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-8786" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8787" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8788" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8789" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8790" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.507em); top: -2.957em; right: 0em;"><span class="mtd" id="MathJax-Span-8837"><span class="mrow" id="MathJax-Span-8838"><span class="mspace" id="MathJax-Span-8839" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8840" style="font-family: STIXGeneral-Regular;">⟹</span><span class="mspace" id="MathJax-Span-8841" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-8842" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">log</span><span class="mo" id="MathJax-Span-8843"></span><span class="mi" id="MathJax-Span-8844" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8845" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8846" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8847" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8848" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8849" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.682em, 1000em, 2.921em, -0.507em); top: -0.322em; right: 0em;"><span class="mtd" id="MathJax-Span-8901"><span class="mrow" id="MathJax-Span-8902"><span class="mspace" id="MathJax-Span-8903" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-8904" style="font-family: STIXGeneral-Regular;">⟹</span><span class="mspace" id="MathJax-Span-8905" style="height: 0em; vertical-align: 0em; width: 0.313em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-8906" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8907" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8908"><span class="mrow" id="MathJax-Span-8909"><span class="mi" id="MathJax-Span-8910" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8911" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-8912"></span><span class="mi" id="MathJax-Span-8913" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8914" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8915" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-8916" style="font-family: STIXGeneral-Regular;">;</span><span class="mi" id="MathJax-Span-8917" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8918" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.151em;"></span></span><span style="position: absolute; clip: rect(4.355em, 1000em, 12.262em, -0.209em); top: -8.559em; left: 8.052em;"><span style="display: inline-block; position: relative; width: 15.653em; height: 0px;"><span style="position: absolute; clip: rect(1.389em, 1000em, 4.026em, -0.209em); top: -5.593em; left: 0em;"><span class="mtd" id="MathJax-Span-8791"><span class="mrow" id="MathJax-Span-8792"><span class="mo" id="MathJax-Span-8793" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-8794"><span style="display: inline-block; position: relative; width: 1.408em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.629em, -0.457em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8795" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∏</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.65em, -0.48em); top: -1.158em; left: 0.141em;"><span class="texatom" id="MathJax-Span-8796"><span class="mrow" id="MathJax-Span-8797"><span class="mi" id="MathJax-Span-8798" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8799" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-8800" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8801" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8802" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8803"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8804" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8805"><span class="mrow" id="MathJax-Span-8806"><span class="mi" id="MathJax-Span-8807" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8808" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8809" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8810"><span class="mrow" id="MathJax-Span-8811"><span class="mo" id="MathJax-Span-8812" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8813"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8814" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8815" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8816" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8817" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8818" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8819" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8820" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-8821"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8822" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8823"><span class="mrow" id="MathJax-Span-8824"><span class="mi" id="MathJax-Span-8825" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8826" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8827"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8828" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8829" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8830"><span class="mrow" id="MathJax-Span-8831"><span class="mo" id="MathJax-Span-8832" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8833"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8834" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8835" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8836" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.39em, 1000em, 4.026em, -0.209em); top: -2.957em; left: 0em;"><span class="mtd" id="MathJax-Span-8850"><span class="mrow" id="MathJax-Span-8851"><span class="mo" id="MathJax-Span-8852" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-8853"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8854" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.65em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-8855"><span class="mrow" id="MathJax-Span-8856"><span class="mi" id="MathJax-Span-8857" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8858" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-8859" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8860" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-8861"></span><span class="mi" id="MathJax-Span-8862" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">p</span><span class="mo" id="MathJax-Span-8863" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8864"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8865" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-8866"><span class="mrow" id="MathJax-Span-8867"><span class="mi" id="MathJax-Span-8868" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8869" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-8870" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8871"><span class="mrow" id="MathJax-Span-8872"><span class="mo" id="MathJax-Span-8873" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8874"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8875" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8876" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8877" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-8878" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8879" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8880" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8881" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8882" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">+</span><span class="mi" id="MathJax-Span-8883" style="font-family: STIXGeneral-Regular; padding-left: 0.25em;">log</span><span class="mo" id="MathJax-Span-8884"></span><span class="msubsup" id="MathJax-Span-8885" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8886" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8887"><span class="mrow" id="MathJax-Span-8888"><span class="mi" id="MathJax-Span-8889" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8890" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8891"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8892" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8893" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8894"><span class="mrow" id="MathJax-Span-8895"><span class="mo" id="MathJax-Span-8896" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8897"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8898" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8899" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8900" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; clip: rect(1.39em, 1000em, 4.026em, -0.209em); top: -0.322em; left: 0em;"><span class="mtd" id="MathJax-Span-8919"><span class="mrow" id="MathJax-Span-8920"><span class="mo" id="MathJax-Span-8921" style="font-family: STIXGeneral-Regular; padding-left: 0.25em; padding-right: 0.375em;">=</span><span class="munderover" id="MathJax-Span-8922"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8923" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.65em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-8924"><span class="mrow" id="MathJax-Span-8925"><span class="mi" id="MathJax-Span-8926" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-8927" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-8928" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-8929" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8930" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8931"><span class="mrow" id="MathJax-Span-8932"><span class="mi" id="MathJax-Span-8933" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8934" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-8935"></span><span class="msubsup" id="MathJax-Span-8936" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8937" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-8938"><span class="mrow" id="MathJax-Span-8939"><span class="mi" id="MathJax-Span-8940" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8941" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-8942"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8943" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-8944" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8945"><span class="mrow" id="MathJax-Span-8946"><span class="mo" id="MathJax-Span-8947" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-8948"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8949" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-8950" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-8951" style="font-family: STIXGeneral-Regular;">)</span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="display: inline-block; width: 0px; height: 8.559em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 8.527em; vertical-align: -3.986em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-327">\begin{align} p(\tau ; \theta) & = \prod_{t \ge 0} p(s_{t+1} | s_t, a_t) \pi_{\theta}(a_t|s_t)\\   \implies \log p(\tau ; \theta) & = \sum_{t \ge 0} \log p(s_{t+1}| s_t, a_t) + \log \pi_{\theta}(a_t|s_t) \\ \implies \nabla_{\theta}\log p(\tau ; \theta) & = \sum_{t \ge 0} \nabla_{\theta} \log \pi_{\theta}(a_t|s_t)  \end{align}</script><br>
since the state transition probabilities <span class="MathJax" id="MathJax-Element-333-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9032" style="width: 5.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.124em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9033"><span class="mi" id="MathJax-Span-9034" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-9035" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9036"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9037" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-9038"><span class="mrow" id="MathJax-Span-9039"><span class="mi" id="MathJax-Span-9040" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-9041" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9042" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-9043"><span class="mrow" id="MathJax-Span-9044"><span class="mo" id="MathJax-Span-9045" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-9046"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9047" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9048" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9049" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9050" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9051" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-9052" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9053" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-333">p(s_{t+1}| s_t, a_t)</script> do not depend on the parameters <span class="MathJax" id="MathJax-Element-329-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8974" style="width: 0.578em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.507em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.714em, -0.48em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8975"><span class="mi" id="MathJax-Span-8976" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.89em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-329">\theta</script>.<br>
So when sampling the trajectory <span class="MathJax" id="MathJax-Element-330-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8977" style="width: 0.516em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.45em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.714em, -0.495em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8978"><span class="mi" id="MathJax-Span-8979" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.612em; vertical-align: -0.075em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-330">\tau</script>, we estimate <span class="MathJax" id="MathJax-Element-331-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-8980" style="width: 1.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.687em, 1000em, 2.88em, -0.513em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8981"><span class="mi" id="MathJax-Span-8982" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-8983" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8984" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8985" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.074em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-331">J(\theta)</script> directly with<br>
<div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-332-Frame" style=""><nobr><span class="math" id="MathJax-Span-8986" style="width: 15.266em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.739em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.39em, 1000em, 4.026em, -0.444em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-8987"><span class="msubsup" id="MathJax-Span-8988"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-8989" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-8990"><span class="mrow" id="MathJax-Span-8991"><span class="mi" id="MathJax-Span-8992" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-8993" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.047em;"></span></span><span class="mo" id="MathJax-Span-8994" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-8995" style="font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-8996" style="font-family: STIXGeneral-Regular;">)</span><span class="mo" id="MathJax-Span-8997" style="font-family: STIXGeneral-Regular; padding-left: 0.313em;">=</span><span class="munderover" id="MathJax-Span-8998" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.351em; height: 0px;"><span style="position: absolute; clip: rect(1.84em, 1000em, 3.628em, -0.417em); top: -2.984em; left: 0em;"><span class="mo" id="MathJax-Span-8999" style="font-family: STIXSizeOneSym; vertical-align: -0.524em;">∑</span><span style="display: inline-block; width: 0px; height: 2.984em;"></span></span><span style="position: absolute; clip: rect(1.662em, 1000em, 2.65em, -0.48em); top: -1.159em; left: 0.113em;"><span class="texatom" id="MathJax-Span-9000"><span class="mrow" id="MathJax-Span-9001"><span class="mi" id="MathJax-Span-9002" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-9003" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">≥</span><span class="mn" id="MathJax-Span-9004" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-9005" style="font-family: STIXGeneral-Italic; padding-left: 0.188em;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-9006" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9007" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-9008" style="font-family: STIXGeneral-Regular;">)</span><span class="msubsup" id="MathJax-Span-9009"><span style="display: inline-block; position: relative; width: 1.257em; height: 0px;"><span style="position: absolute; clip: rect(1.703em, 1000em, 2.715em, -0.444em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9010" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.788em;"><span class="texatom" id="MathJax-Span-9011"><span class="mrow" id="MathJax-Span-9012"><span class="mi" id="MathJax-Span-9013" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mi" id="MathJax-Span-9014" style="font-family: STIXGeneral-Regular; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-9015"></span><span class="msubsup" id="MathJax-Span-9016" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9017" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.531em;"><span class="texatom" id="MathJax-Span-9018"><span class="mrow" id="MathJax-Span-9019"><span class="mi" id="MathJax-Span-9020" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">θ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.01em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9021" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9022"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9023" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-9024" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-9025"><span class="mrow" id="MathJax-Span-9026"><span class="mo" id="MathJax-Span-9027" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-9028"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9029" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9030" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9031" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 2.676em; vertical-align: -1.531em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-332"> \nabla_{\theta} J(\theta)= \sum_{t \ge 0} r(\tau) \nabla_{\theta} \log \pi_{\theta}(a_t|s_t)  </script><br>
which again do not depend on transition probabilities <span class="MathJax" id="MathJax-Element-333-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9032" style="width: 5.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.124em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.908em, -0.582em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9033"><span class="mi" id="MathJax-Span-9034" style="font-family: STIXGeneral-Italic;">p</span><span class="mo" id="MathJax-Span-9035" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9036"><span style="display: inline-block; position: relative; width: 1.652em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9037" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="texatom" id="MathJax-Span-9038"><span class="mrow" id="MathJax-Span-9039"><span class="mi" id="MathJax-Span-9040" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span class="mo" id="MathJax-Span-9041" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-9042" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="texatom" id="MathJax-Span-9043"><span class="mrow" id="MathJax-Span-9044"><span class="mo" id="MathJax-Span-9045" style="font-family: STIXGeneral-Regular;">|</span></span></span><span class="msubsup" id="MathJax-Span-9046"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9047" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9048" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9049" style="font-family: STIXGeneral-Regular;">,</span><span class="msubsup" id="MathJax-Span-9050" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 0.863em; height: 0px;"><span style="position: absolute; clip: rect(1.924em, 1000em, 2.714em, -0.49em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9051" style="font-family: STIXGeneral-Italic;">a</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.563em;"><span class="mi" id="MathJax-Span-9052" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9053" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.103em; vertical-align: -0.29em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-333">p(s_{t+1}| s_t, a_t)</script>. This update step is the essense of the <strong>REINFORCE</strong> algorithm. The interpretation of this is: if the recieved reward <span class="MathJax" id="MathJax-Element-335-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9060" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.462em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9061"><span class="mi" id="MathJax-Span-9062" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-9063" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9064" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-9065" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-335">r(\tau)</script> is high, push up the probabilities of all actions seen. If the reward  <span class="MathJax" id="MathJax-Element-335-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9060" style="width: 1.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.577em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.689em, 1000em, 2.88em, -0.462em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9061"><span class="mi" id="MathJax-Span-9062" style="font-family: STIXGeneral-Italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span><span class="mo" id="MathJax-Span-9063" style="font-family: STIXGeneral-Regular;">(</span><span class="mi" id="MathJax-Span-9064" style="font-family: STIXGeneral-Italic;">τ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.016em;"></span></span><span class="mo" id="MathJax-Span-9065" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.072em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-335">r(\tau)</script> is low, push down the probabilities of all actions seen. It might seem simplistic to say that if a trajectory is good, then all its actions were good. But in expectation, it averages out and is unbiased! However, this suffers from high variance because credit assignment is really hard. See repeat of this defivation in CS234 Lecture 8.<p></p>
<p>Because of high variance, the challenge with policy gradients is <strong>sample efficiency</strong>.</p>
<p><strong>Variance Reduction</strong> is thus an important area of research in policy gradients. All basic (vanilla) implementations of REINFORCE use the cumulative future reward, discount factor, and baseline methods mentioned below.</p>
</div><div class="cell text-cell"><img src="resources/AB8F96C6367B3623EC75B89055603C20.png" alt="Screenshot 2020-03-28 at 12.29.12 PM.png" width="949" height="525"><div><img src="resources/E77B761F5FE7085D598ACCDC9C3416BD.png" alt="Screenshot 2020-03-28 at 12.29.53 PM.png" width="947" height="525"><br></div><div><img src="resources/792C63857E06F6006922245877A15C8F.png" alt="Screenshot 2020-03-28 at 12.31.20 PM.png" width="949" height="528"><br></div><div></div></div><div class="cell markdown-cell"><h3>Actor-Critic Algorithm</h3>
<p>Often times we use the value function <span class="MathJax" id="MathJax-Element-336-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9066" style="width: 3.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.703em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.682em, 1000em, 2.88em, -0.431em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9067"><span class="msubsup" id="MathJax-Span-9068"><span style="display: inline-block; position: relative; width: 1.274em; height: 0px;"><span style="position: absolute; clip: rect(1.712em, 1000em, 2.721em, -0.431em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9069" style="font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.077em;"></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.689em; left: 0.805em;"><span class="texatom" id="MathJax-Span-9070"><span class="mrow" id="MathJax-Span-9071"><span class="mi" id="MathJax-Span-9072" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.023em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9073" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-9074"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-9075" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-9076" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span><span class="mo" id="MathJax-Span-9077" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.079em; vertical-align: -0.259em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-336">V^{\pi}(s_t)</script> of the policy <span class="MathJax" id="MathJax-Element-337-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9078" style="width: 0.641em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.937em, 1000em, 2.721em, -0.488em); top: -2.534em; left: 0em;"><span class="mrow" id="MathJax-Span-9079"><span class="mi" id="MathJax-Span-9080" style="font-family: STIXGeneral-Italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.62em; vertical-align: -0.082em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-337">\pi</script> at state <span class="MathJax" id="MathJax-Element-261-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7496" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7497"><span class="msubsup" id="MathJax-Span-7498"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7499" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7500" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">s_t</script> as the baseline, because the value function is the expected cumulative reward following a policy from state <span class="MathJax" id="MathJax-Element-261-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-7496" style="width: 0.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 111%;"><span style="position: absolute; clip: rect(1.585em, 1000em, 2.523em, -0.491em); top: -2.196em; left: 0em;"><span class="mrow" id="MathJax-Span-7497"><span class="msubsup" id="MathJax-Span-7498"><span style="display: inline-block; position: relative; width: 0.751em; height: 0px;"><span style="position: absolute; clip: rect(1.923em, 1000em, 2.716em, -0.491em); top: -2.534em; left: 0em;"><span class="mi" id="MathJax-Span-7499" style="font-family: STIXGeneral-Italic;">s</span><span style="display: inline-block; width: 0px; height: 2.534em;"></span></span><span style="position: absolute; top: -2.159em; left: 0.45em;"><span class="mi" id="MathJax-Span-7500" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.013em;"></span></span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.196em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.791em; vertical-align: -0.238em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-261">s_t</script>. This is known as the <strong>Actor-critic algorithm</strong>, a variant of policy gradient which integrates Q-learning.</p>
</div><div class="cell text-cell"><div><img src="resources/E27090EF48EC0CA9D3B6739C106ECFD7.png" alt="Screenshot 2020-03-28 at 12.35.26 PM.png" width="925" height="516"><b><br></b></div><div><img src="resources/FCA0CD9950FFB1AB45B7C5E6F6CE1789.png" alt="Screenshot 2020-03-28 at 12.43.59 PM.png" width="932" height="515"><b><br></b></div><div><img src="resources/35D956599C386AEFAFBCEC6576B3B1C3.png" alt="Screenshot 2020-03-28 at 12.51.30 PM.png" width="953" height="533"><br></div><div><b><br></b></div><div style="font-size: 17px;"><b>REINFORCE in action:&nbsp;</b></div><div><b>Recurrent Attention Model (RAM)</b></div><div>This is the first example of <b>hard attention</b>, which is also becoming more popular in image processing lately.</div><div><b><br></b></div><div><img src="resources/8913420BDB8ECEA0D10D6D17A23CCC03.png" alt="Screenshot 2020-03-28 at 12.57.02 PM.png" width="952" height="526"><br></div><div>The REINFORCE algorithm is used to ask the network where to glimpse at next.</div><div>Has also been used in visual QA, fine-grained image recognition, image captioning.</div><div><b><br></b></div><div><b>AlphaGo</b></div><div><img src="resources/1CEAF172E756C924E8B1F832A9763DA6.png" alt="Screenshot 2020-03-28 at 1.02.47 PM.png" width="950" height="529"><b><br></b></div><div><br></div><div><b>Summary</b></div><div><img src="resources/ABBA7BFEB5A6C01AE8FB6CCD14DEED6E.png" alt="Screenshot 2020-03-28 at 1.07.11 PM.png" width="947" height="533"><b><br></b></div><div><br></div><div><br></div><div style="font-size: 18px;"><b>Appendix 1: Slides for policy gradients</b></div><div><b><br></b></div><img src="resources/C2DD1567C0D86CFDC70110DADEDBA6F9.png" alt="Screenshot 2020-03-28 at 11.52.02 AM.png" width="947" height="531"><div><img src="resources/17591441257FD1EE712D60E37A9AE14A.png" alt="Screenshot 2020-03-28 at 12.06.48 PM.png" width="932" height="515"><br></div><div><img src="resources/FCDED15C5C56EE1E692703A0486DBED1.png" alt="Screenshot 2020-03-28 at 12.14.58 PM.png" width="950" height="530"><br><div><img src="resources/D91DB84AACF32E3208E3C742D81DE140.png" alt="Screenshot 2020-03-28 at 12.27.41 PM.png" width="943" height="530"><br></div></div></div></div>
    </body>
    </html>
  